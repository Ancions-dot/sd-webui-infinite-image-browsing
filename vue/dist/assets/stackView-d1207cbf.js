import{d as ae,u as we,g as ee,_ as Oe,c as a,a as _e,P as pe,D as be,f as Ue,w as ut,b as dt,e as ct,h as ze,M as Ce,i as pt,j as ft,F as ye,o as c,k as S,l as u,m as U,t as d,n as ce,p as O,q as We,r as mt,s as je,v as Te,x as vt,y as gt,z as D,A as r,B as e,C as p,E as q,G as kt,H as ke,I as _t,J as bt,K as Ct,L as yt,S as ht,N as wt,O as It,Q as St,R as Ve,T as $t,U as At,V as Pt,W as Mt,X as Ft,Y as Rt,Z as Bt}from"./index-1489ccf0.js";import{S as te,s as Nt,M as xt,L as Dt,R as Et,f as zt}from"./MultiSelectKeep-8cc6a9d3.js";import{F as W,N as jt,_ as Tt,a as Vt}from"./numInput-57fa2c45.js";import"./index-fbf51be6.js";import{D as Ge}from"./index-efa83f46.js";/* empty css              *//* empty css              */import{u as Lt,a as Ot,b as Ut,c as Wt,d as Gt,e as Kt,f as qt,g as Qt,s as Ht,h as Jt,F as Xt}from"./FileItem-5a479398.js";import"./functionalCallableComp-215f3be5.js";var Yt=["class","style"],Zt=function(){return{prefixCls:String,href:String,separator:pe.any,overlay:pe.any,onClick:Function}};const ne=ae({compatConfig:{MODE:3},name:"ABreadcrumbItem",inheritAttrs:!1,__ANT_BREADCRUMB_ITEM:!0,props:Zt(),slots:["separator","overlay"],setup:function(l,g){var k=g.slots,b=g.attrs,A=we("breadcrumb",l),C=A.prefixCls,F=function(P,m){var i=ee(k,l,"overlay");return i?a(Ge,{overlay:i,placement:"bottom"},{default:function(){return[a("span",{class:"".concat(m,"-overlay-link")},[P,a(be,null,null)])]}}):P};return function(){var R,P=(R=ee(k,l,"separator"))!==null&&R!==void 0?R:"/",m=ee(k,l),i=b.class,y=b.style,_=Oe(b,Yt),v;return l.href!==void 0?v=a("a",_e({class:"".concat(C.value,"-link"),onClick:l.onClick},_),[m]):v=a("span",_e({class:"".concat(C.value,"-link"),onClick:l.onClick},_),[m]),v=F(v,C.value),m?a("span",{class:i,style:y},[v,P&&a("span",{class:"".concat(C.value,"-separator")},[P])]):null}}});var en=function(){return{prefixCls:String,routes:{type:Array},params:pe.any,separator:pe.any,itemRender:{type:Function}}};function tn(s,l){if(!s.breadcrumbName)return null;var g=Object.keys(l).join("|"),k=s.breadcrumbName.replace(new RegExp(":(".concat(g,")"),"g"),function(b,A){return l[A]||b});return k}function Le(s){var l=s.route,g=s.params,k=s.routes,b=s.paths,A=k.indexOf(l)===k.length-1,C=tn(l,g);return A?a("span",null,[C]):a("a",{href:"#/".concat(b.join("/"))},[C])}const Q=ae({compatConfig:{MODE:3},name:"ABreadcrumb",props:en(),slots:["separator","itemRender"],setup:function(l,g){var k=g.slots,b=we("breadcrumb",l),A=b.prefixCls,C=b.direction,F=function(i,y){return i=(i||"").replace(/^\//,""),Object.keys(y).forEach(function(_){i=i.replace(":".concat(_),y[_])}),i},R=function(i,y,_){var v=pt(i),M=F(y||"",_);return M&&v.push(M),v},P=function(i){var y=i.routes,_=y===void 0?[]:y,v=i.params,M=v===void 0?{}:v,N=i.separator,E=i.itemRender,z=E===void 0?Le:E,j=[];return _.map(function(w){var T=F(w.path,M);T&&j.push(T);var H=[].concat(j),J=null;return w.children&&w.children.length&&(J=a(Ce,null,{default:function(){return[w.children.map(function(G){return a(Ce.Item,{key:G.path||G.breadcrumbName},{default:function(){return[z({route:G,params:M,routes:_,paths:R(H,G.path,M)})]}})})]}})),a(ne,{overlay:J,separator:N,key:T||w.breadcrumbName},{default:function(){return[z({route:w,params:M,routes:_,paths:H})]}})})};return function(){var m,i,y,_=l.routes,v=l.params,M=v===void 0?{}:v,N=Ue(ee(k,l)),E=(m=ee(k,l,"separator"))!==null&&m!==void 0?m:"/",z=l.itemRender||k.itemRender||Le;_&&_.length>0?y=P({routes:_,params:M,separator:E,itemRender:z}):N.length&&(y=N.map(function(w,T){return ut(dt(w.type)==="object"&&(w.type.__ANT_BREADCRUMB_ITEM||w.type.__ANT_BREADCRUMB_SEPARATOR),"Breadcrumb","Only accepts Breadcrumb.Item and Breadcrumb.Separator as it's children"),ct(w,{separator:E,key:T})}));var j=(i={},ze(i,A.value,!0),ze(i,"".concat(A.value,"-rtl"),C.value==="rtl"),i);return a("div",{class:j},[y])}}});var nn=["separator","class"],an=function(){return{prefixCls:String}};const he=ae({compatConfig:{MODE:3},name:"ABreadcrumbSeparator",__ANT_BREADCRUMB_SEPARATOR:!0,inheritAttrs:!1,props:an(),setup:function(l,g){var k=g.slots,b=g.attrs,A=we("breadcrumb",l),C=A.prefixCls;return function(){var F;b.separator;var R=b.class,P=Oe(b,nn),m=Ue((F=k.default)===null||F===void 0?void 0:F.call(k));return a("span",_e({class:["".concat(C.value,"-separator"),R]},P),[m.length>0?m:"/"])}}});Q.Item=ne;Q.Separator=he;Q.install=function(s){return s.component(Q.name,Q),s.component(ne.name,ne),s.component(he.name,he),s};W.useInjectFormItemContext=ft;W.ItemRest=ye;W.install=function(s){return s.component(W.name,W),s.component(W.Item.name,W.Item),s.component(ye.name,ye),s};te.setDefaultIndicator=Nt;te.install=function(s){return s.component(te.name,te),s};const on={class:"base-info"},ln=ae({__name:"BaseFileListInfo",props:{fileNum:{},selectedFileNum:{}},setup(s){return(l,g)=>(c(),S("div",on,[u("span",null,[U(d(l.$t("items",[l.fileNum]))+" ",1),l.selectedFileNum?(c(),S(ce,{key:0},[U(", "+d(l.$t("selectedItems",[l.selectedFileNum])),1)],64)):O("",!0)])]))}});const rn=We(ln,[["__scopeId","data-v-afd25667"]]),sn={class:"hint"},un={class:"location-bar"},dn={key:0,class:"breadcrumb"},cn=["onClick"],pn={key:3,class:"location-act"},fn={class:"actions"},mn=["onClick"],vn={style:{width:"512px",background:"var(--zp-primary-background)",padding:"16px","border-radius":"4px","box-shadow":"0 0 4px var(--zp-secondary-background)",border:"1px solid var(--zp-secondary-background)"}},gn={style:{padding:"4px"}},kn={style:{padding:"4px"}},_n={style:{padding:"4px"}},bn={key:0,class:"view"},Cn={style:{padding:"16px 0 512px"}},yn={key:0,class:"preview-switch"},hn=ae({__name:"stackView",props:{tabIdx:{},paneIdx:{},path:{},walkModePath:{},stackKey:{}},setup(s){const l=s,g=mt(),{scroller:k,stackViewEl:b,props:A,multiSelectedIdxs:C,spinning:F}=Lt().toRefs(),{currLocation:R,currPage:P,refresh:m,copyLocation:i,back:y,openNext:_,stack:v,quickMoveTo:M,addToSearchScanPathAndQuickMove:N,searchPathInfo:E,locInputValue:z,isLocationEditing:j,onLocEditEnter:w,onEditBtnClick:T,share:H,selectAll:J,onCreateFloderBtnClick:oe,onWalkBtnClick:G,showWalkButton:Ie,searchInCurrentDir:Se}=Ot(),{gridItems:Ke,sortMethodConv:qe,moreActionsDropdownShow:fe,sortedFiles:f,sortMethod:me,itemSize:$e,loadNextDir:Qe,loadNextDirLoading:He,canLoadNext:Je,onScroll:Xe,cellWidth:le}=Ut(),{onDrop:Ye,onFileDragStart:Ze,onFileDragEnd:et}=Wt(),{onFileItemClick:tt,onContextMenuClick:Ae,showGenInfo:re,imageGenInfo:Pe,q:Me}=Gt({openNext:_}),{previewIdx:se,onPreviewVisibleChange:nt,previewing:Fe,previewImgMove:Re,canPreview:Be}=Kt(),{showMenuIdx:ve}=qt(),{onClearAllSelected:at,onReverseSelect:ot,onSelectAll:lt}=Qt();je(()=>l,()=>{A.value=l;const o=Ht.get(l.stackKey??"");o&&(v.value=o.slice())},{immediate:!0}),je(f,async(o,t)=>{o.length>0&&o.length!==t.length&&Ne()});const ie=Te(g.defaultChangeIndchecked),ge=Te(g.defaultSeedChangeChecked);function Ne(){let o=[];const t=[".png",".jpg",".jpeg"];for(let I in f.value)f.value[I].type=="file"&&t.includes(f.value[I].fullpath.slice(-4).toLowerCase())&&o.push(f.value[I].fullpath);Me.pushAction(()=>vt(o)).res.then(I=>{for(let V in f.value)f.value[V].gen_info_raw=I[f.value[V].fullpath],f.value[V].gen_info_obj=gt(I[f.value[V].fullpath])})}function xe(o,t,I,V){let $={diff:{},empty:!0,ownFile:"",otherFile:""};if(t+I<0||t+I>=f.value.length||f.value[t]==null||!("gen_info_obj"in f.value[t])||!("gen_info_obj"in f.value[t+I]))return $;let L=o,x=f.value[t+I].gen_info_obj;if(x==null)return $;let ue=["hashes","resources"];$.diff={},$.ownFile=V.name,$.otherFile=f.value[t+I].name,$.empty=!1,ge.value||ue.push("seed");for(let h in L)if(!ue.includes(h)){if(!(h in x)){$.diff[h]="+";continue}if(L[h]!=x[h])if(h.includes("rompt")&&L[h]!=""&&x[h]!=""){let X=L[h].split(","),Y=x[h].split(","),Z=0;for(let K in X)X[K]!=Y[K]&&Z++;$.diff[h]=Z}else $.diff[h]=[L[h],x[h]]}return $}return(o,t)=>{const I=$t,V=At,$=Pt,L=ne,x=Q,ue=Mt,h=Ft,X=Rt,Y=Bt,Z=Ce,K=Ge,rt=jt,de=Tt,De=Vt,st=W,it=te;return c(),D(it,{spinning:e(F),size:"large"},{default:r(()=>[a(xt,{show:e(g).keepMultiSelect||!!e(C).length,onClearAllSelected:e(at),onSelectAll:e(lt),onReverseSelect:e(ot)},null,8,["show","onClearAllSelected","onSelectAll","onReverseSelect"]),a(I,{style:{display:"none"}}),u("div",{ref_key:"stackViewEl",ref:b,onDragover:t[30]||(t[30]=p(()=>{},["prevent"])),onDrop:t[31]||(t[31]=p(n=>e(Ye)(n),["prevent"])),class:"container"},[a($,{visible:e(re),"onUpdate:visible":t[1]||(t[1]=n=>q(re)?re.value=n:null),width:"70vw","mask-closable":"",onOk:t[2]||(t[2]=n=>re.value=!1)},{cancelText:r(()=>[]),default:r(()=>[a(V,{active:"",loading:!e(Me).isIdle},{default:r(()=>[u("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto","z-index":"9999"},onDblclick:t[0]||(t[0]=n=>e(kt)(e(Pe)))},[u("div",sn,d(o.$t("doubleClickToCopy")),1),U(" "+d(e(Pe)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),u("div",un,[l.walkModePath?(c(),S("div",dn,[a(ue,null,{title:r(()=>[U(d(o.$t("walk-mode-move-message")),1)]),default:r(()=>[a(x,{style:{flex:"1"}},{default:r(()=>[(c(!0),S(ce,null,ke(e(v),(n,B)=>(c(),D(L,{key:B},{default:r(()=>[u("span",null,d(n.curr==="/"?o.$t("root"):n.curr.replace(/:\/$/,o.$t("drive"))),1)]),_:2},1024))),128))]),_:1})]),_:1})])):(c(),S("div",{key:1,class:"breadcrumb",style:_t({flex:e(j)?1:""})},[e(j)?(c(),D(h,{key:0,style:{flex:"1"},value:e(z),"onUpdate:value":t[3]||(t[3]=n=>q(z)?z.value=n:null),onClick:t[4]||(t[4]=p(()=>{},["stop"])),onKeydown:t[5]||(t[5]=p(()=>{},["stop"])),onPressEnter:e(w),"allow-clear":""},null,8,["value","onPressEnter"])):(c(),D(x,{key:1,style:{flex:"1"}},{default:r(()=>[(c(!0),S(ce,null,ke(e(v),(n,B)=>(c(),D(L,{key:B},{default:r(()=>[u("a",{onClick:p(Ee=>e(y)(B),["prevent"])},d(n.curr==="/"?o.$t("root"):n.curr.replace(/:\/$/,o.$t("drive"))),9,cn)]),_:2},1024))),128))]),_:1})),e(j)?(c(),D(X,{key:2,size:"small",onClick:e(w),type:"primary"},{default:r(()=>[U(d(o.$t("go")),1)]),_:1},8,["onClick"])):(c(),S("div",pn,[u("a",{onClick:t[6]||(t[6]=p((...n)=>e(i)&&e(i)(...n),["prevent"])),class:"copy"},d(o.$t("copy")),1),u("a",{onClick:t[7]||(t[7]=p((...n)=>e(T)&&e(T)(...n),["prevent","stop"]))},d(o.$t("edit")),1)]))],4)),u("div",fn,[u("a",{class:"opt",onClick:t[8]||(t[8]=p((...n)=>e(m)&&e(m)(...n),["prevent"]))},d(o.$t("refresh")),1),a(K,null,{overlay:r(()=>[a(Z,null,{default:r(()=>[a(Y,{key:"tag-search"},{default:r(()=>[u("a",{onClick:t[10]||(t[10]=p(n=>e(Se)("tag-search"),["prevent"]))},d(o.$t("imgSearch")),1)]),_:1}),a(Y,{key:"tag-search"},{default:r(()=>[u("a",{onClick:t[11]||(t[11]=p(n=>e(Se)("fuzzy-search"),["prevent"]))},d(o.$t("fuzzy-search")),1)]),_:1})]),_:1})]),default:r(()=>[u("a",{class:"opt",onClick:t[9]||(t[9]=p(()=>{},["prevent"]))},[U(d(o.$t("search"))+" ",1),a(e(be))])]),_:1}),e(Ie)?(c(),S("a",{key:0,class:"opt",onClick:t[12]||(t[12]=p((...n)=>e(G)&&e(G)(...n),["prevent"]))}," Walk ")):O("",!0),u("a",{class:"opt",onClick:t[13]||(t[13]=p((...n)=>e(J)&&e(J)(...n),["prevent","stop"]))},d(o.$t("selectAll")),1),e(bt)?O("",!0):(c(),S("a",{key:1,class:"opt",onClick:t[14]||(t[14]=p((...n)=>e(H)&&e(H)(...n),["prevent"]))},d(o.$t("share")),1)),a(K,null,{overlay:r(()=>[a(Z,null,{default:r(()=>[(c(!0),S(ce,null,ke(e(g).quickMovePaths,n=>(c(),D(Y,{key:n.dir},{default:r(()=>[u("a",{onClick:p(B=>e(M)(n.dir),["prevent"])},d(n.zh),9,mn)]),_:2},1024))),128))]),_:1})]),default:r(()=>[u("a",{class:"opt",onClick:t[15]||(t[15]=p(()=>{},["prevent"]))},[U(d(o.$t("quickMove"))+" ",1),a(e(be))])]),_:1}),a(K,{trigger:["click"],visible:e(fe),"onUpdate:visible":t[26]||(t[26]=n=>q(fe)?fe.value=n:null),placement:"bottomLeft",getPopupContainer:n=>n.parentNode},{overlay:r(()=>[u("div",vn,[a(st,Ct(yt({labelCol:{span:10},wrapperCol:{span:14}})),{default:r(()=>[a(de,{label:o.$t("gridCellWidth")},{default:r(()=>[a(rt,{modelValue:e(le),"onUpdate:modelValue":t[17]||(t[17]=n=>q(le)?le.value=n:null),max:1024,min:64,step:64},null,8,["modelValue"])]),_:1},8,["label"]),a(de,{label:o.$t("sortingMethod")},{default:r(()=>[a(e(ht),{value:e(me),"onUpdate:value":t[18]||(t[18]=n=>q(me)?me.value=n:null),onClick:t[19]||(t[19]=p(()=>{},["stop"])),conv:e(qe),options:e(wt)},null,8,["value","conv","options"])]),_:1},8,["label"]),a(de,{label:o.$t("showChangeIndicators")},{default:r(()=>[a(De,{checked:ie.value,"onUpdate:checked":t[20]||(t[20]=n=>ie.value=n),onClick:Ne},null,8,["checked"])]),_:1},8,["label"]),a(de,{label:o.$t("seedAsChange")},{default:r(()=>[a(De,{checked:ge.value,"onUpdate:checked":t[21]||(t[21]=n=>ge.value=n),disabled:!ie.value},null,8,["checked","disabled"])]),_:1},8,["label"]),u("div",gn,[e(E)?e(E).can_delete?(c(),S("a",{key:1,onClick:t[23]||(t[23]=p((...n)=>e(N)&&e(N)(...n),["prevent"]))},d(o.$t("removeFromSearchScanPathAndQuickMove")),1)):O("",!0):(c(),S("a",{key:0,onClick:t[22]||(t[22]=p((...n)=>e(N)&&e(N)(...n),["prevent"]))},d(o.$t("addToSearchScanPathAndQuickMove")),1))]),u("div",kn,[u("a",{onClick:t[24]||(t[24]=p(n=>e(It)(e(R)+"/"),["prevent"]))},d(o.$t("openWithLocalFileBrowser")),1)]),u("div",_n,[u("a",{onClick:t[25]||(t[25]=p((...n)=>e(oe)&&e(oe)(...n),["prevent"]))},d(o.$t("createFolder")),1)])]),_:1},16)])]),default:r(()=>[u("a",{class:"opt",onClick:t[16]||(t[16]=p(()=>{},["prevent"]))},d(o.$t("more")),1)]),_:1},8,["visible","getPopupContainer"])])]),e(P)?(c(),S("div",bn,[a(e(Jt),{class:"file-list",items:e(f),ref_key:"scroller",ref:k,onScroll:e(Xe),"item-size":e($e).first,"key-field":"fullpath","item-secondary-size":e($e).second,gridItems:e(Ke)},{default:r(({item:n,index:B})=>[a(Xt,{idx:parseInt(B),file:n,"full-screen-preview-image-url":e(f)[e(se)]?e(St)(e(f)[e(se)]):"","show-menu-idx":e(ve),"onUpdate:showMenuIdx":t[27]||(t[27]=Ee=>q(ve)?ve.value=Ee:null),selected:e(C).includes(B),"cell-width":e(le),onFileItemClick:e(tt),onDragstart:e(Ze),onDragend:e(et),onPreviewVisibleChange:e(nt),onContextMenuClick:e(Ae),"is-selected-mutil-files":e(C).length>1,"gen-diff-to-next":xe(n.gen_info_obj,B,1,n),"gen-diff-to-previous":xe(n.gen_info_obj,B,-1,n),"enable-change-indicator":ie.value},null,8,["idx","file","full-screen-preview-image-url","show-menu-idx","selected","cell-width","onFileItemClick","onDragstart","onDragend","onPreviewVisibleChange","onContextMenuClick","is-selected-mutil-files","gen-diff-to-next","gen-diff-to-previous","enable-change-indicator"])]),after:r(()=>[u("div",Cn,[l.walkModePath?(c(),D(X,{key:0,onClick:e(Qe),loading:e(He),block:"",type:"primary",disabled:!e(Je),ghost:""},{default:r(()=>[U(d(o.$t("loadNextPage")),1)]),_:1},8,["onClick","loading","disabled"])):O("",!0)])]),_:1},8,["items","onScroll","item-size","item-secondary-size","gridItems"]),e(Fe)?(c(),S("div",yn,[a(e(Dt),{onClick:t[28]||(t[28]=n=>e(Re)("prev")),class:Ve({disable:!e(Be)("prev")})},null,8,["class"]),a(e(Et),{onClick:t[29]||(t[29]=n=>e(Re)("next")),class:Ve({disable:!e(Be)("next")})},null,8,["class"])])):O("",!0)])):O("",!0)],544),e(Fe)?(c(),D(zt,{key:0,file:e(f)[e(se)],idx:e(se),onContextMenuClick:e(Ae)},null,8,["file","idx","onContextMenuClick"])):O("",!0),a(rn,{"file-num":e(f).length,"selected-file-num":e(C).length},null,8,["file-num","selected-file-num"])]),_:1},8,["spinning"])}}});const Bn=We(hn,[["__scopeId","data-v-2df904bd"]]);export{Bn as default};
