var ln=Object.defineProperty;var sn=(e,t,n)=>t in e?ln(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Qe=(e,t,n)=>(sn(e,typeof t!="symbol"?t+"":t,n),n);import{P as Te,c3 as on,a as ne,d as he,bq as Bt,u as ze,c as w,bZ as Mt,_ as cn,V as de,a0 as we,aj as V,bL as ot,a3 as ct,bo as un,h as ie,c4 as dn,b as fn,ay as vn,c5 as pn,a2 as ut,bK as hn,c6 as mn,c7 as gn,$ as H,b0 as yn,z as te,aA as bn,a1 as wn,ag as ce,c8 as An,aR as kn,c9 as Sn,ca as Cn,aM as $t,am as Be,bn as Ye,cb as In,cc as En,c2 as ke,cd as _n,ce as On,R as ue,ai as L,U as Pn,cf as Ze,x as R,cg as Nt,ch as dt,ci as xn,cj as Tn,ck as zt,cl as G,k as Xe,ah as Bn,cm as Ft,ar as ee,cn as et,l as pe,aC as Me,aw as Mn,ap as De,co as $n,cp as ft,an as Qt,bQ as vt,bP as Nn,cq as Ee,cr as zn,aD as Fn,bO as Dt,cs as Qn,ct as Dn,t as Ve,as as pt,al as me,cu as ht,c1 as Ln,L as oe,J as Rn,bX as mt,cv as jn,cw as Hn,bW as Vn,cx as Un,cy as Jn,cz as Wn,at as Kn,au as qn,ax as Lt,o as x,m as J,cA as Gn,cB as Yn,cC as Zn,cD as Xn,cE as ei,a5 as ti,y as W,cF as Se,C as X,n as $,A as $e,cG as gt,bG as ni,cH as ii,B as ai,N as ye,v as j,r as K,W as Rt,cI as ri,b_ as li,M as jt,cJ as si,cK as oi,p as se,ae as ci,cL as ui,X as di}from"./index-d4a80433.js";import{h as fi,r as vi,a as pi,t as hi}from"./db-5d54cfdc.js";import{t as Le,l as fe,C as mi,g as gi}from"./shortcut-1697535f.js";var Ht=function(){return{arrow:{type:[Boolean,Object],default:void 0},trigger:{type:[Array,String]},overlay:Te.any,visible:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},align:{type:Object},getPopupContainer:Function,prefixCls:String,transitionName:String,placement:String,overlayClassName:String,overlayStyle:{type:Object,default:void 0},forceRender:{type:Boolean,default:void 0},mouseEnterDelay:Number,mouseLeaveDelay:Number,openClassName:String,minOverlayWidthMatchTrigger:{type:Boolean,default:void 0},destroyPopupOnHide:{type:Boolean,default:void 0},onVisibleChange:{type:Function},"onUpdate:visible":{type:Function}}},Re=on(),yi=function(){return ne(ne({},Ht()),{},{type:Re.type,size:String,htmlType:Re.htmlType,href:String,disabled:{type:Boolean,default:void 0},prefixCls:String,icon:Te.any,title:String,loading:Re.loading,onClick:{type:Function}})},bi=["type","disabled","loading","htmlType","class","overlay","trigger","align","visible","onVisibleChange","placement","href","title","icon","mouseEnterDelay","mouseLeaveDelay","overlayClassName","overlayStyle","destroyPopupOnHide","onClick","onUpdate:visible"],wi=de.Group;const Ne=he({compatConfig:{MODE:3},name:"ADropdownButton",inheritAttrs:!1,__ANT_BUTTON:!0,props:Bt(yi(),{trigger:"hover",placement:"bottomRight",type:"default"}),slots:["icon","leftButton","rightButton","overlay"],setup:function(t,n){var i=n.slots,a=n.attrs,r=n.emit,v=function(S){r("update:visible",S),r("visibleChange",S)},c=ze("dropdown-button",t),h=c.prefixCls,y=c.direction,d=c.getPopupContainer;return function(){var m,S,p=ne(ne({},t),a),l=p.type,s=l===void 0?"default":l,o=p.disabled,f=p.loading,A=p.htmlType,g=p.class,u=g===void 0?"":g,I=p.overlay,k=I===void 0?(m=i.overlay)===null||m===void 0?void 0:m.call(i):I,_=p.trigger,E=p.align,T=p.visible;p.onVisibleChange;var C=p.placement,Q=C===void 0?y.value==="rtl"?"bottomLeft":"bottomRight":C,N=p.href,F=p.title,O=p.icon,M=O===void 0?((S=i.icon)===null||S===void 0?void 0:S.call(i))||w(Mt,null,null):O,D=p.mouseEnterDelay,b=p.mouseLeaveDelay,P=p.overlayClassName,z=p.overlayStyle,Y=p.destroyPopupOnHide,U=p.onClick;p["onUpdate:visible"];var Z=cn(p,bi),q={align:E,disabled:o,trigger:o?[]:_,placement:Q,getPopupContainer:d.value,onVisibleChange:v,mouseEnterDelay:D,mouseLeaveDelay:b,visible:T,overlayClassName:P,overlayStyle:z,destroyPopupOnHide:Y},re=w(de,{type:s,disabled:o,loading:f,onClick:U,htmlType:A,href:N,title:F},{default:i.default}),le=w(de,{type:s,icon:M},null);return w(wi,ne(ne({},Z),{},{class:we(h.value,u)}),{default:function(){return[i.leftButton?i.leftButton({button:re}):re,w(ve,q,{default:function(){return[i.rightButton?i.rightButton({button:le}):le]},overlay:function(){return k}})]}})}}});var Vt=he({compatConfig:{MODE:3},name:"ADropdown",inheritAttrs:!1,props:Bt(Ht(),{mouseEnterDelay:.15,mouseLeaveDelay:.1,placement:"bottomLeft",trigger:"hover"}),slots:["overlay"],setup:function(t,n){var i=n.slots,a=n.attrs,r=n.emit,v=ze("dropdown",t),c=v.prefixCls,h=v.rootPrefixCls,y=v.direction,d=v.getPopupContainer,m=V(function(){var s=t.placement,o=s===void 0?"":s,f=t.transitionName;return f!==void 0?f:o.indexOf("top")>=0?"".concat(h.value,"-slide-down"):"".concat(h.value,"-slide-up")}),S=function(){var o,f,A,g=t.overlay||((o=i.overlay)===null||o===void 0?void 0:o.call(i)),u=Array.isArray(g)?g[0]:g;if(!u)return null;var I=u.props||{};ot(!I.mode||I.mode==="vertical","Dropdown",'mode="'.concat(I.mode,`" is not supported for Dropdown's Menu.`));var k=I.selectable,_=k===void 0?!1:k,E=I.expandIcon,T=E===void 0?(f=u.children)===null||f===void 0||(A=f.expandIcon)===null||A===void 0?void 0:A.call(f):E,C=typeof T<"u"&&ut(T)?T:w("span",{class:"".concat(c.value,"-menu-submenu-arrow")},[w(hn,{class:"".concat(c.value,"-menu-submenu-arrow-icon")},null)]),Q=ut(u)?ct(u,{mode:"vertical",selectable:_,expandIcon:function(){return C}}):u;return Q},p=V(function(){var s=t.placement;if(!s)return y.value==="rtl"?"bottomRight":"bottomLeft";if(s.includes("Center")){var o=s.slice(0,s.indexOf("Center"));return ot(!s.includes("Center"),"Dropdown","You are using '".concat(s,"' placement in Dropdown, which is deprecated. Try to use '").concat(o,"' instead.")),o}return s}),l=function(o){r("update:visible",o),r("visibleChange",o)};return function(){var s,o,f=t.arrow,A=t.trigger,g=t.disabled,u=t.overlayClassName,I=(s=i.default)===null||s===void 0?void 0:s.call(i)[0],k=ct(I,un({class:we(I==null||(o=I.props)===null||o===void 0?void 0:o.class,ie({},"".concat(c.value,"-rtl"),y.value==="rtl"),"".concat(c.value,"-trigger"))},g?{disabled:g}:{})),_=we(u,ie({},"".concat(c.value,"-rtl"),y.value==="rtl")),E=g?[]:A,T;E&&E.indexOf("contextmenu")!==-1&&(T=!0);var C=dn({arrowPointAtCenter:fn(f)==="object"&&f.pointAtCenter,autoAdjustOverflow:!0}),Q=vn(ne(ne(ne({},t),a),{},{builtinPlacements:C,overlayClassName:_,arrow:f,alignPoint:T,prefixCls:c.value,getPopupContainer:d.value,transitionName:m.value,trigger:E,onVisibleChange:l,placement:p.value}),["overlay","onUpdate:visible"]);return w(pn,Q,{default:function(){return[k]},overlay:S})}}});Vt.Button=Ne;const ve=Vt;var Ai=function(){return{prefixCls:String,checked:{type:Boolean,default:void 0},onChange:{type:Function},onClick:{type:Function},"onUpdate:checked":Function}},ki=he({compatConfig:{MODE:3},name:"ACheckableTag",props:Ai(),setup:function(t,n){var i=n.slots,a=n.emit,r=ze("tag",t),v=r.prefixCls,c=function(d){var m=t.checked;a("update:checked",!m),a("change",!m),a("click",d)},h=V(function(){var y;return we(v.value,(y={},ie(y,"".concat(v.value,"-checkable"),!0),ie(y,"".concat(v.value,"-checkable-checked"),t.checked),y))});return function(){var y;return w("span",{class:h.value,onClick:c},[(y=i.default)===null||y===void 0?void 0:y.call(i)])}}});const Ue=ki;var Si=new RegExp("^(".concat(mn.join("|"),")(-inverse)?$")),Ci=new RegExp("^(".concat(gn.join("|"),")$")),Ii=function(){return{prefixCls:String,color:{type:String},closable:{type:Boolean,default:!1},closeIcon:Te.any,visible:{type:Boolean,default:void 0},onClose:{type:Function},"onUpdate:visible":Function,icon:Te.any}},be=he({compatConfig:{MODE:3},name:"ATag",props:Ii(),slots:["closeIcon","icon"],setup:function(t,n){var i=n.slots,a=n.emit,r=n.attrs,v=ze("tag",t),c=v.prefixCls,h=v.direction,y=H(!0);yn(function(){t.visible!==void 0&&(y.value=t.visible)});var d=function(l){l.stopPropagation(),a("update:visible",!1),a("close",l),!l.defaultPrevented&&t.visible===void 0&&(y.value=!1)},m=V(function(){var p=t.color;return p?Si.test(p)||Ci.test(p):!1}),S=V(function(){var p;return we(c.value,(p={},ie(p,"".concat(c.value,"-").concat(t.color),m.value),ie(p,"".concat(c.value,"-has-color"),t.color&&!m.value),ie(p,"".concat(c.value,"-hidden"),!y.value),ie(p,"".concat(c.value,"-rtl"),h.value==="rtl"),p))});return function(){var p,l,s,o=t.icon,f=o===void 0?(p=i.icon)===null||p===void 0?void 0:p.call(i):o,A=t.color,g=t.closeIcon,u=g===void 0?(l=i.closeIcon)===null||l===void 0?void 0:l.call(i):g,I=t.closable,k=I===void 0?!1:I,_=function(){return k?u?w("span",{class:"".concat(c.value,"-close-icon"),onClick:d},[u]):w(wn,{class:"".concat(c.value,"-close-icon"),onClick:d},null):null},E={backgroundColor:A&&!m.value?A:void 0},T=f||null,C=(s=i.default)===null||s===void 0?void 0:s.call(i),Q=T?w(te,null,[T,w("span",null,[C])]):C,N="onClick"in r,F=w("span",{class:S.value,style:E},[Q,_()]);return N?w(bn,null,{default:function(){return[F]}}):F}}});be.CheckableTag=Ue;be.install=function(e){return e.component(be.name,be),e.component(Ue.name,Ue),e};const Ei=be;ve.Button=Ne;ve.install=function(e){return e.component(ve.name,ve),e.component(Ne.name,Ne),e};var _i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z"}}]},name:"star",theme:"filled"};const Oi=_i;function yt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){Pi(e,a,n[a])})}return e}function Pi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tt=function(t,n){var i=yt({},t,n.attrs);return w(ce,yt({},i,{icon:Oi}),null)};tt.displayName="StarFilled";tt.inheritAttrs=!1;const Ut=tt;var xi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file",theme:"outlined"};const Ti=xi;function bt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){Bi(e,a,n[a])})}return e}function Bi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nt=function(t,n){var i=bt({},t,n.attrs);return w(ce,bt({},i,{icon:Ti}),null)};nt.displayName="FileOutlined";nt.inheritAttrs=!1;const Mi=nt;var $i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 444H820V330.4c0-17.7-14.3-32-32-32H473L355.7 186.2a8.15 8.15 0 00-5.5-2.2H96c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h698c13 0 24.8-7.9 29.7-20l134-332c1.5-3.8 2.3-7.9 2.3-12 0-17.7-14.3-32-32-32zM136 256h188.5l119.6 114.4H748V444H238c-13 0-24.8 7.9-29.7 20L136 643.2V256zm635.3 512H159l103.3-256h612.4L771.3 768z"}}]},name:"folder-open",theme:"outlined"};const Ni=$i;function wt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){zi(e,a,n[a])})}return e}function zi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var it=function(t,n){var i=wt({},t,n.attrs);return w(ce,wt({},i,{icon:Ni}),null)};it.displayName="FolderOpenOutlined";it.inheritAttrs=!1;const Fi=it;function Qi(e,t,n){if(!An(n))return!1;var i=typeof t;return(i=="number"?kn(n)&&Sn(t,n.length):i=="string"&&t in n)?Cn(n[t],e):!1}function Di(e){return e&&e.length?e[0]:void 0}var Li=Math.ceil,Ri=Math.max;function ji(e,t,n,i){for(var a=-1,r=Ri(Li((t-e)/(n||1)),0),v=Array(r);r--;)v[i?r:++a]=e,e+=n;return v}function Hi(e){return function(t,n,i){return i&&typeof i!="number"&&Qi(t,n,i)&&(n=i=void 0),t=Le(t),n===void 0?(n=t,t=0):n=Le(n),i=i===void 0?t<n?1:-1:Le(i),ji(t,n,i,e)}}var Vi=Hi();const Jt=Vi,Ae=(...e)=>{document.addEventListener(...e),$t(()=>document.removeEventListener(...e))},Ui="data:image/png;base64,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",Ce=new WeakMap;function Ji(e,t){return{useHookShareState:i=>{const a=En();Be(a),Ce.has(a)||(Ce.set(a,Ye(e(a,i??(t==null?void 0:t())))),$t(()=>{Ce.delete(a)}));const r=Ce.get(a);return Be(r),{state:r,toRefs(){return In(r)}}}}}var Wi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-600 72h560v208H232V136zm560 480H232V408h560v208zm0 272H232V680h560v208zM304 240a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"database",theme:"outlined"};const Ki=Wi;function At(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){qi(e,a,n[a])})}return e}function qi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var at=function(t,n){var i=At({},t,n.attrs);return w(ce,At({},i,{icon:Ki}),null)};at.displayName="DatabaseOutlined";at.inheritAttrs=!1;const Gi=at;var Yi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M923 283.6a260.04 260.04 0 00-56.9-82.8 264.4 264.4 0 00-84-55.5A265.34 265.34 0 00679.7 125c-49.3 0-97.4 13.5-139.2 39-10 6.1-19.5 12.8-28.5 20.1-9-7.3-18.5-14-28.5-20.1-41.8-25.5-89.9-39-139.2-39-35.5 0-69.9 6.8-102.4 20.3-31.4 13-59.7 31.7-84 55.5a258.44 258.44 0 00-56.9 82.8c-13.9 32.3-21 66.6-21 101.9 0 33.3 6.8 68 20.3 103.3 11.3 29.5 27.5 60.1 48.2 91 32.8 48.9 77.9 99.9 133.9 151.6 92.8 85.7 184.7 144.9 188.6 147.3l23.7 15.2c10.5 6.7 24 6.7 34.5 0l23.7-15.2c3.9-2.5 95.7-61.6 188.6-147.3 56-51.7 101.1-102.7 133.9-151.6 20.7-30.9 37-61.5 48.2-91 13.5-35.3 20.3-70 20.3-103.3.1-35.3-7-69.6-20.9-101.9z"}}]},name:"heart",theme:"filled"};const Zi=Yi;function kt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){Xi(e,a,n[a])})}return e}function Xi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rt=function(t,n){var i=kt({},t,n.attrs);return w(ce,kt({},i,{icon:Zi}),null)};rt.displayName="HeartFilled";rt.inheritAttrs=!1;const ea=rt;var ta={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M923 283.6a260.04 260.04 0 00-56.9-82.8 264.4 264.4 0 00-84-55.5A265.34 265.34 0 00679.7 125c-49.3 0-97.4 13.5-139.2 39-10 6.1-19.5 12.8-28.5 20.1-9-7.3-18.5-14-28.5-20.1-41.8-25.5-89.9-39-139.2-39-35.5 0-69.9 6.8-102.4 20.3-31.4 13-59.7 31.7-84 55.5a258.44 258.44 0 00-56.9 82.8c-13.9 32.3-21 66.6-21 101.9 0 33.3 6.8 68 20.3 103.3 11.3 29.5 27.5 60.1 48.2 91 32.8 48.9 77.9 99.9 133.9 151.6 92.8 85.7 184.7 144.9 188.6 147.3l23.7 15.2c10.5 6.7 24 6.7 34.5 0l23.7-15.2c3.9-2.5 95.7-61.6 188.6-147.3 56-51.7 101.1-102.7 133.9-151.6 20.7-30.9 37-61.5 48.2-91 13.5-35.3 20.3-70 20.3-103.3.1-35.3-7-69.6-20.9-101.9zM512 814.8S156 586.7 156 385.5C156 283.6 240.3 201 344.3 201c73.1 0 136.5 40.8 167.7 100.4C543.2 241.8 606.6 201 679.7 201c104 0 188.3 82.6 188.3 184.5 0 201.2-356 429.3-356 429.3z"}}]},name:"heart",theme:"outlined"};const na=ta;function St(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){ia(e,a,n[a])})}return e}function ia(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var lt=function(t,n){var i=St({},t,n.attrs);return w(ce,St({},i,{icon:na}),null)};lt.displayName="HeartOutlined";lt.inheritAttrs=!1;const aa=lt;var ra={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3zM664.8 561.6l36.1 210.3L512 672.7 323.1 772l36.1-210.3-152.8-149L417.6 382 512 190.7 606.4 382l211.2 30.7-152.8 148.9z"}}]},name:"star",theme:"outlined"};const la=ra;function Ct(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){sa(e,a,n[a])})}return e}function sa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var st=function(t,n){var i=Ct({},t,n.attrs);return w(ce,Ct({},i,{icon:la}),null)};st.displayName="StarOutlined";st.inheritAttrs=!1;const Wt=st;const ge=async e=>(await ke.value.get("/files",{params:{folder_path:e}})).data,oa=async e=>(await ke.value.post("/delete_files",{file_paths:e})).data,Kt=async(e,t,n)=>(await ke.value.post("/move_files",{file_paths:e,dest:t,create_dest_folder:n})).data,ca=async(e,t,n)=>(await ke.value.post("/copy_files",{file_paths:e,dest:t,create_dest_folder:n})).data,ua=async e=>{await ke.value.post("/mkdirs",{dest_folder:e})};var qt={exports:{}};/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */(function(e,t){(function(n,i){e.exports=i})(_n,function(){var n={};n.version="0.3.5";var i=n.settings={minimum:.08,easing:"linear",positionUsing:"",speed:200,trickle:!0,trickleSpeed:200,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};n.configure=function(l){var s,o;for(s in l)o=l[s],o!==void 0&&l.hasOwnProperty(s)&&(i[s]=o);return this},n.status=null,n.set=function(l){var s=n.isStarted();l=a(l,i.minimum,1),n.status=l===1?null:l;var o=n.render(!s),f=o.querySelector(i.barSelector),A=i.speed,g=i.easing;return o.offsetWidth,c(function(u){i.positionUsing===""&&(i.positionUsing=n.getPositioningCSS()),h(f,v(l,A,g)),l===1?(h(o,{transition:"none",opacity:1}),o.offsetWidth,setTimeout(function(){h(o,{transition:"all "+A+"ms linear",opacity:0}),setTimeout(function(){n.remove(),u()},A)},A)):setTimeout(u,A)}),this},n.isStarted=function(){return typeof n.status=="number"},n.start=function(){n.status||n.set(0);var l=function(){setTimeout(function(){n.status&&(n.trickle(),l())},i.trickleSpeed)};return i.trickle&&l(),this},n.done=function(l){return!l&&!n.status?this:n.inc(.3+.5*Math.random()).set(1)},n.inc=function(l){var s=n.status;return s?s>1?void 0:(typeof l!="number"&&(s>=0&&s<.2?l=.1:s>=.2&&s<.5?l=.04:s>=.5&&s<.8?l=.02:s>=.8&&s<.99?l=.005:l=0),s=a(s+l,0,.994),n.set(s)):n.start()},n.trickle=function(){return n.inc()},function(){var l=0,s=0;n.promise=function(o){return!o||o.state()==="resolved"?this:(s===0&&n.start(),l++,s++,o.always(function(){s--,s===0?(l=0,n.done()):n.set((l-s)/l)}),this)}}(),n.getElement=function(){var l=n.getParent();if(l){var s=Array.prototype.slice.call(l.querySelectorAll(".nprogress")).filter(function(o){return o.parentElement===l});if(s.length>0)return s[0]}return null},n.getParent=function(){if(i.parent instanceof HTMLElement)return i.parent;if(typeof i.parent=="string")return document.querySelector(i.parent)},n.render=function(l){if(n.isRendered())return n.getElement();d(document.documentElement,"nprogress-busy");var s=document.createElement("div");s.id="nprogress",s.className="nprogress",s.innerHTML=i.template;var o=s.querySelector(i.barSelector),f=l?"-100":r(n.status||0),A=n.getParent(),g;return h(o,{transition:"all 0 linear",transform:"translate3d("+f+"%,0,0)"}),i.showSpinner||(g=s.querySelector(i.spinnerSelector),g&&p(g)),A!=document.body&&d(A,"nprogress-custom-parent"),A.appendChild(s),s},n.remove=function(){n.status=null,m(document.documentElement,"nprogress-busy"),m(n.getParent(),"nprogress-custom-parent");var l=n.getElement();l&&p(l)},n.isRendered=function(){return!!n.getElement()},n.getPositioningCSS=function(){var l=document.body.style,s="WebkitTransform"in l?"Webkit":"MozTransform"in l?"Moz":"msTransform"in l?"ms":"OTransform"in l?"O":"";return s+"Perspective"in l?"translate3d":s+"Transform"in l?"translate":"margin"};function a(l,s,o){return l<s?s:l>o?o:l}function r(l){return(-1+l)*100}function v(l,s,o){var f;return i.positionUsing==="translate3d"?f={transform:"translate3d("+r(l)+"%,0,0)"}:i.positionUsing==="translate"?f={transform:"translate("+r(l)+"%,0)"}:f={"margin-left":r(l)+"%"},f.transition="all "+s+"ms "+o,f}var c=function(){var l=[];function s(){var o=l.shift();o&&o(s)}return function(o){l.push(o),l.length==1&&s()}}(),h=function(){var l=["Webkit","O","Moz","ms"],s={};function o(u){return u.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(I,k){return k.toUpperCase()})}function f(u){var I=document.body.style;if(u in I)return u;for(var k=l.length,_=u.charAt(0).toUpperCase()+u.slice(1),E;k--;)if(E=l[k]+_,E in I)return E;return u}function A(u){return u=o(u),s[u]||(s[u]=f(u))}function g(u,I,k){I=A(I),u.style[I]=k}return function(u,I){var k=arguments,_,E;if(k.length==2)for(_ in I)E=I[_],E!==void 0&&I.hasOwnProperty(_)&&g(u,_,E);else g(u,k[1],k[2])}}();function y(l,s){var o=typeof l=="string"?l:S(l);return o.indexOf(" "+s+" ")>=0}function d(l,s){var o=S(l),f=o+s;y(o,s)||(l.className=f.substring(1))}function m(l,s){var o=S(l),f;y(l,s)&&(f=o.replace(" "+s+" "," "),l.className=f.substring(1,f.length-1))}function S(l){return(" "+(l&&l.className||"")+" ").replace(/\s+/gi," ")}function p(l){l&&l.parentNode&&l.parentNode.removeChild(l)}return n})})(qt);var da=qt.exports;const fa=On(da),va=e=>{const t=H("");return new Promise(n=>{ue.confirm({title:L("inputFolderName"),content:()=>w(Pn,{value:t.value,"onUpdate:value":i=>t.value=i},null),async onOk(){if(!t.value)return;const i=Ze(e,t.value);await ua(i),n()}})})},Gt=()=>w("p",{style:{background:"var(--zp-secondary-background)",padding:"8px",borderLeft:"4px solid var(--primary-color)"}},[R("Tips: "),L("multiSelectTips")]);function pa(){const e=[];for(let a=0;a<72;a++){const v=`hsl(${a*7.2}, 90%, 35%)`;e.push(v)}return e}const It=pa(),Yt=Nt("useTagStore",()=>{const e=Ye(new Map),t=async r=>{if(r=r.filter(v=>!e.has(v)),!!r.length)try{r.forEach(c=>e.set(c,[]));const v=await fi(r);for(const c in v)e.set(c,v[c])}catch{r.forEach(v=>e.delete(v))}},n=new Map;return{tagMap:e,getColor:r=>{let v=n.get(r);if(!v){const c=dt.hash.sha256.hash(r),h=parseInt(dt.codec.hex.fromBits(c),16)%It.length;v=It[h],n.set(r,v)}return v},fetchImageTags:t,refreshTags:async r=>{r.forEach(v=>e.delete(v)),await t(r)}}}),ha=Nt("useBatchDownloadStore",()=>{const e=H([]);return{selectdFiles:e,addFiles:n=>{e.value=xn([...e.value,...n])}}});class Et{constructor(t,n=Tn.CREATED_TIME_DESC){Qe(this,"root");Qe(this,"execQueue",[]);this.sortMethod=n,this.root={children:[],info:{name:t,size:"-",bytes:0,created_time:"",is_under_scanned_path:!0,date:"",type:"dir",fullpath:t}},this.fetchChildren(this.root)}reset(){return this.root.children=[],this.fetchChildren(this.root)}get images(){const t=n=>n.children.map(i=>{if(i.info.type==="dir")return t(i);if(G(i.info.name))return i.info}).filter(i=>i).flat(1);return t(this.root)}get isCompleted(){return this.execQueue.length===0}async fetchChildren(t){const{files:n}=await ge(t.info.fullpath);return t.children=zt(n,this.sortMethod).map(i=>({info:i,children:[]})),this.execQueue.shift(),this.execQueue.unshift(...t.children.filter(i=>i.info.type==="dir").map(i=>({fn:()=>this.fetchChildren(i),...i}))),t}async next(){const t=Di(this.execQueue);if(!t)return null;const n=await t.fn();return this.execQueue=this.execQueue.slice(),this.root={...this.root},n}}function je(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Vn(e)}const _e=new Map,B=Xe(),ma=ha(),Zt=Yt(),_t=Bn(),Ie=new BroadcastChannel("iib-image-transfer-bus"),{eventEmitter:Oe,useEventListen:Je}=Ft(),{useHookShareState:ae}=Ji((e,{images:t})=>{const n=H({tabIdx:-1,paneIdx:-1}),i=V(()=>fe(a.value)),a=H([]),r=V(()=>{var A;return a.value.map(g=>g.curr).slice((A=B.conf)!=null&&A.is_win?1:0)}),v=V(()=>Ze(...r.value)),c=H(B.defaultSortingMethod),h=H(n.value.walkModePath?new Et(n.value.walkModePath,c.value):void 0);pe([()=>n.value.walkModePath,c],()=>{h.value=n.value.walkModePath?new Et(n.value.walkModePath,c.value):void 0});const y=Ye(new Set);pe(i,()=>y.clear());const d=V(()=>{var I;if(t.value)return t.value;if(h.value)return h.value.images.filter(k=>!y.has(k.fullpath));if(!i.value)return[];const A=((I=i.value)==null?void 0:I.files)??[],g=c.value;return zt((k=>B.onlyFoldersAndImages?k.filter(_=>_.type==="dir"||G(_.name)):k)(A),g).filter(k=>!y.has(k.fullpath))}),m=H([]),S=H(-1),p=V(()=>h.value?!h.value.isCompleted:!1),l=H(!1),s=H(!1),o=()=>{var A,g,u;return(u=(g=(A=B.tabList)==null?void 0:A[n.value.tabIdx])==null?void 0:g.panes)==null?void 0:u[n.value.paneIdx]},f=Ft();return f.useEventListen("selectAll",()=>{console.log(`select all 0 -> ${d.value.length}`),m.value=Jt(0,d.value.length)}),{previewing:s,spinning:l,canLoadNext:p,multiSelectedIdxs:m,previewIdx:S,basePath:r,currLocation:v,currPage:i,stack:a,sortMethod:c,sortedFiles:d,scroller:H(),stackViewEl:H(),props:n,getPane:o,walker:h,deletedFiles:y,...f}},()=>({images:H()}));function ir(){const{previewIdx:e,eventEmitter:t,canLoadNext:n,previewing:i,sortedFiles:a,scroller:r,props:v}=ae().toRefs(),{state:c}=ae();let h=null;const y=(p,l)=>{var s;i.value=p,h!=null&&!p&&l&&((s=r.value)==null||s.scrollToItem(h),h=null)},d=()=>{v.value.walkModePath&&!S("next")&&n&&(ee.info(L("loadingNextFolder")),t.value.emit("loadNextDir",!0))};Ae("keydown",p=>{var l;if(i.value){let s=e.value;if(["ArrowDown","ArrowRight"].includes(p.key))for(s++;a.value[s]&&!G(a.value[s].name);)s++;else if(["ArrowUp","ArrowLeft"].includes(p.key))for(s--;a.value[s]&&!G(a.value[s].name);)s--;if(G((l=a.value[s])==null?void 0:l.name)??""){e.value=s;const o=r.value;o&&!(s>=o.$_startIndex&&s<=o.$_endIndex)&&(h=s)}d()}});const m=p=>{var s;let l=e.value;if(p==="next")for(l++;a.value[l]&&!G(a.value[l].name);)l++;else if(p==="prev")for(l--;a.value[l]&&!G(a.value[l].name);)l--;if(G((s=a.value[l])==null?void 0:s.name)??""){e.value=l;const o=r.value;o&&!(l>=o.$_startIndex&&l<=o.$_endIndex)&&(h=l)}d()},S=p=>{var s;let l=e.value;if(p==="next")for(l++;a.value[l]&&!G(a.value[l].name);)l++;else if(p==="prev")for(l--;a.value[l]&&!G(a.value[l].name);)l--;return G((s=a.value[l])==null?void 0:s.name)??""};return Je("removeFiles",async()=>{var p;i.value&&!c.sortedFiles[e.value]&&(ee.info(L("manualExitFullScreen"),5),await et(500),(p=document.querySelector(".ant-image-preview-operations-operation .anticon-close"))==null||p.click(),e.value=-1)}),{previewIdx:e,onPreviewVisibleChange:y,previewing:i,previewImgMove:m,canPreview:S}}function ar(){const e=H(),{scroller:t,stackViewEl:n,stack:i,currPage:a,currLocation:r,useEventListen:v,eventEmitter:c,getPane:h,props:y,deletedFiles:d,walker:m,sortedFiles:S}=ae().toRefs();pe(()=>i.value.length,Me((b,P)=>{var z;b!==P&&((z=t.value)==null||z.scrollToItem(0))},300));const p=async b=>{var P;await A(b),y.value.walkModePath&&(await et(),await((P=m.value)==null?void 0:P.reset()),c.value.emit("loadNextDir"))};Mn(async()=>{var b;if(!i.value.length){const P=await ge("/");i.value.push({files:P.files,curr:"/"})}e.value=new fa,e.value.configure({parent:n.value}),y.value.path&&y.value.path!=="/"?await p(y.value.walkModePath??y.value.path):(b=B.conf)!=null&&b.home&&A(B.conf.home)}),pe(r,Me(b=>{const P=h.value();if(!P)return;P.path=b;const z=P.path.split("/").pop(),U=(()=>{var Z;if(!y.value.walkModePath){const q=Ee(b);for(const[re,le]of Object.entries(B.pathAliasMap))if(q.startsWith(le))return q.replace(le,re);return z}return"Walk: "+(((Z=B.quickMovePaths.find(q=>q.dir===P.walkModePath))==null?void 0:Z.zh)??z)})();P.name=De("div",{style:"display:flex;align-items:center"},[De(Gi),De("span",{class:"line-clamp-1",style:"max-width: 256px"},U)]),P.nameFallbackStr=U,B.recent=B.recent.filter(Z=>Z.key!==P.key),B.recent.unshift({path:b,key:P.key}),B.recent.length>20&&(B.recent=B.recent.slice(0,20))},300));const l=()=>Ve(r.value),s=async b=>{var P,z;if(b.type==="dir")try{(P=e.value)==null||P.start();const{files:Y}=await ge(b.fullpath);i.value.push({files:Y,curr:b.name})}finally{(z=e.value)==null||z.done()}},o=b=>{for(;b<i.value.length-1;)i.value.pop()},f=(b,P)=>(Be(B.conf,"global.conf load failed"),B.conf.is_win?b.toLowerCase()==P.toLowerCase():b==P),A=async b=>{var z,Y;const P=i.value.slice();try{$n(b)||(b=Ze(((z=B.conf)==null?void 0:z.sd_cwd)??"/",b));const U=ft(b),Z=i.value.map(q=>q.curr);for(Z.shift();Z[0]&&U[0]&&f(Z[0],U[0]);)Z.shift(),U.shift();for(let q=0;q<Z.length;q++)i.value.pop();if(!U.length)return g();for(const q of U){const re=(Y=a.value)==null?void 0:Y.files.find(le=>f(le.name,q));if(!re)throw console.error({frags:U,frag:q,stack:Qt(i.value)}),new Error(`${q} not found`);await s(re)}}catch(U){throw ee.error(L("moveFailedCheckPath")+(U instanceof Error?U.message:"")),console.error(b,ft(b),a.value),i.value=P,U}},g=vt(async()=>{var b,P,z;try{if((b=e.value)==null||b.start(),m.value)await m.value.reset(),c.value.emit("loadNextDir");else{const{files:Y}=await ge(i.value.length===1?"/":r.value);fe(i.value).files=Y}d.value.clear(),(P=t.value)==null||P.scrollToItem(0),ee.success(L("refreshCompleted"))}finally{(z=e.value)==null||z.done()}});Nn("returnToIIB",vt(async()=>{var b,P;if(!y.value.walkModePath)try{(b=e.value)==null||b.start();const{files:z}=await ge(i.value.length===1?"/":r.value);fe(i.value).files.map(U=>U.date).join()!==z.map(U=>U.date).join()&&(fe(i.value).files=z,ee.success(L("autoUpdate")))}finally{(P=e.value)==null||P.done()}})),v.value("refresh",g);const u=b=>{y.value.walkModePath&&(h.value().walkModePath=b),p(b)},I=V(()=>B.quickMovePaths.map(b=>({...b,path:Ee(b.dir)}))),k=V(()=>{const b=Ee(r.value);return I.value.find(z=>z.path===b)}),_=async()=>{const b=k.value;if(b){if(!b.can_delete)return;await vi(r.value),ee.success(L("removeCompleted"))}else await pi(r.value),ee.success(L("addCompleted"));pt.emit("searchIndexExpired"),pt.emit("updateGlobalSetting")},E=H(!1),T=H(r.value),C=()=>{E.value=!0,T.value=r.value},Q=async()=>{await A(T.value),E.value=!1};Ae("click",()=>{E.value=!1});const N=()=>{const b=parent.location,P=b.href.substring(0,b.href.length-b.search.length),z=new URLSearchParams(b.search);z.set("action","open"),m.value&&z.set("walk","1"),z.set("path",r.value);const Y=`${P}?${z.toString()}`;Ve(Y,L("copyLocationUrlSuccessMsg"))},F=()=>c.value.emit("selectAll"),O=async()=>{await va(r.value),await g()},M=()=>{const b=r.value;_e.set(b,i.value);const P=B.tabList[y.value.tabIdx],z={type:"local",key:me(),path:b,name:L("local"),stackKey:b,walkModePath:b};P.panes.push(z),P.key=z.key},D=V(()=>!m.value&&S.value.some(b=>b.type==="dir"));return{locInputValue:T,isLocationEditing:E,onLocEditEnter:Q,onEditBtnClick:C,addToSearchScanPathAndQuickMove:_,searchPathInfo:k,refresh:g,copyLocation:l,back:o,openNext:s,currPage:a,currLocation:r,to:A,stack:i,scroller:t,share:N,selectAll:F,quickMoveTo:u,onCreateFloderBtnClick:O,onWalkBtnClick:M,showWalkButton:D}}function rr(){const{scroller:e,sortedFiles:t,sortMethod:n,currLocation:i,stackViewEl:a,canLoadNext:r,previewIdx:v,props:c,walker:h}=ae().toRefs(),{state:y}=ae(),d=H(!1),m=H(B.defaultGridCellWidth),S=V(()=>m.value+16),p=44,{width:l}=zn(a),s=V(()=>~~(l.value/S.value)),o=V(()=>{const k=S.value;return{first:k+(m.value<=160?0:p),second:k}}),f=H(!1),A=async()=>{var k;if(!(f.value||!c.value.walkModePath||!r.value))try{f.value=!0,await((k=h.value)==null?void 0:k.next())}finally{f.value=!1}},g=async(k=!1)=>{const _=e.value,E=()=>k?v.value:(_==null?void 0:_.$_endIndex)??0;for(;!t.value.length||E()>t.value.length-20&&r.value;)await et(30),await A()};y.useEventListen("loadNextDir",g);const u=()=>{const k=e.value;if(k){const _=t.value.slice(Math.max(k.$_startIndex-10,0),k.$_endIndex+10).filter(E=>E.is_under_scanned_path&&G(E.name)).map(E=>E.fullpath);Zt.fetchImageTags(_)}};pe(i,Me(u,150));const I=Me(()=>{g(),u()},300);return{gridItems:s,sortedFiles:t,sortMethodConv:Fn,moreActionsDropdownShow:d,gridSize:S,sortMethod:n,onScroll:I,loadNextDir:A,loadNextDirLoading:f,canLoadNext:r,itemSize:o,cellWidth:m,onViewedImagesChange:u}}function lr(){const{currLocation:e,sortedFiles:t,currPage:n,multiSelectedIdxs:i,eventEmitter:a,walker:r}=ae().toRefs(),v=()=>{i.value=[]};return Ae("click",v),Ae("blur",v),pe(n,v),{onFileDragStart:(d,m)=>{const S=Qt(t.value[m]);_t.fileDragging=!0,console.log("onFileDragStart set drag file ",d,m,S);const p=[S];let l=S.type==="dir";if(i.value.includes(m)){const o=i.value.map(f=>t.value[f]);p.push(...o),l=o.some(f=>f.type==="dir")}const s={includeDir:l,loc:e.value||"search-result",path:ht(p,"fullpath").map(o=>o.fullpath),nodes:ht(p,"fullpath"),__id:"FileTransferData"};d.dataTransfer.setData("text/plain",JSON.stringify(s))},onDrop:async d=>{if(r.value)return;const m=Ln(d);if(!m)return;const S=e.value;if(m.loc===S)return;const p=Dt(),l=async()=>p.pushAction(async()=>{await ca(m.path,S),a.value.emit("refresh"),ue.destroyAll()}),s=()=>p.pushAction(async()=>{await Kt(m.path,S),Oe.emit("removeFiles",{paths:m.path,loc:m.loc}),a.value.emit("refresh"),ue.destroyAll()});ue.confirm({title:L("confirm")+"?",width:"60vw",content:()=>{let o,f,A;return w("div",null,[w("div",null,[`${L("moveSelectedFilesTo")} ${S}`,w("ol",{style:{maxHeight:"50vh",overflow:"auto"}},[m.path.map(g=>w("li",null,[g.split(/[/\\]/).pop()]))])]),w(Gt,null,null),w("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end"},class:"actions"},[w(de,{onClick:ue.destroyAll},je(o=L("cancel"))?o:{default:()=>[o]}),w(de,{type:"primary",loading:!p.isIdle,onClick:l},je(f=L("copy"))?f:{default:()=>[f]}),w(de,{type:"primary",loading:!p.isIdle,onClick:s},je(A=L("move"))?A:{default:()=>[A]})])])},maskClosable:!0,wrapClassName:"hidden-antd-btns-modal"})},multiSelectedIdxs:i,onFileDragEnd:()=>{_t.fileDragging=!1}}}function sr({openNext:e}){const t=H(!1),n=H(""),{sortedFiles:i,previewIdx:a,multiSelectedIdxs:r,stack:v,currLocation:c,spinning:h,previewing:y,stackViewEl:d,eventEmitter:m,props:S,deletedFiles:p}=ae().toRefs(),l=Ee;Je("removeFiles",({paths:g,loc:u})=>{l(u)!==l(c.value)||!fe(v.value)||(g.forEach(k=>p.value.add(k)),g.filter(G).forEach(k=>p.value.add(k.replace(/\.\w+$/,".txt"))))}),Je("addFiles",({files:g,loc:u})=>{if(l(u)!==l(c.value))return;const I=fe(v.value);I&&I.files.unshift(...g)});const s=Dt(),o=async(g,u,I)=>{a.value=I,B.fullscreenPreviewInitialUrl=oe(u);const k=r.value.indexOf(I);if(g.shiftKey){if(k!==-1)r.value.splice(k,1);else{r.value.push(I),r.value.sort((T,C)=>T-C);const _=r.value[0],E=r.value[r.value.length-1];r.value=Jt(_,E+1)}g.stopPropagation()}else g.ctrlKey||g.metaKey?(k!==-1?r.value.splice(k,1):r.value.push(I),g.stopPropagation()):await e(u)},f=async(g,u,I)=>{var Q,N,F;const k=oe(u),_=c.value,E={IIB_container_id:parent.IIB_container_id},T=()=>{let O=[];return r.value.includes(I)?O=r.value.map(M=>i.value[M]):O.push(u),O},C=async O=>{if(!h.value)try{h.value=!0,await Un(u.fullpath),Ie.postMessage({...E,event:"click_hidden_button",btnEleId:"iib_hidden_img_update_trigger"});const M=setTimeout(()=>Jn.warn({message:L("long_loading"),duration:20}),5e3);await Wn(),clearTimeout(M),Ie.postMessage({...E,event:"click_hidden_button",btnEleId:`iib_hidden_tab_${O}`})}catch(M){console.error(M),ee.error("发送图像失败，请携带console的错误消息找开发者")}finally{h.value=!1}};if(`${g.key}`.startsWith("toggle-tag-")){const O=+`${g.key}`.split("toggle-tag-")[1],{is_remove:M}=await hi({tag_id:O,img_path:u.fullpath}),D=(N=(Q=B.conf)==null?void 0:Q.all_custom_tags.find(b=>b.id===O))==null?void 0:N.name;Zt.refreshTags([u.fullpath]),ee.success(L(M?"removedTagFromImage":"addedTagToImage",{tag:D}));return}switch(g.key){case"previewInNewWindow":return window.open(k);case"download":{const O=T();Hn(O.map(M=>oe(M,!0)));break}case"copyPreviewUrl":return Ve(parent.document.location.origin+k);case"send2txt2img":return C("txt2img");case"send2img2img":return C("img2img");case"send2inpaint":return C("inpaint");case"send2extras":return C("extras");case"send2savedDir":{const O=B.quickMovePaths.find(b=>b.key==="outdir_save");if(!O)return ee.error(L("unknownSavedDir"));const M=jn(O.dir,(F=B.conf)==null?void 0:F.sd_cwd),D=T();await Kt(D.map(b=>b.fullpath),M,!0),Oe.emit("removeFiles",{paths:D.map(b=>b.fullpath),loc:c.value}),Oe.emit("addFiles",{files:D,loc:M});break}case"send2controlnet-img2img":case"send2controlnet-txt2img":{const O=g.key.split("-")[1];Ie.postMessage({...E,event:"send_to_control_net",type:O,url:oe(u)});break}case"send2outpaint":{n.value=await s.pushAction(()=>mt(u.fullpath)).res;const[O,M]=(n.value||"").split(`
`);Ie.postMessage({...E,event:"send_to_outpaint",url:oe(u),prompt:O,negPrompt:M.slice(17)});break}case"openWithWalkMode":{_e.set(_,v.value);const O=B.tabList[S.value.tabIdx],M={type:"local",key:me(),path:u.fullpath,name:L("local"),stackKey:_,walkModePath:u.fullpath};O.panes.push(M),O.key=M.key;break}case"openInNewTab":{_e.set(_,v.value);const O=B.tabList[S.value.tabIdx],M={type:"local",key:me(),path:u.fullpath,name:L("local"),stackKey:_};O.panes.push(M),O.key=M.key;break}case"openOnTheRight":{_e.set(_,v.value);let O=B.tabList[S.value.tabIdx+1];O||(O={panes:[],key:"",id:me()},B.tabList[S.value.tabIdx+1]=O);const M={type:"local",key:me(),path:u.fullpath,name:L("local"),stackKey:_};O.panes.push(M),O.key=M.key;break}case"send2BatchDownload":{ma.addFiles(T());break}case"viewGenInfo":{t.value=!0,n.value=await s.pushAction(()=>mt(u.fullpath)).res;break}case"openWithLocalFileBrowser":{await Rn(u.fullpath);break}case"deleteFiles":{const O=T(),M=async()=>{const D=O.map(b=>b.fullpath);await oa(D),ee.success(L("deleteSuccess")),Oe.emit("removeFiles",{paths:D,loc:c.value})};if(O.length===1&&B.ignoredConfirmActions.deleteOneOnly)return M();await new Promise(D=>{ue.confirm({title:L("confirmDelete"),maskClosable:!0,width:"60vw",content:()=>w("div",null,[w("ol",{style:{maxHeight:"50vh",overflow:"auto"}},[O.map(b=>w("li",null,[b.fullpath.split(/[/\\]/).pop()]))]),w(Gt,null,null),w(mi,{checked:B.ignoredConfirmActions.deleteOneOnly,"onUpdate:checked":b=>B.ignoredConfirmActions.deleteOneOnly=b},{default:()=>[L("deleteOneOnlySkipConfirm"),R(" ("),L("resetOnGlobalSettingsPage"),R(")")]})]),async onOk(){await M(),D()}})});break}}return{}},{isOutside:A}=Qn(d);return Ae("keydown",g=>{var I,k,_;const u=gi(g);if(y.value){const E=(I=Object.entries(B.shortcut).find(T=>T[1]===u&&T[1]))==null?void 0:I[0];if(E){g.stopPropagation(),g.preventDefault();const T=a.value,C=i.value[T];switch(E){case"delete":return oe(C)===B.fullscreenPreviewInitialUrl?ee.warn(L("fullscreenRestriction")):f({key:"deleteFiles"},C,T);default:{const Q=(k=/^toggle_tag_(.*)$/.exec(E))==null?void 0:k[1],N=(_=B.conf)==null?void 0:_.all_custom_tags.find(F=>F.name===Q);return N?f({key:`toggle-tag-${N.id}`},C,T):void 0}}}}else!A.value&&["Ctrl + KeyA","Cmd + KeyA"].includes(u)&&(g.preventDefault(),g.stopPropagation(),m.value.emit("selectAll"))}),{onFileItemClick:o,onContextMenuClick:f,showGenInfo:t,imageGenInfo:n,q:s}}const or=()=>{const{stackViewEl:e}=ae().toRefs(),t=H(-1);return Dn(e,n=>{var a;let i=n.target;for(;i.parentElement;)if(i=i.parentElement,i.tagName.toLowerCase()==="li"&&i.classList.contains("file-item-trigger")){const r=(a=i.dataset)==null?void 0:a.idx;r&&Number.isSafeInteger(+r)&&(t.value=+r);return}}),{showMenuIdx:t}};function ga(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);var n=e.indexOf("Trident/");if(n>0){var i=e.indexOf("rv:");return parseInt(e.substring(i+3,e.indexOf(".",i)),10)}var a=e.indexOf("Edge/");return a>0?parseInt(e.substring(a+5,e.indexOf(".",a)),10):-1}let Pe;function We(){We.init||(We.init=!0,Pe=ga()!==-1)}var Fe={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){We(),Lt(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const e=document.createElement("object");this._resizeObject=e,e.setAttribute("aria-hidden","true"),e.setAttribute("tabindex",-1),e.onload=this.addResizeHandlers,e.type="text/html",Pe&&this.$el.appendChild(e),e.data="about:blank",Pe||this.$el.appendChild(e)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!Pe&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const ya=Gn();Kn("data-v-b329ee4c");const ba={class:"resize-observer",tabindex:"-1"};qn();const wa=ya((e,t,n,i,a,r)=>(x(),J("div",ba)));Fe.render=wa;Fe.__scopeId="data-v-b329ee4c";Fe.__file="src/components/ResizeObserver.vue";function xe(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?xe=function(t){return typeof t}:xe=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xe(e)}function Aa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ot(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ka(e,t,n){return t&&Ot(e.prototype,t),n&&Ot(e,n),e}function Pt(e){return Sa(e)||Ca(e)||Ia(e)||Ea()}function Sa(e){if(Array.isArray(e))return Ke(e)}function Ca(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Ia(e,t){if(e){if(typeof e=="string")return Ke(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ke(e,t)}}function Ke(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Ea(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _a(e){var t;return typeof e=="function"?t={callback:e}:t=e,t}function Oa(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,a,r,v=function(h){for(var y=arguments.length,d=new Array(y>1?y-1:0),m=1;m<y;m++)d[m-1]=arguments[m];if(r=d,!(i&&h===a)){var S=n.leading;typeof S=="function"&&(S=S(h,a)),(!i||h!==a)&&S&&e.apply(void 0,[h].concat(Pt(r))),a=h,clearTimeout(i),i=setTimeout(function(){e.apply(void 0,[h].concat(Pt(r))),i=0},t)}};return v._clear=function(){clearTimeout(i),i=null},v}function Xt(e,t){if(e===t)return!0;if(xe(e)==="object"){for(var n in e)if(!Xt(e[n],t[n]))return!1;return!0}return!1}var Pa=function(){function e(t,n,i){Aa(this,e),this.el=t,this.observer=null,this.frozen=!1,this.createObserver(n,i)}return ka(e,[{key:"createObserver",value:function(n,i){var a=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=_a(n),this.callback=function(c,h){a.options.callback(c,h),c&&a.options.once&&(a.frozen=!0,a.destroyObserver())},this.callback&&this.options.throttle){var r=this.options.throttleOptions||{},v=r.leading;this.callback=Oa(this.callback,this.options.throttle,{leading:function(h){return v==="both"||v==="visible"&&h||v==="hidden"&&!h}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(c){var h=c[0];if(c.length>1){var y=c.find(function(m){return m.isIntersecting});y&&(h=y)}if(a.callback){var d=h.isIntersecting&&h.intersectionRatio>=a.threshold;if(d===a.oldResult)return;a.oldResult=d,a.callback(d,h)}},this.options.intersection),Lt(function(){a.observer&&a.observer.observe(a.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),e}();function en(e,t,n){var i=t.value;if(i)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var a=new Pa(e,i,n);e._vue_visibilityState=a}}function xa(e,t,n){var i=t.value,a=t.oldValue;if(!Xt(i,a)){var r=e._vue_visibilityState;if(!i){tn(e);return}r?r.createObserver(i,n):en(e,{value:i},n)}}function tn(e){var t=e._vue_visibilityState;t&&(t.destroyObserver(),delete e._vue_visibilityState)}var Ta={beforeMount:en,updated:xa,unmounted:tn},Ba={itemsLimit:1e3},Ma=/(auto|scroll)/;function nn(e,t){return e.parentNode===null?t:nn(e.parentNode,t.concat([e]))}var He=function(t,n){return getComputedStyle(t,null).getPropertyValue(n)},$a=function(t){return He(t,"overflow")+He(t,"overflow-y")+He(t,"overflow-x")},Na=function(t){return Ma.test($a(t))};function xt(e){if(e instanceof HTMLElement||e instanceof SVGElement){for(var t=nn(e.parentNode,[]),n=0;n<t.length;n+=1)if(Na(t[n]))return t[n];return document.scrollingElement||document.documentElement}}function qe(e){"@babel/helpers - typeof";return qe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qe(e)}var za={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(t){return["vertical","horizontal"].includes(t)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function Fa(){return this.items.length&&qe(this.items[0])!=="object"}var Ge=!1;if(typeof window<"u"){Ge=!1;try{var Qa=Object.defineProperty({},"passive",{get:function(){Ge=!0}});window.addEventListener("test",null,Qa)}catch{}}let Da=0;var an={name:"RecycleScroller",components:{ResizeObserver:Fe},directives:{ObserveVisibility:Ta},props:{...za,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const e={"-1":{accumulator:0}},t=this.items,n=this.sizeField,i=this.minItemSize;let a=1e4,r=0,v;for(let c=0,h=t.length;c<h;c++)v=t[c][n]||i,v<a&&(a=v),r+=v,e[c]={accumulator:r,size:v};return this.$_computedMinItemSize=a,e}return[]},simpleArray:Fa,itemIndexByKey(){const{keyField:e,items:t}=this,n={};for(let i=0,a=t.length;i<a;i++)n[t[i][e]]=i;return n}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const e=this.$_lastUpdateScrollPosition;typeof e=="number"&&this.$nextTick(()=>{this.scrollToPosition(e)})},beforeUnmount(){this.removeListeners()},methods:{addView(e,t,n,i,a){const r=Yn({id:Da++,index:t,used:!0,key:i,type:a}),v=Zn({item:n,position:0,nr:r});return e.push(v),v},unuseView(e,t=!1){const n=this.$_unusedViews,i=e.nr.type;let a=n.get(i);a||(a=[],n.set(i,a)),a.push(e),t||(e.nr.used=!1,e.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(e){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const t=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:n}=this.updateVisibleItems(!1,!0);n||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});t(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&t()},this.updateInterval))}},handleVisibilityChange(e,t){this.ready&&(e||t.boundingClientRect.width!==0||t.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(e,t=!1){const n=this.itemSize,i=this.gridItems||1,a=this.itemSecondarySize||n,r=this.$_computedMinItemSize,v=this.typeField,c=this.simpleArray?null:this.keyField,h=this.items,y=h.length,d=this.sizes,m=this.$_views,S=this.$_unusedViews,p=this.pool,l=this.itemIndexByKey;let s,o,f,A,g;if(!y)s=o=A=g=f=0;else if(this.$_prerender)s=A=0,o=g=Math.min(this.prerender,h.length),f=null;else{const C=this.getScroll();if(t){let F=C.start-this.$_lastUpdateScrollPosition;if(F<0&&(F=-F),n===null&&F<r||F<n)return{continuous:!0}}this.$_lastUpdateScrollPosition=C.start;const Q=this.buffer;C.start-=Q,C.end+=Q;let N=0;if(this.$refs.before&&(N=this.$refs.before.scrollHeight,C.start-=N),this.$refs.after){const F=this.$refs.after.scrollHeight;C.end+=F}if(n===null){let F,O=0,M=y-1,D=~~(y/2),b;do b=D,F=d[D].accumulator,F<C.start?O=D:D<y-1&&d[D+1].accumulator>C.start&&(M=D),D=~~((O+M)/2);while(D!==b);for(D<0&&(D=0),s=D,f=d[y-1].accumulator,o=D;o<y&&d[o].accumulator<C.end;o++);for(o===-1?o=h.length-1:(o++,o>y&&(o=y)),A=s;A<y&&N+d[A].accumulator<C.start;A++);for(g=A;g<y&&N+d[g].accumulator<C.end;g++);}else{s=~~(C.start/n*i);const F=s%i;s-=F,o=Math.ceil(C.end/n*i),A=Math.max(0,Math.floor((C.start-N)/n*i)),g=Math.floor((C.end-N)/n*i),s<0&&(s=0),o>y&&(o=y),A<0&&(A=0),g>y&&(g=y),f=Math.ceil(y/i)*n}}o-s>Ba.itemsLimit&&this.itemsLimitError(),this.totalSize=f;let u;const I=s<=this.$_endIndex&&o>=this.$_startIndex;if(I)for(let C=0,Q=p.length;C<Q;C++)u=p[C],u.nr.used&&(e&&(u.nr.index=l[u.item[c]]),(u.nr.index==null||u.nr.index<s||u.nr.index>=o)&&this.unuseView(u));const k=I?null:new Map;let _,E,T;for(let C=s;C<o;C++){_=h[C];const Q=c?_[c]:_;if(Q==null)throw new Error(`Key is ${Q} on item (keyField is '${c}')`);if(u=m.get(Q),!n&&!d[C].size){u&&this.unuseView(u);continue}E=_[v];let N=S.get(E),F=!1;if(!u)I?N&&N.length?u=N.pop():u=this.addView(p,C,_,Q,E):(T=k.get(E)||0,(!N||T>=N.length)&&(u=this.addView(p,C,_,Q,E),this.unuseView(u,!0),N=S.get(E)),u=N[T],k.set(E,T+1)),m.delete(u.nr.key),u.nr.used=!0,u.nr.index=C,u.nr.key=Q,u.nr.type=E,m.set(Q,u),F=!0;else if(!u.nr.used&&(u.nr.used=!0,u.nr.index=C,F=!0,N)){const O=N.indexOf(u);O!==-1&&N.splice(O,1)}u.item=_,F&&(C===h.length-1&&this.$emit("scroll-end"),C===0&&this.$emit("scroll-start")),n===null?(u.position=d[C-1].accumulator,u.offset=0):(u.position=Math.floor(C/i)*n,u.offset=C%i*a)}return this.$_startIndex=s,this.$_endIndex=o,this.emitUpdate&&this.$emit("update",s,o,A,g),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:I}},getListenerTarget(){let e=xt(this.$el);return window.document&&(e===window.document.documentElement||e===window.document.body)&&(e=window),e},getScroll(){const{$el:e,direction:t}=this,n=t==="vertical";let i;if(this.pageMode){const a=e.getBoundingClientRect(),r=n?a.height:a.width;let v=-(n?a.top:a.left),c=n?window.innerHeight:window.innerWidth;v<0&&(c+=v,v=0),v+c>r&&(c=r-v),i={start:v,end:v+c}}else n?i={start:e.scrollTop,end:e.scrollTop+e.clientHeight}:i={start:e.scrollLeft,end:e.scrollLeft+e.clientWidth};return i},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,Ge?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(e){let t;const n=this.gridItems||1;this.itemSize===null?t=e>0?this.sizes[e-1].accumulator:0:t=Math.floor(e/n)*this.itemSize,this.scrollToPosition(t)},scrollToPosition(e){const t=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let n,i,a;if(this.pageMode){const r=xt(this.$el),v=r.tagName==="HTML"?0:r[t.scroll],c=r.getBoundingClientRect(),y=this.$el.getBoundingClientRect()[t.start]-c[t.start];n=r,i=t.scroll,a=e+v+y}else n=this.$el,i=t.scroll,a=e;n[i]=a},itemsLimitError(){throw setTimeout(()=>{console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",this.$el),console.log("Make sure the scroller has a fixed height (or width) and 'overflow-y' (or 'overflow-x') set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((e,t)=>e.nr.index-t.nr.index)}}};const La={key:0,ref:"before",class:"vue-recycle-scroller__slot"},Ra={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function ja(e,t,n,i,a,r){const v=Xn("ResizeObserver"),c=ei("observe-visibility");return ti((x(),W("div",{class:ye(["vue-recycle-scroller",{ready:a.ready,"page-mode":n.pageMode,[`direction-${e.direction}`]:!0}]),onScrollPassive:t[0]||(t[0]=(...h)=>r.handleScroll&&r.handleScroll(...h))},[e.$slots.before?(x(),W("div",La,[Se(e.$slots,"before")],512)):X("v-if",!0),(x(),J(gt(n.listTag),{ref:"wrapper",style:ai({[e.direction==="vertical"?"minHeight":"minWidth"]:a.totalSize+"px"}),class:ye(["vue-recycle-scroller__item-wrapper",n.listClass])},{default:$(()=>[(x(!0),W(te,null,$e(a.pool,h=>(x(),J(gt(n.itemTag),ni({key:h.nr.id,style:a.ready?{transform:`translate${e.direction==="vertical"?"Y":"X"}(${h.position}px) translate${e.direction==="vertical"?"X":"Y"}(${h.offset}px)`,width:n.gridItems?`${e.direction==="vertical"&&n.itemSecondarySize||n.itemSize}px`:void 0,height:n.gridItems?`${e.direction==="horizontal"&&n.itemSecondarySize||n.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[n.itemClass,{hover:!n.skipHover&&a.hoverKey===h.nr.key}]]},ii(n.skipHover?{}:{mouseenter:()=>{a.hoverKey=h.nr.key},mouseleave:()=>{a.hoverKey=null}})),{default:$(()=>[Se(e.$slots,"default",{item:h.item,index:h.nr.index,active:h.nr.used})]),_:2},1040,["style","class"]))),128)),Se(e.$slots,"empty")]),_:3},8,["style","class"])),e.$slots.after?(x(),W("div",Ra,[Se(e.$slots,"after")],512)):X("v-if",!0),w(v,{onNotify:r.handleResize},null,8,["onNotify"])],34)),[[c,r.handleVisibilityChange]])}an.render=ja;an.__file="src/components/RecycleScroller.vue";const Tt=he({__name:"ContextMenu",props:{file:{},idx:{},selectedTag:{},disableDelete:{type:Boolean}},emits:["contextMenuClick"],setup(e,{emit:t}){const n=e,i=Xe(),a=V(()=>{var r;return(((r=i.conf)==null?void 0:r.all_custom_tags)??[]).reduce((v,c)=>[...v,{...c,selected:!!n.selectedTag.find(h=>h.id===c.id)}],[])});return(r,v)=>{const c=Rt,h=ri,y=li,d=jt;return x(),J(d,{onClick:v[0]||(v[0]=m=>t("contextMenuClick",m,r.file,r.idx))},{default:$(()=>{var m;return[w(c,{key:"deleteFiles",disabled:r.disableDelete},{default:$(()=>[R(j(r.$t("deleteSelected")),1)]),_:1},8,["disabled"]),r.file.type==="dir"?(x(),W(te,{key:0},[w(c,{key:"openInNewTab"},{default:$(()=>[R(j(r.$t("openInNewTab")),1)]),_:1}),w(c,{key:"openOnTheRight"},{default:$(()=>[R(j(r.$t("openOnTheRight")),1)]),_:1}),w(c,{key:"openWithWalkMode"},{default:$(()=>[R(j(r.$t("openWithWalkMode")),1)]),_:1})],64)):X("",!0),r.file.type==="file"?(x(),W(te,{key:1},[K(G)(r.file.name)?(x(),W(te,{key:0},[w(c,{key:"viewGenInfo"},{default:$(()=>[R(j(r.$t("viewGenerationInfo")),1)]),_:1}),w(h),((m=K(i).conf)==null?void 0:m.launch_mode)!=="server"?(x(),W(te,{key:0},[w(c,{key:"send2txt2img"},{default:$(()=>[R(j(r.$t("sendToTxt2img")),1)]),_:1}),w(c,{key:"send2img2img"},{default:$(()=>[R(j(r.$t("sendToImg2img")),1)]),_:1}),w(c,{key:"send2inpaint"},{default:$(()=>[R(j(r.$t("sendToInpaint")),1)]),_:1}),w(c,{key:"send2extras"},{default:$(()=>[R(j(r.$t("sendToExtraFeatures")),1)]),_:1}),w(y,{key:"sendToThirdPartyExtension",title:r.$t("sendToThirdPartyExtension")},{default:$(()=>[w(c,{key:"send2controlnet-txt2img"},{default:$(()=>[R("ControlNet - "+j(r.$t("t2i")),1)]),_:1}),w(c,{key:"send2controlnet-img2img"},{default:$(()=>[R("ControlNet - "+j(r.$t("i2i")),1)]),_:1}),w(c,{key:"send2outpaint"},{default:$(()=>[R("openOutpaint")]),_:1})]),_:1},8,["title"])],64)):X("",!0),w(c,{key:"send2BatchDownload"},{default:$(()=>[R(j(r.$t("sendToBatchDownload")),1)]),_:1}),w(c,{key:"send2savedDir"},{default:$(()=>[R(j(r.$t("send2savedDir")),1)]),_:1}),w(h),w(y,{key:"toggle-tag",title:r.$t("toggleTag")},{default:$(()=>[(x(!0),W(te,null,$e(a.value,S=>(x(),J(c,{key:`toggle-tag-${S.id}`},{default:$(()=>[R(j(S.name)+" ",1),S.selected?(x(),J(K(Ut),{key:0})):(x(),J(K(Wt),{key:1}))]),_:2},1024))),128))]),_:1},8,["title"]),w(c,{key:"openWithLocalFileBrowser"},{default:$(()=>[R(j(r.$t("openWithLocalFileBrowser")),1)]),_:1})],64)):X("",!0),w(c,{key:"previewInNewWindow"},{default:$(()=>[R(j(r.$t("previewInNewWindow")),1)]),_:1}),w(c,{key:"download"},{default:$(()=>[R(j(r.$t("download")),1)]),_:1}),w(c,{key:"copyPreviewUrl"},{default:$(()=>[R(j(r.$t("copySourceFilePreviewLink")),1)]),_:1})],64)):X("",!0)]}),_:1})}}}),Ha=["data-idx"],Va={key:1,class:"more"},Ua={class:"float-btn-wrap"},Ja={key:0,class:"tags-container"},Wa={key:3,class:"preview-icon-wrap"},Ka={key:4,class:"profile"},qa={class:"name line-clamp-1"},Ga={class:"basic-info"},Ya=he({__name:"FileItem",props:{file:{},idx:{},selected:{type:Boolean,default:!1},showMenuIdx:{},cellWidth:{},fullScreenPreviewImageUrl:{},enableRightClickMenu:{type:Boolean,default:!0},enableCloseIcon:{type:Boolean,default:!1}},emits:["update:showMenuIdx","fileItemClick","dragstart","dragend","previewVisibleChange","contextMenuClick","close-icon-click"],setup(e,{emit:t}){const n=e;si(d=>({"33d2717e":d.$props.cellWidth+"px"}));const i=Xe(),a=Yt(),r=V(()=>a.tagMap.get(n.file.fullpath)??[]),v=V(()=>{const d=i.gridThumbnailResolution;return i.enableThumbnail?oi(n.file,[d,d].join("x")):oe(n.file)}),c=V(()=>{var d;return(((d=i.conf)==null?void 0:d.all_custom_tags)??[]).reduce((m,S)=>[...m,{...S,selected:!!r.value.find(p=>p.id===S.id)}],[])}),h=V(()=>c.value.find(d=>d.type==="custom"&&d.name==="like")),y=()=>{Be(h.value),t("contextMenuClick",{key:`toggle-tag-${h.value.id}`},n.file,n.idx)};return(d,m)=>{const S=ve,p=Rt,l=jt,s=ui,o=Ei;return x(),J(S,{trigger:["contextmenu"],visible:K(i).longPressOpenContextMenu?typeof d.idx=="number"&&d.showMenuIdx===d.idx:void 0,"onUpdate:visible":m[7]||(m[7]=f=>typeof d.idx=="number"&&t("update:showMenuIdx",f?d.idx:-1))},{overlay:$(()=>[d.enableRightClickMenu?(x(),J(Tt,{key:0,file:d.file,idx:d.idx,"selected-tag":r.value,onContextMenuClick:m[6]||(m[6]=(f,A,g)=>t("contextMenuClick",f,A,g))},null,8,["file","idx","selected-tag"])):X("",!0)]),default:$(()=>[(x(),W("li",{class:ye(["file file-item-trigger grid",{clickable:d.file.type==="dir",selected:d.selected}]),"data-idx":d.idx,key:d.file.name,draggable:"true",onDragstart:m[3]||(m[3]=f=>t("dragstart",f,d.idx)),onDragend:m[4]||(m[4]=f=>t("dragend",f,d.idx)),onClickCapture:m[5]||(m[5]=f=>t("fileItemClick",f,d.file,d.idx))},[se("div",null,[d.enableCloseIcon?(x(),W("div",{key:0,class:"close-icon",onClick:m[0]||(m[0]=f=>t("close-icon-click"))},[w(K(ci))])):X("",!0),d.enableRightClickMenu?(x(),W("div",Va,[w(S,null,{overlay:$(()=>[w(Tt,{file:d.file,idx:d.idx,"selected-tag":r.value,onContextMenuClick:m[1]||(m[1]=(f,A,g)=>t("contextMenuClick",f,A,g))},null,8,["file","idx","selected-tag"])]),default:$(()=>[se("div",Ua,[w(K(Mt))])]),_:1}),w(S,null,{overlay:$(()=>[c.value.length>1?(x(),J(l,{key:0,onClick:m[2]||(m[2]=f=>t("contextMenuClick",f,d.file,d.idx))},{default:$(()=>[(x(!0),W(te,null,$e(c.value,f=>(x(),J(p,{key:`toggle-tag-${f.id}`},{default:$(()=>[R(j(f.name)+" ",1),f.selected?(x(),J(K(Ut),{key:0})):(x(),J(K(Wt),{key:1}))]),_:2},1024))),128))]),_:1})):X("",!0)]),default:$(()=>{var f,A;return[se("div",{class:ye(["float-btn-wrap",{"like-selected":(f=h.value)==null?void 0:f.selected}]),onClick:y},[(A=h.value)!=null&&A.selected?(x(),J(K(ea),{key:0})):(x(),J(K(aa),{key:1}))],2)]}),_:1})])):X("",!0),K(G)(d.file.name)?(x(),W("div",{style:{position:"relative"},key:d.file.fullpath,class:ye(`idx-${d.idx}`)},[w(s,{src:v.value,fallback:K(Ui),preview:{src:d.fullScreenPreviewImageUrl,onVisibleChange:(f,A)=>t("previewVisibleChange",f,A)}},null,8,["src","fallback","preview"]),r.value&&d.cellWidth>128?(x(),W("div",Ja,[(x(!0),W(te,null,$e(r.value,f=>(x(),J(o,{key:f.id,color:K(a).getColor(f.name)},{default:$(()=>[R(j(f.name),1)]),_:2},1032,["color"]))),128))])):X("",!0)],2)):(x(),W("div",Wa,[d.file.type==="file"?(x(),J(K(Mi),{key:0,class:"icon center"})):(x(),J(K(Fi),{key:1,class:"icon center"}))])),d.cellWidth>128?(x(),W("div",Ka,[se("div",qa,j(d.file.name),1),se("div",Ga,[se("div",null,j(d.file.size),1),se("div",null,j(d.file.date),1)])])):X("",!0)])],42,Ha))]),_:1},8,["visible"])}}});const cr=di(Ya,[["__scopeId","data-v-d9ce3795"]]);export{ve as D,cr as F,Tt as _,ar as a,rr as b,lr as c,sr as d,ir as e,or as f,an as g,Yt as h,Je as i,Ae as j,ha as k,_e as s,ae as u};
