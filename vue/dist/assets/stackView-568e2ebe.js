import{d as te,u as he,g as Y,_ as Oe,c as a,a as ge,P as ce,D as ke,f as Ue,w as ut,b as dt,e as ct,h as Ee,M as _e,i as pt,j as ft,F as be,o as f,k as M,l as u,m as G,t as c,n as Ce,p as L,q as We,r as mt,s as ze,v as je,x as vt,y as gt,z as V,A as s,B as e,C as d,E as Q,G as kt,H as _t,I as Te,J as bt,K as Ct,L as yt,S as ht,N as It,O as wt,Q as St,R as Ve,T as $t,U as At,V as Pt,W as Mt,X as Ft,Y as Rt}from"./index-dfe671d9.js";import{S as Z,s as Bt}from"./index-b01d0430.js";import{F as O,N as xt,_ as Nt,a as Dt}from"./numInput-57895402.js";import"./index-863e91d2.js";import{D as Ge}from"./index-d02cacc4.js";/* empty css              *//* empty css              */import{u as Et,a as zt,b as jt,c as Tt,d as Vt,e as Lt,f as Ot,g as Ut,s as Wt,h as Gt,F as Kt}from"./FileItem-c350046e.js";import{M as qt,L as Qt,R as Ht,f as Jt}from"./MultiSelectKeep-38bb25d7.js";import"./functionalCallableComp-3c443960.js";var Xt=["class","style"],Yt=function(){return{prefixCls:String,href:String,separator:ce.any,overlay:ce.any,onClick:Function}};const ee=te({compatConfig:{MODE:3},name:"ABreadcrumbItem",inheritAttrs:!1,__ANT_BREADCRUMB_ITEM:!0,props:Yt(),slots:["separator","overlay"],setup:function(l,v){var g=v.slots,C=v.attrs,$=he("breadcrumb",l),y=$.prefixCls,F=function(A,m){var i=Y(g,l,"overlay");return i?a(Ge,{overlay:i,placement:"bottom"},{default:function(){return[a("span",{class:"".concat(m,"-overlay-link")},[A,a(ke,null,null)])]}}):A};return function(){var R,A=(R=Y(g,l,"separator"))!==null&&R!==void 0?R:"/",m=Y(g,l),i=C.class,h=C.style,k=Oe(C,Xt),_;return l.href!==void 0?_=a("a",ge({class:"".concat(y.value,"-link"),onClick:l.onClick},k),[m]):_=a("span",ge({class:"".concat(y.value,"-link"),onClick:l.onClick},k),[m]),_=F(_,y.value),m?a("span",{class:i,style:h},[_,A&&a("span",{class:"".concat(y.value,"-separator")},[A])]):null}}});var Zt=function(){return{prefixCls:String,routes:{type:Array},params:ce.any,separator:ce.any,itemRender:{type:Function}}};function en(r,l){if(!r.breadcrumbName)return null;var v=Object.keys(l).join("|"),g=r.breadcrumbName.replace(new RegExp(":(".concat(v,")"),"g"),function(C,$){return l[$]||C});return g}function Le(r){var l=r.route,v=r.params,g=r.routes,C=r.paths,$=g.indexOf(l)===g.length-1,y=en(l,v);return $?a("span",null,[y]):a("a",{href:"#/".concat(C.join("/"))},[y])}const H=te({compatConfig:{MODE:3},name:"ABreadcrumb",props:Zt(),slots:["separator","itemRender"],setup:function(l,v){var g=v.slots,C=he("breadcrumb",l),$=C.prefixCls,y=C.direction,F=function(i,h){return i=(i||"").replace(/^\//,""),Object.keys(h).forEach(function(k){i=i.replace(":".concat(k),h[k])}),i},R=function(i,h,k){var _=pt(i),P=F(h||"",k);return P&&_.push(P),_},A=function(i){var h=i.routes,k=h===void 0?[]:h,_=i.params,P=_===void 0?{}:_,B=i.separator,x=i.itemRender,N=x===void 0?Le:x,D=[];return k.map(function(I){var E=F(I.path,P);E&&D.push(E);var J=[].concat(D),X=null;return I.children&&I.children.length&&(X=a(_e,null,{default:function(){return[I.children.map(function(U){return a(_e.Item,{key:U.path||U.breadcrumbName},{default:function(){return[N({route:U,params:P,routes:k,paths:R(J,U.path,P)})]}})})]}})),a(ee,{overlay:X,separator:B,key:E||I.breadcrumbName},{default:function(){return[N({route:I,params:P,routes:k,paths:J})]}})})};return function(){var m,i,h,k=l.routes,_=l.params,P=_===void 0?{}:_,B=Ue(Y(g,l)),x=(m=Y(g,l,"separator"))!==null&&m!==void 0?m:"/",N=l.itemRender||g.itemRender||Le;k&&k.length>0?h=A({routes:k,params:P,separator:x,itemRender:N}):B.length&&(h=B.map(function(I,E){return ut(dt(I.type)==="object"&&(I.type.__ANT_BREADCRUMB_ITEM||I.type.__ANT_BREADCRUMB_SEPARATOR),"Breadcrumb","Only accepts Breadcrumb.Item and Breadcrumb.Separator as it's children"),ct(I,{separator:x,key:E})}));var D=(i={},Ee(i,$.value,!0),Ee(i,"".concat($.value,"-rtl"),y.value==="rtl"),i);return a("div",{class:D},[h])}}});var tn=["separator","class"],nn=function(){return{prefixCls:String}};const ye=te({compatConfig:{MODE:3},name:"ABreadcrumbSeparator",__ANT_BREADCRUMB_SEPARATOR:!0,inheritAttrs:!1,props:nn(),setup:function(l,v){var g=v.slots,C=v.attrs,$=he("breadcrumb",l),y=$.prefixCls;return function(){var F;C.separator;var R=C.class,A=Oe(C,tn),m=Ue((F=g.default)===null||F===void 0?void 0:F.call(g));return a("span",ge({class:["".concat(y.value,"-separator"),R]},A),[m.length>0?m:"/"])}}});H.Item=ee;H.Separator=ye;H.install=function(r){return r.component(H.name,H),r.component(ee.name,ee),r.component(ye.name,ye),r};O.useInjectFormItemContext=ft;O.ItemRest=be;O.install=function(r){return r.component(O.name,O),r.component(O.Item.name,O.Item),r.component(be.name,be),r};Z.setDefaultIndicator=Bt;Z.install=function(r){return r.component(Z.name,Z),r};const an={class:"base-info"},on=te({__name:"BaseFileListInfo",props:{fileNum:{},selectedFileNum:{}},setup(r){return(l,v)=>(f(),M("div",an,[u("span",null,[G(c(l.$t("items",[l.fileNum]))+" ",1),l.selectedFileNum?(f(),M(Ce,{key:0},[G(", "+c(l.$t("selectedItems",[l.selectedFileNum])),1)],64)):L("",!0)])]))}});const ln=We(on,[["__scopeId","data-v-afd25667"]]),rn={class:"hint"},sn={class:"location-bar"},un=["onClick"],dn={key:3,class:"location-act"},cn={class:"actions"},pn=["onClick"],fn={style:{width:"512px",background:"var(--zp-primary-background)",padding:"16px","border-radius":"4px","box-shadow":"0 0 4px var(--zp-secondary-background)",border:"1px solid var(--zp-secondary-background)"}},mn={style:{padding:"4px"}},vn={style:{padding:"4px"}},gn={style:{padding:"4px"}},kn={key:0,class:"view"},_n={style:{padding:"16px 0 512px"}},bn={key:0,class:"preview-switch"},Cn=te({__name:"stackView",props:{tabIdx:{},paneIdx:{},path:{},walkModePath:{},stackKey:{}},setup(r){const l=r,v=mt(),{scroller:g,stackViewEl:C,props:$,multiSelectedIdxs:y,spinning:F}=Et().toRefs(),{currLocation:R,currPage:A,refresh:m,copyLocation:i,back:h,openNext:k,stack:_,quickMoveTo:P,addToSearchScanPathAndQuickMove:B,searchPathInfo:x,locInputValue:N,isLocationEditing:D,onLocEditEnter:I,onEditBtnClick:E,share:J,selectAll:X,onCreateFloderBtnClick:ne,onWalkBtnClick:U,showWalkButton:Ie,searchInCurrentDir:we}=zt(),{gridItems:Ke,sortMethodConv:qe,moreActionsDropdownShow:pe,sortedFiles:p,sortMethod:fe,itemSize:Se,loadNextDir:Qe,loadNextDirLoading:He,canLoadNext:Je,onScroll:Xe,cellWidth:ae,dirCoverCache:Ye}=jt(),{onDrop:Ze,onFileDragStart:et,onFileDragEnd:tt}=Tt(),{onFileItemClick:nt,onContextMenuClick:$e,showGenInfo:oe,imageGenInfo:Ae,q:Pe}=Vt({openNext:k}),{previewIdx:le,onPreviewVisibleChange:at,previewing:Me,previewImgMove:Fe,canPreview:Re}=Lt(),{showMenuIdx:me}=Ot(),{onClearAllSelected:ot,onReverseSelect:lt,onSelectAll:rt}=Ut();ze(()=>l,()=>{$.value=l;const o=Wt.get(l.stackKey??"");o&&(_.value=o.slice())},{immediate:!0}),ze(p,async(o,t)=>{o.length>0&&o.length!==t.length&&Be()});const re=je(v.defaultChangeIndchecked),ve=je(v.defaultSeedChangeChecked);function Be(){let o=[];const t=[".png",".jpg",".jpeg"];for(let w in p.value)p.value[w].type=="file"&&t.includes(p.value[w].fullpath.slice(-4).toLowerCase())&&o.push(p.value[w].fullpath);Pe.pushAction(()=>vt(o)).res.then(w=>{for(let z in p.value)p.value[z].gen_info_raw=w[p.value[z].fullpath],p.value[z].gen_info_obj=gt(w[p.value[z].fullpath])})}function xe(o,t,w,z){let S={diff:{},empty:!0,ownFile:"",otherFile:""};if(t+w<0||t+w>=p.value.length||p.value[t]==null||!("gen_info_obj"in p.value[t])||!("gen_info_obj"in p.value[t+w]))return S;let W=o,j=p.value[t+w].gen_info_obj;if(j==null)return S;let se=["hashes","resources"];S.diff={},S.ownFile=z.name,S.otherFile=p.value[t+w].name,S.empty=!1,ve.value||se.push("seed");for(let b in W)if(!se.includes(b)){if(!(b in j)){S.diff[b]="+";continue}if(W[b]!=j[b])if(b.includes("rompt")&&W[b]!=""&&j[b]!=""){let K=W[b].split(","),ie=j[b].split(","),q=0;for(let ue in K)K[ue]!=ie[ue]&&q++;S.diff[b]=q}else S.diff[b]=[W[b],j[b]]}return S}return(o,t)=>{const w=$t,z=At,S=Pt,W=Mt,j=ee,se=H,b=Ft,K=Rt,ie=_e,q=Ge,ue=xt,de=Nt,Ne=Dt,st=O,it=Z;return f(),V(it,{spinning:e(F),size:"large"},{default:s(()=>[a(qt,{show:e(v).keepMultiSelect||!!e(y).length,onClearAllSelected:e(ot),onSelectAll:e(rt),onReverseSelect:e(lt)},null,8,["show","onClearAllSelected","onSelectAll","onReverseSelect"]),a(w,{style:{display:"none"}}),u("div",{ref_key:"stackViewEl",ref:C,onDragover:t[30]||(t[30]=d(()=>{},["prevent"])),onDrop:t[31]||(t[31]=d(n=>e(Ze)(n),["prevent"])),class:"container"},[a(S,{visible:e(oe),"onUpdate:visible":t[1]||(t[1]=n=>Q(oe)?oe.value=n:null),width:"70vw","mask-closable":"",onOk:t[2]||(t[2]=n=>oe.value=!1)},{cancelText:s(()=>[]),default:s(()=>[a(z,{active:"",loading:!e(Pe).isIdle},{default:s(()=>[u("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto","z-index":"9999"},onDblclick:t[0]||(t[0]=n=>e(kt)(e(Ae)))},[u("div",rn,c(o.$t("doubleClickToCopy")),1),G(" "+c(e(Ae)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),u("div",sn,[u("div",{class:"breadcrumb",style:_t({flex:e(D)?1:""})},[e(D)?(f(),V(W,{key:0,style:{flex:"1"},value:e(N),"onUpdate:value":t[3]||(t[3]=n=>Q(N)?N.value=n:null),onClick:t[4]||(t[4]=d(()=>{},["stop"])),onKeydown:t[5]||(t[5]=d(()=>{},["stop"])),onPressEnter:e(I),"allow-clear":""},null,8,["value","onPressEnter"])):(f(),V(se,{key:1,style:{flex:"1"}},{default:s(()=>[(f(!0),M(Ce,null,Te(e(_),(n,T)=>(f(),V(j,{key:T},{default:s(()=>[u("a",{onClick:d(De=>e(h)(T),["prevent"])},c(n.curr==="/"?o.$t("root"):n.curr.replace(/:\/$/,o.$t("drive"))),9,un)]),_:2},1024))),128))]),_:1})),e(D)?(f(),V(b,{key:2,size:"small",onClick:e(I),type:"primary"},{default:s(()=>[G(c(o.$t("go")),1)]),_:1},8,["onClick"])):(f(),M("div",dn,[u("a",{onClick:t[6]||(t[6]=d((...n)=>e(i)&&e(i)(...n),["prevent"])),class:"copy"},c(o.$t("copy")),1),u("a",{onClick:t[7]||(t[7]=d((...n)=>e(E)&&e(E)(...n),["prevent","stop"]))},c(o.$t("edit")),1)]))],4),u("div",cn,[u("a",{class:"opt",onClick:t[8]||(t[8]=d((...n)=>e(m)&&e(m)(...n),["prevent"]))},c(o.$t("refresh")),1),a(q,null,{overlay:s(()=>[a(ie,null,{default:s(()=>[a(K,{key:"tag-search"},{default:s(()=>[u("a",{onClick:t[10]||(t[10]=d(n=>e(we)("tag-search"),["prevent"]))},c(o.$t("imgSearch")),1)]),_:1}),a(K,{key:"tag-search"},{default:s(()=>[u("a",{onClick:t[11]||(t[11]=d(n=>e(we)("fuzzy-search"),["prevent"]))},c(o.$t("fuzzy-search")),1)]),_:1})]),_:1})]),default:s(()=>[u("a",{class:"opt",onClick:t[9]||(t[9]=d(()=>{},["prevent"]))},[G(c(o.$t("search"))+" ",1),a(e(ke))])]),_:1}),e(Ie)?(f(),M("a",{key:0,class:"opt",onClick:t[12]||(t[12]=d((...n)=>e(U)&&e(U)(...n),["prevent"]))}," Walk ")):L("",!0),u("a",{class:"opt",onClick:t[13]||(t[13]=d((...n)=>e(X)&&e(X)(...n),["prevent","stop"]))},c(o.$t("selectAll")),1),e(bt)?L("",!0):(f(),M("a",{key:1,class:"opt",onClick:t[14]||(t[14]=d((...n)=>e(J)&&e(J)(...n),["prevent"]))},c(o.$t("share")),1)),a(q,null,{overlay:s(()=>[a(ie,null,{default:s(()=>[(f(!0),M(Ce,null,Te(e(v).quickMovePaths,n=>(f(),V(K,{key:n.dir},{default:s(()=>[u("a",{onClick:d(T=>e(P)(n.dir),["prevent"])},c(n.zh),9,pn)]),_:2},1024))),128))]),_:1})]),default:s(()=>[u("a",{class:"opt",onClick:t[15]||(t[15]=d(()=>{},["prevent"]))},[G(c(o.$t("quickMove"))+" ",1),a(e(ke))])]),_:1}),a(q,{trigger:["click"],visible:e(pe),"onUpdate:visible":t[26]||(t[26]=n=>Q(pe)?pe.value=n:null),placement:"bottomLeft",getPopupContainer:n=>n.parentNode},{overlay:s(()=>[u("div",fn,[a(st,Ct(yt({labelCol:{span:10},wrapperCol:{span:14}})),{default:s(()=>[a(de,{label:o.$t("gridCellWidth")},{default:s(()=>[a(ue,{modelValue:e(ae),"onUpdate:modelValue":t[17]||(t[17]=n=>Q(ae)?ae.value=n:null),max:1024,min:64,step:64},null,8,["modelValue"])]),_:1},8,["label"]),a(de,{label:o.$t("sortingMethod")},{default:s(()=>[a(e(ht),{value:e(fe),"onUpdate:value":t[18]||(t[18]=n=>Q(fe)?fe.value=n:null),onClick:t[19]||(t[19]=d(()=>{},["stop"])),conv:e(qe),options:e(It)},null,8,["value","conv","options"])]),_:1},8,["label"]),a(de,{label:o.$t("showChangeIndicators")},{default:s(()=>[a(Ne,{checked:re.value,"onUpdate:checked":t[20]||(t[20]=n=>re.value=n),onClick:Be},null,8,["checked"])]),_:1},8,["label"]),a(de,{label:o.$t("seedAsChange")},{default:s(()=>[a(Ne,{checked:ve.value,"onUpdate:checked":t[21]||(t[21]=n=>ve.value=n),disabled:!re.value},null,8,["checked","disabled"])]),_:1},8,["label"]),u("div",mn,[e(x)?e(x).can_delete?(f(),M("a",{key:1,onClick:t[23]||(t[23]=d((...n)=>e(B)&&e(B)(...n),["prevent"]))},c(o.$t("removeFromSearchScanPathAndQuickMove")),1)):L("",!0):(f(),M("a",{key:0,onClick:t[22]||(t[22]=d((...n)=>e(B)&&e(B)(...n),["prevent"]))},c(o.$t("addToSearchScanPathAndQuickMove")),1))]),u("div",vn,[u("a",{onClick:t[24]||(t[24]=d(n=>e(wt)(e(R)+"/"),["prevent"]))},c(o.$t("openWithLocalFileBrowser")),1)]),u("div",gn,[u("a",{onClick:t[25]||(t[25]=d((...n)=>e(ne)&&e(ne)(...n),["prevent"]))},c(o.$t("createFolder")),1)])]),_:1},16)])]),default:s(()=>[u("a",{class:"opt",onClick:t[16]||(t[16]=d(()=>{},["prevent"]))},c(o.$t("more")),1)]),_:1},8,["visible","getPopupContainer"])])]),e(A)?(f(),M("div",kn,[a(e(Gt),{class:"file-list",items:e(p),ref_key:"scroller",ref:g,onScroll:e(Xe),"item-size":e(Se).first,"key-field":"fullpath","item-secondary-size":e(Se).second,gridItems:e(Ke)},{default:s(({item:n,index:T})=>[a(Kt,{idx:parseInt(T),file:n,"full-screen-preview-image-url":e(p)[e(le)]?e(St)(e(p)[e(le)]):"","show-menu-idx":e(me),"onUpdate:showMenuIdx":t[27]||(t[27]=De=>Q(me)?me.value=De:null),selected:e(y).includes(T),"cell-width":e(ae),onFileItemClick:e(nt),onDragstart:e(et),onDragend:e(tt),onPreviewVisibleChange:e(at),onContextMenuClick:e($e),"is-selected-mutil-files":e(y).length>1,"gen-diff-to-next":xe(n.gen_info_obj,T,1,n),"gen-diff-to-previous":xe(n.gen_info_obj,T,-1,n),"enable-change-indicator":re.value,"cover-files":e(Ye).get(n.fullpath)},null,8,["idx","file","full-screen-preview-image-url","show-menu-idx","selected","cell-width","onFileItemClick","onDragstart","onDragend","onPreviewVisibleChange","onContextMenuClick","is-selected-mutil-files","gen-diff-to-next","gen-diff-to-previous","enable-change-indicator","cover-files"])]),after:s(()=>[u("div",_n,[l.walkModePath?(f(),V(b,{key:0,onClick:e(Qe),loading:e(He),block:"",type:"primary",disabled:!e(Je),ghost:""},{default:s(()=>[G(c(o.$t("loadNextPage")),1)]),_:1},8,["onClick","loading","disabled"])):L("",!0)])]),_:1},8,["items","onScroll","item-size","item-secondary-size","gridItems"]),e(Me)?(f(),M("div",bn,[a(e(Qt),{onClick:t[28]||(t[28]=n=>e(Fe)("prev")),class:Ve({disable:!e(Re)("prev")})},null,8,["class"]),a(e(Ht),{onClick:t[29]||(t[29]=n=>e(Fe)("next")),class:Ve({disable:!e(Re)("next")})},null,8,["class"])])):L("",!0)])):L("",!0)],544),e(Me)?(f(),V(Jt,{key:0,file:e(p)[e(le)],idx:e(le),onContextMenuClick:e($e)},null,8,["file","idx","onContextMenuClick"])):L("",!0),a(ln,{"file-num":e(p).length,"selected-file-num":e(y).length},null,8,["file-num","selected-file-num"])]),_:1},8,["spinning"])}}});const Rn=We(Cn,[["__scopeId","data-v-b8160253"]]);export{Rn as default};
