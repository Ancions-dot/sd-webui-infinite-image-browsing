import{d as pe,u as We,g as ue,_ as dt,c as u,a as Ne,P as we,D as Be,f as pt,w as Bt,b as Et,e as Tt,h as nt,M as Ee,i as zt,j as jt,F as Te,A as ft,k as Re,l as Vt,r as se,m as ze,n as st,o as Ut,s as De,p as K,q as je,t as Gt,v as Wt,x as Ht,y as be,z,B as qt,C as Kt,E as Ce,G as ot,H as Qt,I as Jt,J as Ve,K as Xt,L as Yt,N as Me,O as Oe,Q as Zt,R as vt,S as ea,T as ta,U as aa,V as D,W as j,X as y,Y as Z,Z as A,$ as Ue,a0 as q,a1 as mt,a2 as na,a3 as W,a4 as C,a5 as e,a6 as S,a7 as H,a8 as sa,a9 as lt,aa as oa,ab as la,ac as ra,ad as ia,ae as ua,af as ca,ag as da,ah as rt,ai as pa,aj as fa,ak as va,al as ma,am as ga}from"./index-58aa78ac.js";import{S as ce,s as ha}from"./index-57d8488e.js";import{F as Q,N as gt,_ as ka}from"./numInput-8d579ebe.js";import"./index-f0ca4af8.js";/* empty css              */import{_ as ba}from"./shortcut-e8cace8d.js";import{D as ht}from"./index-a5a392f6.js";/* empty css              *//* empty css              */import{u as He,N as ya,g as M,s as kt,a as Ca,b as wa,c as _a,d as Ia,F as Sa}from"./FileItem-6f2c42a7.js";import{u as Pa,a as Aa,b as $a,c as Fa,M as xa,L as Ra,R as Da,f as Ma}from"./MultiSelectKeep-1837de31.js";import{g as ye,o as Oa}from"./functionalCallableComp-6dc127fa.js";import"./Checkbox-f03883ba.js";var La=["class","style"],Na=function(){return{prefixCls:String,href:String,separator:we.any,overlay:we.any,onClick:Function}};const de=pe({compatConfig:{MODE:3},name:"ABreadcrumbItem",inheritAttrs:!1,__ANT_BREADCRUMB_ITEM:!0,props:Na(),slots:["separator","overlay"],setup:function(t,l){var o=l.slots,v=l.attrs,p=We("breadcrumb",t),_=p.prefixCls,x=function(i,c){var f=ue(o,t,"overlay");return f?u(ht,{overlay:f,placement:"bottom"},{default:function(){return[u("span",{class:"".concat(c,"-overlay-link")},[i,u(Be,null,null)])]}}):i};return function(){var b,i=(b=ue(o,t,"separator"))!==null&&b!==void 0?b:"/",c=ue(o,t),f=v.class,g=v.style,w=dt(v,La),h;return t.href!==void 0?h=u("a",Ne({class:"".concat(_.value,"-link"),onClick:t.onClick},w),[c]):h=u("span",Ne({class:"".concat(_.value,"-link"),onClick:t.onClick},w),[c]),h=x(h,_.value),c?u("span",{class:f,style:g},[h,i&&u("span",{class:"".concat(_.value,"-separator")},[i])]):null}}});var Ba=function(){return{prefixCls:String,routes:{type:Array},params:we.any,separator:we.any,itemRender:{type:Function}}};function Ea(s,t){if(!s.breadcrumbName)return null;var l=Object.keys(t).join("|"),o=s.breadcrumbName.replace(new RegExp(":(".concat(l,")"),"g"),function(v,p){return t[p]||v});return o}function it(s){var t=s.route,l=s.params,o=s.routes,v=s.paths,p=o.indexOf(t)===o.length-1,_=Ea(t,l);return p?u("span",null,[_]):u("a",{href:"#/".concat(v.join("/"))},[_])}const oe=pe({compatConfig:{MODE:3},name:"ABreadcrumb",props:Ba(),slots:["separator","itemRender"],setup:function(t,l){var o=l.slots,v=We("breadcrumb",t),p=v.prefixCls,_=v.direction,x=function(f,g){return f=(f||"").replace(/^\//,""),Object.keys(g).forEach(function(w){f=f.replace(":".concat(w),g[w])}),f},b=function(f,g,w){var h=zt(f),O=x(g||"",w);return O&&h.push(O),h},i=function(f){var g=f.routes,w=g===void 0?[]:g,h=f.params,O=h===void 0?{}:h,I=f.separator,N=f.itemRender,L=N===void 0?it:N,E=[];return w.map(function(P){var T=x(P.path,O);T&&E.push(T);var J=[].concat(E),X=null;return P.children&&P.children.length&&(X=u(Ee,null,{default:function(){return[P.children.map(function(U){return u(Ee.Item,{key:U.path||U.breadcrumbName},{default:function(){return[L({route:U,params:O,routes:w,paths:b(J,U.path,O)})]}})})]}})),u(de,{overlay:X,separator:I,key:T||P.breadcrumbName},{default:function(){return[L({route:P,params:O,routes:w,paths:J})]}})})};return function(){var c,f,g,w=t.routes,h=t.params,O=h===void 0?{}:h,I=pt(ue(o,t)),N=(c=ue(o,t,"separator"))!==null&&c!==void 0?c:"/",L=t.itemRender||o.itemRender||it;w&&w.length>0?g=i({routes:w,params:O,separator:N,itemRender:L}):I.length&&(g=I.map(function(P,T){return Bt(Et(P.type)==="object"&&(P.type.__ANT_BREADCRUMB_ITEM||P.type.__ANT_BREADCRUMB_SEPARATOR),"Breadcrumb","Only accepts Breadcrumb.Item and Breadcrumb.Separator as it's children"),Tt(P,{separator:N,key:T})}));var E=(f={},nt(f,p.value,!0),nt(f,"".concat(p.value,"-rtl"),_.value==="rtl"),f);return u("div",{class:E},[g])}}});var Ta=["separator","class"],za=function(){return{prefixCls:String}};const Ge=pe({compatConfig:{MODE:3},name:"ABreadcrumbSeparator",__ANT_BREADCRUMB_SEPARATOR:!0,inheritAttrs:!1,props:za(),setup:function(t,l){var o=l.slots,v=l.attrs,p=We("breadcrumb",t),_=p.prefixCls;return function(){var x;v.separator;var b=v.class,i=dt(v,Ta),c=pt((x=o.default)===null||x===void 0?void 0:x.call(o));return u("span",Ne({class:["".concat(_.value,"-separator"),b]},i),[c.length>0?c:"/"])}}});oe.Item=de;oe.Separator=Ge;oe.install=function(s){return s.component(oe.name,oe),s.component(de.name,de),s.component(Ge.name,Ge),s};Q.useInjectFormItemContext=jt;Q.ItemRest=Te;Q.install=function(s){return s.component(Q.name,Q),s.component(Q.Item.name,Q.Item),s.component(Te.name,Te),s};ce.setDefaultIndicator=ha;ce.install=function(s){return s.component(ce.name,ce),s};var ja={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"};const Va=ja;function ut(s){for(var t=1;t<arguments.length;t++){var l=arguments[t]!=null?Object(arguments[t]):{},o=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(o=o.concat(Object.getOwnPropertySymbols(l).filter(function(v){return Object.getOwnPropertyDescriptor(l,v).enumerable}))),o.forEach(function(v){Ua(s,v,l[v])})}return s}function Ua(s,t,l){return t in s?Object.defineProperty(s,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):s[t]=l,s}var qe=function(t,l){var o=ut({},t,l.attrs);return u(ft,ut({},o,{icon:Va}),null)};qe.displayName="ArrowLeftOutlined";qe.inheritAttrs=!1;const Ga=qe;class _e{static run(t){const l=Object.assign({immediately:!0,id:-1,isFinished:!1,errorHandleMethod:"ignore"},t);let o,v;const p=new Promise((i,c)=>{v=i,o=c}),_=()=>{l.isFinished=!0,clearTimeout(l.id)},x=()=>Re(this,void 0,void 0,function*(){try{l.res=yield l.action(),l.validator&&l.validator(l.res)&&(v(l.res),_())}catch(i){_e.silent||console.error(i),l.errorHandleMethod==="stop"&&(_(),o(i))}}),b=()=>{l.isFinished||(l.id=setTimeout(()=>Re(this,void 0,void 0,function*(){yield x(),b()}),l.pollInterval))};return setTimeout(()=>Re(this,void 0,void 0,function*(){l.immediately&&(yield x()),b()}),0),Vt({task:l,clearTask:_,completedTask:p})}}_e.silent=!1;var Wa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-600 72h560v208H232V136zm560 480H232V408h560v208zm0 272H232V680h560v208zM304 240a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"database",theme:"outlined"};const Ha=Wa;function ct(s){for(var t=1;t<arguments.length;t++){var l=arguments[t]!=null?Object(arguments[t]):{},o=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(o=o.concat(Object.getOwnPropertySymbols(l).filter(function(v){return Object.getOwnPropertyDescriptor(l,v).enumerable}))),o.forEach(function(v){qa(s,v,l[v])})}return s}function qa(s,t,l){return t in s?Object.defineProperty(s,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):s[t]=l,s}var Ke=function(t,l){var o=ct({},t,l.attrs);return u(ft,ct({},o,{icon:Ha}),null)};Ke.displayName="DatabaseOutlined";Ke.inheritAttrs=!1;const Ka=Ke;function Qa(){const s=se(),{scroller:t,stackViewEl:l,stack:o,currPage:v,currLocation:p,useEventListen:_,eventEmitter:x,getPane:b,props:i,deletedFiles:c,walker:f,sortedFiles:g}=He().toRefs();ze(()=>o.value.length,st((n,d)=>{var m;n!==d&&((m=t.value)==null||m.scrollToItem(0))},300)),Ut(async()=>{var n;if(!o.value.length)if(i.value.mode==="scanned-fixed"||i.value.mode==="walk")o.value=[{files:[],curr:i.value.path??""}];else{const d=await ye("/");o.value.push({files:d.files,curr:"/"})}s.value=new ya,s.value.configure({parent:l.value}),i.value.path&&i.value.path!=="/"?await L(i.value.path):(n=M.conf)!=null&&n.home&&L(M.conf.home)}),ze(p,st(n=>{const d=b.value();if(!d)return;d.path=n;const m=De(n).pop()??"",F=(()=>{const R={walk:"Walk","scanned-fixed":"Fixed",scanned:null}[i.value.mode??"scanned"],B=ae=>R?`${R}: ${ae}`:ae,V=M.getShortPath(n);return B(V.length>24&&m?m:V)})();d.name=K("div",{style:"display:flex;align-items:center"},[K(Ka),K("span",{class:"line-clamp-1",style:"max-width: 256px"},F)]),d.nameFallbackStr=F,M.recent=M.recent.filter(R=>R.key!==d.key),M.recent.unshift({path:n,key:d.key,mode:i.value.mode}),M.recent.length>20&&(M.recent=M.recent.slice(0,20))},300));const w=()=>Ve(p.value),h=async n=>{var d,m;if(n.type==="dir")try{(d=s.value)==null||d.start();const{files:$}=await ye(n.fullpath);i.value.mode=="scanned-fixed"?o.value=[{files:$,curr:n.fullpath}]:o.value.push({files:$,curr:n.name})}finally{(m=s.value)==null||m.done()}},O=n=>{if(i.value.mode!="walk")for(;n<o.value.length-1;)o.value.pop()},I=()=>{L(Xt(p.value))},N=(n,d)=>(Yt(M.conf,"global.conf load failed"),M.conf.is_win?n.toLowerCase()==d.toLowerCase():n==d),L=async n=>{i.value.mode==="walk"?b.value().path=n:i.value.mode==="scanned-fixed"?await h({fullpath:n,name:n,type:"dir"}):await E(n),je(500).then(()=>x.value.emit("viewableAreaFilesChange"))},E=async n=>{var m,$;const d=o.value.slice();try{Gt(n)||(n=Wt(((m=M.conf)==null?void 0:m.sd_cwd)??"/",n));const F=De(n),R=o.value.map(B=>B.curr);for(R.shift();R[0]&&F[0]&&N(R[0],F[0]);)R.shift(),F.shift();for(let B=0;B<R.length;B++)o.value.pop();if(!F.length)return P();for(const B of F){const V=($=v.value)==null?void 0:$.files.find(ae=>N(ae.name,B));if(!V)throw console.error({frags:F,frag:B,stack:Ht(o.value)}),new Error(`${B} not found`);await h(V)}}catch(F){throw be.error(z("moveFailedCheckPath")+(F instanceof Error?F.message:"")),console.error(n,De(n),v.value),o.value=d,F}},P=qt(async()=>{var n,d,m;try{if((n=s.value)==null||n.start(),f.value)await f.value.reset(),x.value.emit("loadNextDir");else{const{files:$}=await ye(p.value);Me(o.value).files=$}c.value.clear(),(d=t.value)==null||d.scrollToItem(0),be.success(z("refreshCompleted"))}finally{(m=s.value)==null||m.done()}}),T=async()=>{var n,d,m;if(i.value.mode==="walk"&&f.value){const $=((n=t.value)==null?void 0:n.$_endIndex)??64;if($<128&&await f.value.isExpired()){const F=be.loading(z("autoUpdate"),0);try{const R=new Promise(B=>{f.value.seamlessRefresh($).then(V=>{f.value=V,x.value.emit("loadNextDir"),B()})});await Promise.all([R,je(1500)])}finally{F()}}return}try{(d=s.value)==null||d.start();const{files:$}=await ye(p.value);Me(o.value).files.map(R=>R.date).join()!==$.map(R=>R.date).join()&&(Me(o.value).files=$,be.success(z("autoUpdate")))}finally{(m=s.value)==null||m.done()}};Kt("returnToIIB",T),_.value("refresh",P);const J=n=>{L(n)},X=Ce(()=>M.quickMovePaths.map(n=>({...n,path:ot(n.dir)}))),ee=Ce(()=>{const n=ot(p.value);return X.value.find(m=>m.path===n)}),U=async()=>{const n=M.tabList[i.value.tabIdx],d={type:"empty",name:z("emptyStartPage"),key:Date.now()+Oe(),popAddPathModal:{path:p.value,type:"scanned"}};n.panes.push(d),n.key=d.key},G=se(!1),te=se(p.value),Ie=()=>{G.value=!0,te.value=p.value},fe=async()=>{await L(te.value),G.value=!1};Pa("click",n=>{var d,m,$;($=(m=(d=n.target)==null?void 0:d.className)==null?void 0:m.includes)!=null&&$.call(m,"ant-input")||(G.value=!1)});const Se=()=>{const n=parent.location,d=n.href.substring(0,n.href.length-n.search.length),m=new URLSearchParams(n.search);m.set("action","open"),m.set("path",p.value),m.set("mode",i.value.mode??"scanned");const $=`${d}?${m.toString()}`;Ve($,z("copyLocationUrlSuccessMsg"))},Pe=(n="tag-search")=>{const d=M.tabList[i.value.tabIdx],m={type:n,key:Oe(),searchScope:p.value,name:z(n==="tag-search"?"imgSearch":"fuzzy-search")};d.panes.push(m),d.key=m.key},le=()=>x.value.emit("selectAll"),Y=async()=>{await Oa(p.value),await P()},re=()=>{const n=p.value;kt.set(n,o.value);const d=M.tabList[i.value.tabIdx],m={type:"local",key:Oe(),path:n,name:z("local"),stackKey:n,mode:"walk"};d.panes.push(m),d.key=m.key},ve=Ce(()=>!f.value&&g.value.some(n=>n.type==="dir"));return{locInputValue:te,isLocationEditing:G,onLocEditEnter:fe,onEditBtnClick:Ie,addToSearchScanPathAndQuickMove:U,searchPathInfo:ee,refresh:P,copyLocation:w,back:O,openNext:h,currPage:v,currLocation:p,stack:o,scroller:t,share:Se,selectAll:le,quickMoveTo:J,onCreateFloderBtnClick:Y,onWalkBtnClick:re,showWalkButton:ve,searchInCurrentDir:Pe,backToLastUseTo:I,...Ja(T)}}const Ja=s=>{const t=se([]),l=Ce(()=>t.value.length>0);Qt(()=>{t.value.forEach(p=>p())});const o=Jt(Zt+"poll-interval",3);return{onPollRefreshClick:()=>{if(t.value.length){t.value.forEach(p=>p()),t.value=[];return}vt.confirm({title:z("pollRefresh"),width:640,content:()=>K("div",{},[K("p",{class:"uni-desc primary-bg"},z("pollRefreshTip")),K("div",{style:{display:"flex",alignItems:"center",gap:"4px"}},[K("span",{},z("pollInterval")+"(s): "),K(gt,{min:1,max:60*10,modelValue:o.value,"onUpdate:modelValue":p=>{o.value=p}})])]),onOk:()=>{const{clearTask:p}=_e.run({pollInterval:o.value*1e3,action:s});t.value.push(p)}})},polling:l}},Le=new Map,Xa=()=>{const{useEventListen:s,sortedFiles:t,getViewableAreaFiles:l}=He().toRefs(),o=se(M.defaultChangeIndchecked),v=se(M.defaultSeedChangeChecked),p=async()=>{if(await je(100),!o.value)return;const b=l.value().filter(c=>ea(c.fullpath)&&!c.gen_info_obj);if(!b.length)return;const i=await ta(b.map(c=>c.fullpath).filter(c=>!Le.has(c)));b.forEach(c=>{const f=i[c.fullpath]||Le.get(c.fullpath)||"";Le.set(c.fullpath,f),c.gen_info_obj=aa(f),c.gen_info_raw=f})};s.value("viewableAreaFilesChange",p);const _=b=>{const i=t.value;return[b,v.value,i[b-1],i[b],i[b+1]]};function x(b,i,c,f){const g={diff:{},empty:!0,ownFile:"",otherFile:""};if(i+c<0||i+c>=t.value.length||t.value[i]==null||!("gen_info_obj"in t.value[i])||!("gen_info_obj"in t.value[i+c]))return g;const w=b,h=t.value[i+c].gen_info_obj;if(h==null)return g;const O=["hashes","resources"];g.diff={},g.ownFile=f.name,g.otherFile=t.value[i+c].name,g.empty=!1,v.value||O.push("seed");for(const I in w)if(!O.includes(I)){if(!(I in h)){g.diff[I]="+";continue}if(w[I]!=h[I])if(I.includes("rompt")&&w[I]!=""&&h[I]!=""){const N=w[I].split(","),L=h[I].split(",");let E=0;for(const P in N)N[P]!=L[P]&&E++;g.diff[I]=E}else g.diff[I]=[w[I],h[I]]}return g}return{getGenDiff:x,changeIndchecked:o,seedChangeChecked:v,getRawGenParams:()=>p(),getGenDiffWatchDep:_}};const Ya={class:"base-info"},Za=pe({__name:"BaseFileListInfo",props:{fileNum:{},selectedFileNum:{}},setup(s){return(t,l)=>(D(),j("div",Ya,[y("span",null,[Z(A(t.$t("items",[t.fileNum]))+" ",1),t.selectedFileNum?(D(),j(Ue,{key:0},[Z(", "+A(t.$t("selectedItems",[t.selectedFileNum])),1)],64)):q("",!0)])]))}});const en=mt(Za,[["__scopeId","data-v-afd25667"]]),tn={class:"hint"},an={class:"location-bar"},nn=["onClick"],sn={key:3,class:"location-act"},on={class:"actions"},ln=["onClick"],rn={style:{width:"512px",background:"var(--zp-primary-background)",padding:"16px","border-radius":"4px","box-shadow":"0 0 4px var(--zp-secondary-background)",border:"1px solid var(--zp-secondary-background)"}},un={style:{padding:"4px"}},cn={style:{padding:"4px"}},dn={style:{padding:"4px"}},pn={key:0,class:"view"},fn={style:{padding:"16px 0 512px"}},vn={key:0,class:"preview-switch"},mn=pe({__name:"stackView",props:{tabIdx:{},paneIdx:{},path:{},mode:{},stackKey:{}},setup(s){const t=s,l=na(),{scroller:o,stackViewEl:v,props:p,multiSelectedIdxs:_,spinning:x}=He().toRefs(),{currLocation:b,currPage:i,refresh:c,copyLocation:f,back:g,openNext:w,stack:h,quickMoveTo:O,addToSearchScanPathAndQuickMove:I,locInputValue:N,isLocationEditing:L,onLocEditEnter:E,onEditBtnClick:P,share:T,selectAll:J,onCreateFloderBtnClick:X,onWalkBtnClick:ee,showWalkButton:U,searchInCurrentDir:G,backToLastUseTo:te,polling:Ie,onPollRefreshClick:fe}=Qa(),{gridItems:Se,sortMethodConv:Pe,moreActionsDropdownShow:le,sortedFiles:Y,sortMethod:re,itemSize:ve,loadNextDir:n,loadNextDirLoading:d,canLoadNext:m,onScroll:$,cellWidth:F,dirCoverCache:R}=Ca(),{onDrop:B,onFileDragStart:V,onFileDragEnd:ae}=Aa(),{onFileItemClick:bt,onContextMenuClick:Qe,showGenInfo:me,imageGenInfo:Je,q:yt}=$a({openNext:w}),{previewIdx:ge,onPreviewVisibleChange:Ct,previewing:Ae,previewImgMove:Xe,canPreview:Ye}=Fa(),{showMenuIdx:$e}=wa(),{onClearAllSelected:wt,onReverseSelect:_t,onSelectAll:It}=_a(),{getGenDiff:St,changeIndchecked:ie,seedChangeChecked:he,getRawGenParams:Pt,getGenDiffWatchDep:At}=Xa();return ze(()=>t,()=>{p.value=t;const k=kt.get(t.stackKey??"");k&&(h.value=k.slice())},{immediate:!0}),(k,a)=>{const $t=pa,Ft=fa,xt=vt,Rt=va,Dt=de,Mt=oe,Ze=ma,Fe=ga,et=Ee,xe=ht,Ot=gt,ke=ka,tt=ba,Lt=Q,Nt=ce;return D(),W(Nt,{spinning:e(x),size:"large"},{default:C(()=>[u(xa,{show:e(l).keepMultiSelect||!!e(_).length,onClearAllSelected:e(wt),onSelectAll:e(It),onReverseSelect:e(_t)},null,8,["show","onClearAllSelected","onSelectAll","onReverseSelect"]),u($t,{style:{display:"none"}}),y("div",{ref_key:"stackViewEl",ref:v,onDragover:a[31]||(a[31]=S(()=>{},["prevent"])),onDrop:a[32]||(a[32]=S(r=>e(B)(r),["prevent"])),class:"container"},[u(xt,{visible:e(me),"onUpdate:visible":a[1]||(a[1]=r=>H(me)?me.value=r:null),width:"70vw","mask-closable":"",onOk:a[2]||(a[2]=r=>me.value=!1)},{cancelText:C(()=>[]),default:C(()=>[u(Ft,{active:"",loading:!e(yt).isIdle},{default:C(()=>[y("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto","z-index":"9999"},onDblclick:a[0]||(a[0]=r=>e(Ve)(e(Je)))},[y("div",tn,A(k.$t("doubleClickToCopy")),1),Z(" "+A(e(Je)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),y("div",an,[y("div",{class:"breadcrumb",style:sa({flex:e(L)?1:""})},[e(L)?(D(),W(Rt,{key:0,style:{flex:"1"},value:e(N),"onUpdate:value":a[3]||(a[3]=r=>H(N)?N.value=r:null),onClick:a[4]||(a[4]=S(()=>{},["stop"])),onKeydown:a[5]||(a[5]=S(()=>{},["stop"])),onPressEnter:e(E),"allow-clear":""},null,8,["value","onPressEnter"])):(D(),W(Mt,{key:1,style:{flex:"1"}},{default:C(()=>[(D(!0),j(Ue,null,lt(e(h),(r,ne)=>(D(),W(Dt,{key:ne},{default:C(()=>[y("a",{onClick:S(at=>e(g)(ne),["prevent"])},A(r.curr==="/"?k.$t("root"):r.curr.replace(/:\/$/,k.$t("drive"))),9,nn)]),_:2},1024))),128))]),_:1})),e(L)?(D(),W(Ze,{key:2,size:"small",onClick:e(E),type:"primary"},{default:C(()=>[Z(A(k.$t("go")),1)]),_:1},8,["onClick"])):(D(),j("div",sn,[k.mode==="scanned-fixed"?(D(),j("a",{key:0,onClick:a[6]||(a[6]=S((...r)=>e(te)&&e(te)(...r),["prevent"])),style:{margin:"0 8px 16px 0"}},[u(e(Ga))])):q("",!0),y("a",{onClick:a[7]||(a[7]=S((...r)=>e(f)&&e(f)(...r),["prevent"])),class:"copy"},A(k.$t("copy")),1),y("a",{onClick:a[8]||(a[8]=S((...r)=>e(P)&&e(P)(...r),["prevent","stop"]))},A(k.$t("edit")),1)]))],4),y("div",on,[y("a",{class:"opt",onClick:a[9]||(a[9]=S((...r)=>e(c)&&e(c)(...r),["prevent"]))},A(k.$t("refresh")),1),y("a",{class:"opt",onClick:a[10]||(a[10]=S((...r)=>e(fe)&&e(fe)(...r),["prevent"]))},A(e(Ie)?k.$t("stopPollRefresh"):k.$t("pollRefresh")),1),u(xe,null,{overlay:C(()=>[u(et,null,{default:C(()=>[u(Fe,{key:"tag-search"},{default:C(()=>[y("a",{onClick:a[12]||(a[12]=S(r=>e(G)("tag-search"),["prevent"]))},A(k.$t("imgSearch")),1)]),_:1}),u(Fe,{key:"tag-search"},{default:C(()=>[y("a",{onClick:a[13]||(a[13]=S(r=>e(G)("fuzzy-search"),["prevent"]))},A(k.$t("fuzzy-search")),1)]),_:1})]),_:1})]),default:C(()=>[y("a",{class:"opt",onClick:a[11]||(a[11]=S(()=>{},["prevent"]))},[Z(A(k.$t("search"))+" ",1),u(e(Be))])]),_:1}),e(U)?(D(),j("a",{key:0,class:"opt",onClick:a[14]||(a[14]=S((...r)=>e(ee)&&e(ee)(...r),["prevent"]))}," Walk ")):q("",!0),y("a",{class:"opt",onClick:a[15]||(a[15]=S((...r)=>e(J)&&e(J)(...r),["prevent","stop"]))},A(k.$t("selectAll")),1),e(oa)?q("",!0):(D(),j("a",{key:1,class:"opt",onClick:a[16]||(a[16]=S((...r)=>e(T)&&e(T)(...r),["prevent"]))},A(k.$t("share")),1)),u(xe,null,{overlay:C(()=>[u(et,null,{default:C(()=>[(D(!0),j(Ue,null,lt(e(l).quickMovePaths,r=>(D(),W(Fe,{key:r.dir},{default:C(()=>[y("a",{onClick:S(ne=>e(O)(r.dir),["prevent"])},A(r.zh),9,ln)]),_:2},1024))),128))]),_:1})]),default:C(()=>[y("a",{class:"opt",onClick:a[17]||(a[17]=S(()=>{},["prevent"]))},[Z(A(k.$t("quickMove"))+" ",1),u(e(Be))])]),_:1}),u(xe,{trigger:["click"],visible:e(le),"onUpdate:visible":a[27]||(a[27]=r=>H(le)?le.value=r:null),placement:"bottomLeft",getPopupContainer:r=>r.parentNode},{overlay:C(()=>[y("div",rn,[u(Lt,la(ra({labelCol:{span:10},wrapperCol:{span:14}})),{default:C(()=>[u(ke,{label:k.$t("gridCellWidth")},{default:C(()=>[u(Ot,{modelValue:e(F),"onUpdate:modelValue":a[19]||(a[19]=r=>H(F)?F.value=r:null),max:1024,min:64,step:16},null,8,["modelValue"])]),_:1},8,["label"]),u(ke,{label:k.$t("sortingMethod")},{default:C(()=>[u(e(ia),{value:e(re),"onUpdate:value":a[20]||(a[20]=r=>H(re)?re.value=r:null),onClick:a[21]||(a[21]=S(()=>{},["stop"])),conv:e(Pe),options:e(ua)},null,8,["value","conv","options"])]),_:1},8,["label"]),u(ke,{label:k.$t("showChangeIndicators")},{default:C(()=>[u(tt,{checked:e(ie),"onUpdate:checked":a[22]||(a[22]=r=>H(ie)?ie.value=r:null),onClick:e(Pt)},null,8,["checked","onClick"])]),_:1},8,["label"]),u(ke,{label:k.$t("seedAsChange")},{default:C(()=>[u(tt,{checked:e(he),"onUpdate:checked":a[23]||(a[23]=r=>H(he)?he.value=r:null),disabled:!e(ie)},null,8,["checked","disabled"])]),_:1},8,["label"]),y("div",un,[y("a",{onClick:a[24]||(a[24]=S((...r)=>e(I)&&e(I)(...r),["prevent"]))},A(k.$t("addToSearchScanPathAndQuickMove")),1)]),y("div",cn,[y("a",{onClick:a[25]||(a[25]=S(r=>e(ca)(e(b)+"/"),["prevent"]))},A(k.$t("openWithLocalFileBrowser")),1)]),y("div",dn,[y("a",{onClick:a[26]||(a[26]=S((...r)=>e(X)&&e(X)(...r),["prevent"]))},A(k.$t("createFolder")),1)])]),_:1},16)])]),default:C(()=>[y("a",{class:"opt",onClick:a[18]||(a[18]=S(()=>{},["prevent"]))},A(k.$t("more")),1)]),_:1},8,["visible","getPopupContainer"])])]),e(i)?(D(),j("div",pn,[u(e(Ia),{class:"file-list",items:e(Y),ref_key:"scroller",ref:o,onScroll:e($),"item-size":e(ve).first,"key-field":"fullpath","item-secondary-size":e(ve).second,gridItems:e(Se)},{default:C(({item:r,index:ne})=>[u(Sa,{idx:parseInt(ne),file:r,"full-screen-preview-image-url":e(Y)[e(ge)]?e(da)(e(Y)[e(ge)]):"","show-menu-idx":e($e),"onUpdate:showMenuIdx":a[28]||(a[28]=at=>H($e)?$e.value=at:null),selected:e(_).includes(ne),"cell-width":e(F),onFileItemClick:e(bt),onDragstart:e(V),onDragend:e(ae),onPreviewVisibleChange:e(Ct),onContextMenuClick:e(Qe),"is-selected-mutil-files":e(_).length>1,"enable-change-indicator":e(ie),"seed-change-checked":e(he),"get-gen-diff":e(St),"get-gen-diff-watch-dep":e(At),previewing:e(Ae),"cover-files":e(R).get(r.fullpath)},null,8,["idx","file","full-screen-preview-image-url","show-menu-idx","selected","cell-width","onFileItemClick","onDragstart","onDragend","onPreviewVisibleChange","onContextMenuClick","is-selected-mutil-files","enable-change-indicator","seed-change-checked","get-gen-diff","get-gen-diff-watch-dep","previewing","cover-files"])]),after:C(()=>[y("div",fn,[t.mode==="walk"?(D(),W(Ze,{key:0,onClick:e(n),loading:e(d),block:"",type:"primary",disabled:!e(m),ghost:""},{default:C(()=>[Z(A(k.$t("loadNextPage")),1)]),_:1},8,["onClick","loading","disabled"])):q("",!0)])]),_:1},8,["items","onScroll","item-size","item-secondary-size","gridItems"]),e(Ae)?(D(),j("div",vn,[u(e(Ra),{onClick:a[29]||(a[29]=r=>e(Xe)("prev")),class:rt({disable:!e(Ye)("prev")})},null,8,["class"]),u(e(Da),{onClick:a[30]||(a[30]=r=>e(Xe)("next")),class:rt({disable:!e(Ye)("next")})},null,8,["class"])])):q("",!0)])):q("",!0)],544),e(Ae)?(D(),W(Ma,{key:0,file:e(Y)[e(ge)],idx:e(ge),onContextMenuClick:e(Qe)},null,8,["file","idx","onContextMenuClick"])):q("",!0),u(en,{"file-num":e(Y).length,"selected-file-num":e(_).length},null,8,["file-num","selected-file-num"])]),_:1},8,["spinning"])}}});const Fn=mt(mn,[["__scopeId","data-v-bd9da014"]]);export{Fn as default};
