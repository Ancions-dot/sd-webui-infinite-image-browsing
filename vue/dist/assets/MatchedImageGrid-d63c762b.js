import{d as j,s as H,a4 as J,o as r,k as g,c as n,A as a,C as e,E as V,l as c,G as K,t as m,m as $,z,Q as X,p as f,R as D,U as Z,V as ee,Y as te,bC as se,q as ie}from"./index-538b0789.js";import{L as le,R as ne,f as ae,S as oe}from"./fullScreenContextMenu-b51f1092.js";import{g as re,F as de}from"./FileItem-dd54980e.js";import{c as ce,u as me}from"./hook-c835f47a.js";import{o as ue}from"./functionalCallableComp-7f541e28.js";import"./index-0482b84f.js";import"./index-9bb1316a.js";const pe={class:"hint"},ge={key:1},fe={class:"no-res-hint"},ve={class:"hint"},Ie={key:2,class:"preview-switch"},ke=j({__name:"MatchedImageGrid",props:{tabIdx:{},paneIdx:{},selectedTagIds:{},id:{}},setup(F){const v=F,u=ce(s=>se(v.selectedTagIds,s)),{queue:B,images:l,onContextMenuClickU:I,stackViewEl:R,previewIdx:o,previewing:k,onPreviewVisibleChange:G,previewImgMove:w,canPreview:C,itemSize:_,gridItems:A,showGenInfo:d,imageGenInfo:h,q:E,multiSelectedIdxs:x,onFileItemClick:N,scroller:y,showMenuIdx:p,onFileDragStart:U,onFileDragEnd:P,cellWidth:q,onScroll:b}=me(u);return H(()=>v.selectedTagIds,async()=>{var s;await u.reset(),await J(),(s=y.value)==null||s.scrollToItem(0),b()},{immediate:!0}),(s,t)=>{const O=Z,L=ee,Q=te,W=oe;return r(),g("div",{class:"container",ref_key:"stackViewEl",ref:R},[n(W,{size:"large",spinning:!e(B).isIdle},{default:a(()=>{var M,S;return[n(L,{visible:e(d),"onUpdate:visible":t[1]||(t[1]=i=>V(d)?d.value=i:null),width:"70vw","mask-closable":"",onOk:t[2]||(t[2]=i=>d.value=!1)},{cancelText:a(()=>[]),default:a(()=>[n(O,{active:"",loading:!e(E).isIdle},{default:a(()=>[c("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto"},onDblclick:t[0]||(t[0]=i=>e(K)(e(h)))},[c("div",pe,m(s.$t("doubleClickToCopy")),1),$(" "+m(e(h)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),(M=e(l))!=null&&M.length?(r(),z(e(re),{key:0,ref_key:"scroller",ref:y,class:"file-list",items:e(l),"item-size":e(_).first,"key-field":"fullpath","item-secondary-size":e(_).second,gridItems:e(A),onScroll:e(b)},{default:a(({item:i,index:T})=>[n(de,{idx:T,file:i,"cell-width":e(q),"show-menu-idx":e(p),"onUpdate:showMenuIdx":t[3]||(t[3]=Y=>V(p)?p.value=Y:null),onDragstart:e(U),onDragend:e(P),onFileItemClick:e(N),"full-screen-preview-image-url":e(l)[e(o)]?e(X)(e(l)[e(o)]):"",selected:e(x).includes(T),onContextMenuClick:e(I),onPreviewVisibleChange:e(G),"is-selected-mutil-files":e(x).length>1},null,8,["idx","file","cell-width","show-menu-idx","onDragstart","onDragend","onFileItemClick","full-screen-preview-image-url","selected","onContextMenuClick","onPreviewVisibleChange","is-selected-mutil-files"])]),_:1},8,["items","item-size","item-secondary-size","gridItems","onScroll"])):e(u).load&&s.selectedTagIds.and_tags.length===1&&!((S=s.selectedTagIds.folder_paths_str)!=null&&S.trim())?(r(),g("div",ge,[c("div",fe,[c("p",ve,m(s.$t("tagSearchNoResultsMessage")),1),n(Q,{onClick:t[4]||(t[4]=i=>e(ue)()),type:"primary"},{default:a(()=>[$(m(s.$t("rebuildImageIndex")),1)]),_:1})])])):f("",!0),e(k)?(r(),g("div",Ie,[n(e(le),{onClick:t[5]||(t[5]=i=>e(w)("prev")),class:D({disable:!e(C)("prev")})},null,8,["class"]),n(e(ne),{onClick:t[6]||(t[6]=i=>e(w)("next")),class:D({disable:!e(C)("next")})},null,8,["class"])])):f("",!0)]}),_:1},8,["spinning"]),e(k)&&e(l)&&e(l)[e(o)]?(r(),z(ae,{key:0,file:e(l)[e(o)],idx:e(o),onContextMenuClick:e(I)},null,8,["file","idx","onContextMenuClick"])):f("",!0)],512)}}});const Me=ie(ke,[["__scopeId","data-v-5e56145a"]]);export{Me as default};
