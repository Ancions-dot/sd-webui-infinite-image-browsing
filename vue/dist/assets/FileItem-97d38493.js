var Yt=Object.defineProperty;var Zt=(e,t,n)=>t in e?Yt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Be=(e,t,n)=>(Zt(e,typeof t!="symbol"?t+"":t,n),n);import{P as Ee,c3 as Xt,a as Z,d as de,bq as _t,u as xe,c as b,bZ as Pt,_ as en,V as le,a0 as pe,aj as j,bL as rt,a3 as st,bo as tn,h as ee,c4 as nn,b as an,ay as rn,c5 as sn,a2 as lt,bK as ln,c6 as on,c7 as cn,$ as F,b0 as un,z as X,aA as dn,a1 as fn,ag as me,c8 as vn,aR as pn,c9 as hn,ca as mn,aM as Ot,am as De,bn as We,cb as gn,cc as yn,c2 as ge,cd as bn,ce as wn,R as se,ai as $,U as An,cf as Ke,x as L,cg as xt,ch as ot,ci as Sn,cj as kn,ck as Tt,cl as J,k as qe,ah as Cn,cm as Bt,ar as G,cn as Ge,l as ue,aC as _e,aw as In,ap as Me,co as En,cp as ct,an as Mt,bQ as ut,bP as _n,cq as Se,cr as Pn,aD as On,bO as Nt,cs as xn,ct as Tn,t as Le,as as dt,cu as ft,c1 as Bn,L as ne,J as Mn,bX as vt,al as ye,cv as Nn,bW as zn,cw as Qn,cx as $n,cy as Fn,at as Dn,au as Ln,ax as zt,o as z,m as W,cz as Rn,cA as jn,cB as Vn,cC as Hn,cD as Un,a5 as Jn,y as V,cE as be,E as Y,n as N,A as Ye,cF as pt,bG as Wn,cG as Kn,B as qn,N as Pe,v as D,r as q,W as Gn,cH as Yn,b_ as Zn,M as Xn,cI as ei,cJ as ti,p as re,ae as ni,cK as ii,X as ai}from"./index-ad5d60cc.js";import{f as ri,h as si,a as li,t as oi}from"./db-9b9a70a4.js";import{t as Ne,l as oe,g as ci}from"./shortcut-42585f2b.js";var Qt=function(){return{arrow:{type:[Boolean,Object],default:void 0},trigger:{type:[Array,String]},overlay:Ee.any,visible:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},align:{type:Object},getPopupContainer:Function,prefixCls:String,transitionName:String,placement:String,overlayClassName:String,overlayStyle:{type:Object,default:void 0},forceRender:{type:Boolean,default:void 0},mouseEnterDelay:Number,mouseLeaveDelay:Number,openClassName:String,minOverlayWidthMatchTrigger:{type:Boolean,default:void 0},destroyPopupOnHide:{type:Boolean,default:void 0},onVisibleChange:{type:Function},"onUpdate:visible":{type:Function}}},ze=Xt(),ui=function(){return Z(Z({},Qt()),{},{type:ze.type,size:String,htmlType:ze.htmlType,href:String,disabled:{type:Boolean,default:void 0},prefixCls:String,icon:Ee.any,title:String,loading:ze.loading,onClick:{type:Function}})},di=["type","disabled","loading","htmlType","class","overlay","trigger","align","visible","onVisibleChange","placement","href","title","icon","mouseEnterDelay","mouseLeaveDelay","overlayClassName","overlayStyle","destroyPopupOnHide","onClick","onUpdate:visible"],fi=le.Group;const Oe=de({compatConfig:{MODE:3},name:"ADropdownButton",inheritAttrs:!1,__ANT_BUTTON:!0,props:_t(ui(),{trigger:"hover",placement:"bottomRight",type:"default"}),slots:["icon","leftButton","rightButton","overlay"],setup:function(t,n){var i=n.slots,a=n.attrs,s=n.emit,f=function(m){s("update:visible",m),s("visibleChange",m)},l=xe("dropdown-button",t),d=l.prefixCls,h=l.direction,E=l.getPopupContainer;return function(){var w,m,v=Z(Z({},t),a),r=v.type,o=r===void 0?"default":r,c=v.disabled,y=v.loading,S=v.htmlType,g=v.class,u=g===void 0?"":g,k=v.overlay,A=k===void 0?(w=i.overlay)===null||w===void 0?void 0:w.call(i):k,_=v.trigger,P=v.align,T=v.visible;v.onVisibleChange;var I=v.placement,Q=I===void 0?h.value==="rtl"?"bottomLeft":"bottomRight":I,B=v.href,C=v.title,p=v.icon,O=p===void 0?((m=i.icon)===null||m===void 0?void 0:m.call(i))||b(Pt,null,null):p,x=v.mouseEnterDelay,H=v.mouseLeaveDelay,R=v.overlayClassName,K=v.overlayStyle,U=v.destroyPopupOnHide,ie=v.onClick;v["onUpdate:visible"];var ae=en(v,di),qt={align:P,disabled:c,trigger:c?[]:_,placement:Q,getPopupContainer:E.value,onVisibleChange:f,mouseEnterDelay:x,mouseLeaveDelay:H,visible:T,overlayClassName:R,overlayStyle:K,destroyPopupOnHide:U},it=b(le,{type:o,disabled:c,loading:y,onClick:ie,htmlType:S,href:B,title:C},{default:i.default}),at=b(le,{type:o,icon:O},null);return b(fi,Z(Z({},ae),{},{class:pe(d.value,u)}),{default:function(){return[i.leftButton?i.leftButton({button:it}):it,b(ce,qt,{default:function(){return[i.rightButton?i.rightButton({button:at}):at]},overlay:function(){return A}})]}})}}});var $t=de({compatConfig:{MODE:3},name:"ADropdown",inheritAttrs:!1,props:_t(Qt(),{mouseEnterDelay:.15,mouseLeaveDelay:.1,placement:"bottomLeft",trigger:"hover"}),slots:["overlay"],setup:function(t,n){var i=n.slots,a=n.attrs,s=n.emit,f=xe("dropdown",t),l=f.prefixCls,d=f.rootPrefixCls,h=f.direction,E=f.getPopupContainer,w=j(function(){var o=t.placement,c=o===void 0?"":o,y=t.transitionName;return y!==void 0?y:c.indexOf("top")>=0?"".concat(d.value,"-slide-down"):"".concat(d.value,"-slide-up")}),m=function(){var c,y,S,g=t.overlay||((c=i.overlay)===null||c===void 0?void 0:c.call(i)),u=Array.isArray(g)?g[0]:g;if(!u)return null;var k=u.props||{};rt(!k.mode||k.mode==="vertical","Dropdown",'mode="'.concat(k.mode,`" is not supported for Dropdown's Menu.`));var A=k.selectable,_=A===void 0?!1:A,P=k.expandIcon,T=P===void 0?(y=u.children)===null||y===void 0||(S=y.expandIcon)===null||S===void 0?void 0:S.call(y):P,I=typeof T<"u"&&lt(T)?T:b("span",{class:"".concat(l.value,"-menu-submenu-arrow")},[b(ln,{class:"".concat(l.value,"-menu-submenu-arrow-icon")},null)]),Q=lt(u)?st(u,{mode:"vertical",selectable:_,expandIcon:function(){return I}}):u;return Q},v=j(function(){var o=t.placement;if(!o)return h.value==="rtl"?"bottomRight":"bottomLeft";if(o.includes("Center")){var c=o.slice(0,o.indexOf("Center"));return rt(!o.includes("Center"),"Dropdown","You are using '".concat(o,"' placement in Dropdown, which is deprecated. Try to use '").concat(c,"' instead.")),c}return o}),r=function(c){s("update:visible",c),s("visibleChange",c)};return function(){var o,c,y=t.arrow,S=t.trigger,g=t.disabled,u=t.overlayClassName,k=(o=i.default)===null||o===void 0?void 0:o.call(i)[0],A=st(k,tn({class:pe(k==null||(c=k.props)===null||c===void 0?void 0:c.class,ee({},"".concat(l.value,"-rtl"),h.value==="rtl"),"".concat(l.value,"-trigger"))},g?{disabled:g}:{})),_=pe(u,ee({},"".concat(l.value,"-rtl"),h.value==="rtl")),P=g?[]:S,T;P&&P.indexOf("contextmenu")!==-1&&(T=!0);var I=nn({arrowPointAtCenter:an(y)==="object"&&y.pointAtCenter,autoAdjustOverflow:!0}),Q=rn(Z(Z(Z({},t),a),{},{builtinPlacements:I,overlayClassName:_,arrow:y,alignPoint:T,prefixCls:l.value,getPopupContainer:E.value,transitionName:w.value,trigger:P,onVisibleChange:r,placement:v.value}),["overlay","onUpdate:visible"]);return b(sn,Q,{default:function(){return[A]},overlay:m})}}});$t.Button=Oe;const ce=$t;var vi=function(){return{prefixCls:String,checked:{type:Boolean,default:void 0},onChange:{type:Function},onClick:{type:Function},"onUpdate:checked":Function}},pi=de({compatConfig:{MODE:3},name:"ACheckableTag",props:vi(),setup:function(t,n){var i=n.slots,a=n.emit,s=xe("tag",t),f=s.prefixCls,l=function(E){var w=t.checked;a("update:checked",!w),a("change",!w),a("click",E)},d=j(function(){var h;return pe(f.value,(h={},ee(h,"".concat(f.value,"-checkable"),!0),ee(h,"".concat(f.value,"-checkable-checked"),t.checked),h))});return function(){var h;return b("span",{class:d.value,onClick:l},[(h=i.default)===null||h===void 0?void 0:h.call(i)])}}});const Re=pi;var hi=new RegExp("^(".concat(on.join("|"),")(-inverse)?$")),mi=new RegExp("^(".concat(cn.join("|"),")$")),gi=function(){return{prefixCls:String,color:{type:String},closable:{type:Boolean,default:!1},closeIcon:Ee.any,visible:{type:Boolean,default:void 0},onClose:{type:Function},"onUpdate:visible":Function,icon:Ee.any}},ve=de({compatConfig:{MODE:3},name:"ATag",props:gi(),slots:["closeIcon","icon"],setup:function(t,n){var i=n.slots,a=n.emit,s=n.attrs,f=xe("tag",t),l=f.prefixCls,d=f.direction,h=F(!0);un(function(){t.visible!==void 0&&(h.value=t.visible)});var E=function(r){r.stopPropagation(),a("update:visible",!1),a("close",r),!r.defaultPrevented&&t.visible===void 0&&(h.value=!1)},w=j(function(){var v=t.color;return v?hi.test(v)||mi.test(v):!1}),m=j(function(){var v;return pe(l.value,(v={},ee(v,"".concat(l.value,"-").concat(t.color),w.value),ee(v,"".concat(l.value,"-has-color"),t.color&&!w.value),ee(v,"".concat(l.value,"-hidden"),!h.value),ee(v,"".concat(l.value,"-rtl"),d.value==="rtl"),v))});return function(){var v,r,o,c=t.icon,y=c===void 0?(v=i.icon)===null||v===void 0?void 0:v.call(i):c,S=t.color,g=t.closeIcon,u=g===void 0?(r=i.closeIcon)===null||r===void 0?void 0:r.call(i):g,k=t.closable,A=k===void 0?!1:k,_=function(){return A?u?b("span",{class:"".concat(l.value,"-close-icon"),onClick:E},[u]):b(fn,{class:"".concat(l.value,"-close-icon"),onClick:E},null):null},P={backgroundColor:S&&!w.value?S:void 0},T=y||null,I=(o=i.default)===null||o===void 0?void 0:o.call(i),Q=T?b(X,null,[T,b("span",null,[I])]):I,B="onClick"in s,C=b("span",{class:m.value,style:P},[Q,_()]);return B?b(dn,null,{default:function(){return[C]}}):C}}});ve.CheckableTag=Re;ve.install=function(e){return e.component(ve.name,ve),e.component(Re.name,Re),e};const yi=ve;ce.Button=Oe;ce.install=function(e){return e.component(ce.name,ce),e.component(Oe.name,Oe),e};var bi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z"}}]},name:"star",theme:"filled"};const wi=bi;function ht(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){Ai(e,a,n[a])})}return e}function Ai(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ze=function(t,n){var i=ht({},t,n.attrs);return b(me,ht({},i,{icon:wi}),null)};Ze.displayName="StarFilled";Ze.inheritAttrs=!1;const Si=Ze;var ki={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file",theme:"outlined"};const Ci=ki;function mt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){Ii(e,a,n[a])})}return e}function Ii(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xe=function(t,n){var i=mt({},t,n.attrs);return b(me,mt({},i,{icon:Ci}),null)};Xe.displayName="FileOutlined";Xe.inheritAttrs=!1;const Ei=Xe;var _i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 444H820V330.4c0-17.7-14.3-32-32-32H473L355.7 186.2a8.15 8.15 0 00-5.5-2.2H96c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h698c13 0 24.8-7.9 29.7-20l134-332c1.5-3.8 2.3-7.9 2.3-12 0-17.7-14.3-32-32-32zM136 256h188.5l119.6 114.4H748V444H238c-13 0-24.8 7.9-29.7 20L136 643.2V256zm635.3 512H159l103.3-256h612.4L771.3 768z"}}]},name:"folder-open",theme:"outlined"};const Pi=_i;function gt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){Oi(e,a,n[a])})}return e}function Oi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var et=function(t,n){var i=gt({},t,n.attrs);return b(me,gt({},i,{icon:Pi}),null)};et.displayName="FolderOpenOutlined";et.inheritAttrs=!1;const xi=et;function Ti(e,t,n){if(!vn(n))return!1;var i=typeof t;return(i=="number"?pn(n)&&hn(t,n.length):i=="string"&&t in n)?mn(n[t],e):!1}function Bi(e){return e&&e.length?e[0]:void 0}var Mi=Math.ceil,Ni=Math.max;function zi(e,t,n,i){for(var a=-1,s=Ni(Mi((t-e)/(n||1)),0),f=Array(s);s--;)f[i?s:++a]=e,e+=n;return f}function Qi(e){return function(t,n,i){return i&&typeof i!="number"&&Ti(t,n,i)&&(n=i=void 0),t=Ne(t),n===void 0?(n=t,t=0):n=Ne(n),i=i===void 0?t<n?1:-1:Ne(i),zi(t,n,i,e)}}var $i=Qi();const Ft=$i,he=(...e)=>{document.addEventListener(...e),Ot(()=>document.removeEventListener(...e))},Fi="data:image/png;base64,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",we=new WeakMap;function Di(e,t){return{useHookShareState:i=>{const a=yn();De(a),we.has(a)||(we.set(a,We(e(a,i??(t==null?void 0:t())))),Ot(()=>{we.delete(a)}));const s=we.get(a);return De(s),{state:s,toRefs(){return gn(s)}}}}}var Li={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-600 72h560v208H232V136zm560 480H232V408h560v208zm0 272H232V680h560v208zM304 240a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"database",theme:"outlined"};const Ri=Li;function yt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){ji(e,a,n[a])})}return e}function ji(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tt=function(t,n){var i=yt({},t,n.attrs);return b(me,yt({},i,{icon:Ri}),null)};tt.displayName="DatabaseOutlined";tt.inheritAttrs=!1;const Vi=tt;var Hi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3zM664.8 561.6l36.1 210.3L512 672.7 323.1 772l36.1-210.3-152.8-149L417.6 382 512 190.7 606.4 382l211.2 30.7-152.8 148.9z"}}]},name:"star",theme:"outlined"};const Ui=Hi;function bt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),i.forEach(function(a){Ji(e,a,n[a])})}return e}function Ji(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nt=function(t,n){var i=bt({},t,n.attrs);return b(me,bt({},i,{icon:Ui}),null)};nt.displayName="StarOutlined";nt.inheritAttrs=!1;const Wi=nt;const fe=async e=>(await ge.value.get("/files",{params:{folder_path:e}})).data,Ki=async e=>(await ge.value.post("/delete_files",{file_paths:e})).data,Dt=async(e,t,n)=>(await ge.value.post("/move_files",{file_paths:e,dest:t,create_dest_folder:n})).data,qi=async(e,t,n)=>(await ge.value.post("/copy_files",{file_paths:e,dest:t,create_dest_folder:n})).data,Gi=async e=>{await ge.value.post("/mkdirs",{dest_folder:e})};var Lt={exports:{}};/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */(function(e,t){(function(n,i){e.exports=i})(bn,function(){var n={};n.version="0.3.5";var i=n.settings={minimum:.08,easing:"linear",positionUsing:"",speed:200,trickle:!0,trickleSpeed:200,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};n.configure=function(r){var o,c;for(o in r)c=r[o],c!==void 0&&r.hasOwnProperty(o)&&(i[o]=c);return this},n.status=null,n.set=function(r){var o=n.isStarted();r=a(r,i.minimum,1),n.status=r===1?null:r;var c=n.render(!o),y=c.querySelector(i.barSelector),S=i.speed,g=i.easing;return c.offsetWidth,l(function(u){i.positionUsing===""&&(i.positionUsing=n.getPositioningCSS()),d(y,f(r,S,g)),r===1?(d(c,{transition:"none",opacity:1}),c.offsetWidth,setTimeout(function(){d(c,{transition:"all "+S+"ms linear",opacity:0}),setTimeout(function(){n.remove(),u()},S)},S)):setTimeout(u,S)}),this},n.isStarted=function(){return typeof n.status=="number"},n.start=function(){n.status||n.set(0);var r=function(){setTimeout(function(){n.status&&(n.trickle(),r())},i.trickleSpeed)};return i.trickle&&r(),this},n.done=function(r){return!r&&!n.status?this:n.inc(.3+.5*Math.random()).set(1)},n.inc=function(r){var o=n.status;return o?o>1?void 0:(typeof r!="number"&&(o>=0&&o<.2?r=.1:o>=.2&&o<.5?r=.04:o>=.5&&o<.8?r=.02:o>=.8&&o<.99?r=.005:r=0),o=a(o+r,0,.994),n.set(o)):n.start()},n.trickle=function(){return n.inc()},function(){var r=0,o=0;n.promise=function(c){return!c||c.state()==="resolved"?this:(o===0&&n.start(),r++,o++,c.always(function(){o--,o===0?(r=0,n.done()):n.set((r-o)/r)}),this)}}(),n.getElement=function(){var r=n.getParent();if(r){var o=Array.prototype.slice.call(r.querySelectorAll(".nprogress")).filter(function(c){return c.parentElement===r});if(o.length>0)return o[0]}return null},n.getParent=function(){if(i.parent instanceof HTMLElement)return i.parent;if(typeof i.parent=="string")return document.querySelector(i.parent)},n.render=function(r){if(n.isRendered())return n.getElement();E(document.documentElement,"nprogress-busy");var o=document.createElement("div");o.id="nprogress",o.className="nprogress",o.innerHTML=i.template;var c=o.querySelector(i.barSelector),y=r?"-100":s(n.status||0),S=n.getParent(),g;return d(c,{transition:"all 0 linear",transform:"translate3d("+y+"%,0,0)"}),i.showSpinner||(g=o.querySelector(i.spinnerSelector),g&&v(g)),S!=document.body&&E(S,"nprogress-custom-parent"),S.appendChild(o),o},n.remove=function(){n.status=null,w(document.documentElement,"nprogress-busy"),w(n.getParent(),"nprogress-custom-parent");var r=n.getElement();r&&v(r)},n.isRendered=function(){return!!n.getElement()},n.getPositioningCSS=function(){var r=document.body.style,o="WebkitTransform"in r?"Webkit":"MozTransform"in r?"Moz":"msTransform"in r?"ms":"OTransform"in r?"O":"";return o+"Perspective"in r?"translate3d":o+"Transform"in r?"translate":"margin"};function a(r,o,c){return r<o?o:r>c?c:r}function s(r){return(-1+r)*100}function f(r,o,c){var y;return i.positionUsing==="translate3d"?y={transform:"translate3d("+s(r)+"%,0,0)"}:i.positionUsing==="translate"?y={transform:"translate("+s(r)+"%,0)"}:y={"margin-left":s(r)+"%"},y.transition="all "+o+"ms "+c,y}var l=function(){var r=[];function o(){var c=r.shift();c&&c(o)}return function(c){r.push(c),r.length==1&&o()}}(),d=function(){var r=["Webkit","O","Moz","ms"],o={};function c(u){return u.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(k,A){return A.toUpperCase()})}function y(u){var k=document.body.style;if(u in k)return u;for(var A=r.length,_=u.charAt(0).toUpperCase()+u.slice(1),P;A--;)if(P=r[A]+_,P in k)return P;return u}function S(u){return u=c(u),o[u]||(o[u]=y(u))}function g(u,k,A){k=S(k),u.style[k]=A}return function(u,k){var A=arguments,_,P;if(A.length==2)for(_ in k)P=k[_],P!==void 0&&k.hasOwnProperty(_)&&g(u,_,P);else g(u,A[1],A[2])}}();function h(r,o){var c=typeof r=="string"?r:m(r);return c.indexOf(" "+o+" ")>=0}function E(r,o){var c=m(r),y=c+o;h(c,o)||(r.className=y.substring(1))}function w(r,o){var c=m(r),y;h(r,o)&&(y=c.replace(" "+o+" "," "),r.className=y.substring(1,y.length-1))}function m(r){return(" "+(r&&r.className||"")+" ").replace(/\s+/gi," ")}function v(r){r&&r.parentNode&&r.parentNode.removeChild(r)}return n})})(Lt);var Yi=Lt.exports;const Zi=wn(Yi),Xi=e=>{const t=F("");return new Promise(n=>{se.confirm({title:$("inputFolderName"),content:()=>b(An,{value:t.value,"onUpdate:value":i=>t.value=i},null),async onOk(){if(!t.value)return;const i=Ke(e,t.value);await Gi(i),n()}})})},Rt=()=>b("p",{style:{background:"var(--zp-secondary-background)",padding:"8px",borderLeft:"4px solid var(--primary-color)"}},[L("Tips: "),$("multiSelectTips")]),wt=["blue","cyan","gold","green","lime","magenta","orange","pink","purple","red","yellow","geekblue","volcano"],jt=xt("useTagStore",()=>{const e=We(new Map),t=async s=>{if(s=s.filter(f=>!e.has(f)),!!s.length)try{s.forEach(l=>e.set(l,[]));const f=await ri(s);for(const l in f)e.set(l,f[l])}catch{s.forEach(f=>e.delete(f))}},n=new Map;return{tagMap:e,getColor:s=>{let f=n.get(s);if(!f){const l=ot.hash.sha256.hash(s),d=parseInt(ot.codec.hex.fromBits(l),16)%wt.length;f=wt[d],n.set(s,f)}return f},fetchImageTags:t,refreshTags:async s=>{s.forEach(f=>e.delete(f)),await t(s)}}}),ea=xt("useBatchDownloadStore",()=>{const e=F([]);return{selectdFiles:e,addFiles:n=>{e.value=Sn([...e.value,...n])}}});class At{constructor(t,n=kn.CREATED_TIME_DESC){Be(this,"root");Be(this,"execQueue",[]);this.sortMethod=n,this.root={children:[],info:{name:t,size:"-",bytes:0,created_time:"",is_under_scanned_path:!0,date:"",type:"dir",fullpath:t}},this.fetchChildren(this.root)}reset(){return this.root.children=[],this.fetchChildren(this.root)}get images(){const t=n=>n.children.map(i=>{if(i.info.type==="dir")return t(i);if(J(i.info.name))return i.info}).filter(i=>i).flat(1);return t(this.root)}get isCompleted(){return this.execQueue.length===0}async fetchChildren(t){const{files:n}=await fe(t.info.fullpath);return t.children=Tt(n,this.sortMethod).map(i=>({info:i,children:[]})),this.execQueue.shift(),this.execQueue.unshift(...t.children.filter(i=>i.info.type==="dir").map(i=>({fn:()=>this.fetchChildren(i),...i}))),t}async next(){const t=Bi(this.execQueue);if(!t)return null;const n=await t.fn();return this.execQueue=this.execQueue.slice(),this.root={...this.root},n}}function Qe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!zn(e)}const $e=new Map,M=qe(),ta=ea(),Vt=jt(),St=Cn(),Ae=new BroadcastChannel("iib-image-transfer-bus"),{eventEmitter:ke,useEventListen:je}=Bt(),{useHookShareState:te}=Di((e,{images:t})=>{const n=F({tabIdx:-1,paneIdx:-1}),i=j(()=>oe(a.value)),a=F([]),s=j(()=>{var S;return a.value.map(g=>g.curr).slice((S=M.conf)!=null&&S.is_win?1:0)}),f=j(()=>Ke(...s.value)),l=F(M.defaultSortingMethod),d=F(n.value.walkModePath?new At(n.value.walkModePath,l.value):void 0);ue([()=>n.value.walkModePath,l],()=>{d.value=n.value.walkModePath?new At(n.value.walkModePath,l.value):void 0});const h=We(new Set);ue(i,()=>h.clear());const E=j(()=>{var k;if(t.value)return t.value;if(d.value)return d.value.images.filter(A=>!h.has(A.fullpath));if(!i.value)return[];const S=((k=i.value)==null?void 0:k.files)??[],g=l.value;return Tt((A=>M.onlyFoldersAndImages?A.filter(_=>_.type==="dir"||J(_.name)):A)(S),g).filter(A=>!h.has(A.fullpath))}),w=F([]),m=F(-1),v=j(()=>d.value?!d.value.isCompleted:!1),r=F(!1),o=F(!1),c=()=>{var S,g,u;return(u=(g=(S=M.tabList)==null?void 0:S[n.value.tabIdx])==null?void 0:g.panes)==null?void 0:u[n.value.paneIdx]},y=Bt();return y.useEventListen("selectAll",()=>{console.log(`select all 0 -> ${E.value.length}`),w.value=Ft(0,E.value.length)}),{previewing:o,spinning:r,canLoadNext:v,multiSelectedIdxs:w,previewIdx:m,basePath:s,currLocation:f,currPage:i,stack:a,sortMethod:l,sortedFiles:E,scroller:F(),stackViewEl:F(),props:n,getPane:c,walker:d,deletedFiles:h,...y}},()=>({images:F()}));function Ra(){const{previewIdx:e,eventEmitter:t,canLoadNext:n,previewing:i,sortedFiles:a,scroller:s,props:f}=te().toRefs(),{state:l}=te();let d=null;const h=(v,r)=>{var o;i.value=v,d!=null&&!v&&r&&((o=s.value)==null||o.scrollToItem(d),d=null)},E=()=>{f.value.walkModePath&&!m("next")&&n&&(G.info($("loadingNextFolder")),t.value.emit("loadNextDir",!0))};he("keydown",v=>{var r;if(i.value){let o=e.value;if(["ArrowDown","ArrowRight"].includes(v.key))for(o++;a.value[o]&&!J(a.value[o].name);)o++;else if(["ArrowUp","ArrowLeft"].includes(v.key))for(o--;a.value[o]&&!J(a.value[o].name);)o--;if(J((r=a.value[o])==null?void 0:r.name)??""){e.value=o;const c=s.value;c&&!(o>=c.$_startIndex&&o<=c.$_endIndex)&&(d=o)}E()}});const w=v=>{var o;let r=e.value;if(v==="next")for(r++;a.value[r]&&!J(a.value[r].name);)r++;else if(v==="prev")for(r--;a.value[r]&&!J(a.value[r].name);)r--;if(J((o=a.value[r])==null?void 0:o.name)??""){e.value=r;const c=s.value;c&&!(r>=c.$_startIndex&&r<=c.$_endIndex)&&(d=r)}E()},m=v=>{var o;let r=e.value;if(v==="next")for(r++;a.value[r]&&!J(a.value[r].name);)r++;else if(v==="prev")for(r--;a.value[r]&&!J(a.value[r].name);)r--;return J((o=a.value[r])==null?void 0:o.name)??""};return je("removeFiles",async()=>{var v;i.value&&!l.sortedFiles[e.value]&&(G.info($("manualExitFullScreen"),5),await Ge(500),(v=document.querySelector(".ant-image-preview-operations-operation .anticon-close"))==null||v.click(),e.value=-1)}),{previewIdx:e,onPreviewVisibleChange:h,previewing:i,previewImgMove:w,canPreview:m}}function ja(){const e=F(),{scroller:t,stackViewEl:n,stack:i,currPage:a,currLocation:s,useEventListen:f,eventEmitter:l,getPane:d,props:h,deletedFiles:E,walker:w}=te().toRefs();ue(()=>i.value.length,_e((p,O)=>{var x;p!==O&&((x=t.value)==null||x.scrollToItem(0))},300));const m=async p=>{var O;await y(p),h.value.walkModePath&&(await Ge(),await((O=w.value)==null?void 0:O.reset()),l.value.emit("loadNextDir"))};In(async()=>{var p;if(!i.value.length){const O=await fe("/");i.value.push({files:O.files,curr:"/"})}e.value=new Zi,e.value.configure({parent:n.value}),h.value.path&&h.value.path!=="/"?await m(h.value.walkModePath??h.value.path):(p=M.conf)!=null&&p.home&&y(M.conf.home)}),ue(s,_e(p=>{const O=d.value();if(!O)return;O.path=p;const x=O.path.split("/").pop(),R=(()=>{var K;if(!h.value.walkModePath){const U=Se(p);for(const[ie,ae]of Object.entries(M.pathAliasMap))if(U.startsWith(ae))return U.replace(ae,ie);return x}return"Walk: "+(((K=M.quickMovePaths.find(U=>U.dir===O.walkModePath))==null?void 0:K.zh)??x)})();O.name=Me("div",{style:"display:flex;align-items:center"},[Me(Vi),Me("span",{class:"line-clamp-1",style:"max-width: 256px"},R)]),O.nameFallbackStr=R,M.recent=M.recent.filter(K=>K.key!==O.key),M.recent.unshift({path:p,key:O.key}),M.recent.length>20&&(M.recent=M.recent.slice(0,20))},300));const v=()=>Le(s.value),r=async p=>{var O,x;if(p.type==="dir")try{(O=e.value)==null||O.start();const{files:H}=await fe(p.fullpath);i.value.push({files:H,curr:p.name})}finally{(x=e.value)==null||x.done()}},o=p=>{for(;p<i.value.length-1;)i.value.pop()},c=(p,O)=>(De(M.conf,"global.conf load failed"),M.conf.is_win?p.toLowerCase()==O.toLowerCase():p==O),y=async p=>{var x,H;const O=i.value.slice();try{En(p)||(p=Ke(((x=M.conf)==null?void 0:x.sd_cwd)??"/",p));const R=ct(p),K=i.value.map(U=>U.curr);for(K.shift();K[0]&&R[0]&&c(K[0],R[0]);)K.shift(),R.shift();for(let U=0;U<K.length;U++)i.value.pop();if(!R.length)return S();for(const U of R){const ie=(H=a.value)==null?void 0:H.files.find(ae=>c(ae.name,U));if(!ie)throw console.error({frags:R,frag:U,stack:Mt(i.value)}),new Error(`${U} not found`);await r(ie)}}catch(R){throw G.error($("moveFailedCheckPath")+(R instanceof Error?R.message:"")),console.error(p,ct(p),a.value),i.value=O,R}},S=ut(async()=>{var p,O,x;try{if((p=e.value)==null||p.start(),w.value)await w.value.reset(),l.value.emit("loadNextDir");else{const{files:H}=await fe(i.value.length===1?"/":s.value);oe(i.value).files=H}E.value.clear(),(O=t.value)==null||O.scrollToItem(0),G.success($("refreshCompleted"))}finally{(x=e.value)==null||x.done()}});_n("returnToIIB",ut(async()=>{var p,O;if(!h.value.walkModePath)try{(p=e.value)==null||p.start();const{files:x}=await fe(i.value.length===1?"/":s.value);oe(i.value).files.map(R=>R.date).join()!==x.map(R=>R.date).join()&&(oe(i.value).files=x,G.success($("autoUpdate")))}finally{(O=e.value)==null||O.done()}})),f.value("refresh",S);const g=p=>{h.value.walkModePath&&(d.value().walkModePath=p),m(p)},u=j(()=>M.quickMovePaths.map(p=>({...p,path:Se(p.dir)}))),k=j(()=>{const p=Se(s.value);return u.value.find(x=>x.path===p)}),A=async()=>{const p=k.value;if(p){if(!p.can_delete)return;await si(s.value),G.success($("removeComplete"))}else await li(s.value),G.success($("addComplete"));dt.emit("searchIndexExpired"),dt.emit("updateGlobalSetting")},_=F(!1),P=F(s.value),T=()=>{_.value=!0,P.value=s.value},I=async()=>{await y(P.value),_.value=!1};return he("click",()=>{_.value=!1}),{locInputValue:P,isLocationEditing:_,onLocEditEnter:I,onEditBtnClick:T,addToSearchScanPathAndQuickMove:A,searchPathInfo:k,refresh:S,copyLocation:v,back:o,openNext:r,currPage:a,currLocation:s,to:y,stack:i,scroller:t,share:()=>{const p=parent.location,O=p.href.substring(0,p.href.length-p.search.length),x=new URLSearchParams(p.search);x.set("action","open"),x.set("path",s.value);const H=`${O}?${x.toString()}`;Le(H,$("copyLocationUrlSuccessMsg"))},selectAll:()=>l.value.emit("selectAll"),quickMoveTo:g,onCreateFloderBtnClick:async()=>{await Xi(s.value),await S()}}}function Va(){const{scroller:e,sortedFiles:t,sortMethod:n,currLocation:i,stackViewEl:a,canLoadNext:s,previewIdx:f,props:l,walker:d}=te().toRefs(),{state:h}=te(),E=F(!1),w=F(M.defaultGridCellWidth),m=j(()=>w.value+16),v=44,{width:r}=Pn(a),o=j(()=>~~(r.value/m.value)),c=j(()=>{const A=m.value;return{first:A+(w.value<=160?0:v),second:A}}),y=F(!1),S=async()=>{var A;if(!(y.value||!l.value.walkModePath||!s.value))try{y.value=!0,await((A=d.value)==null?void 0:A.next())}finally{y.value=!1}},g=async(A=!1)=>{const _=e.value,P=()=>A?f.value:(_==null?void 0:_.$_endIndex)??0;for(;!t.value.length||P()>t.value.length-20&&s.value;)await Ge(30),await S()};h.useEventListen("loadNextDir",g);const u=()=>{const A=e.value;if(A){const _=t.value.slice(Math.max(A.$_startIndex-10,0),A.$_endIndex+10).filter(P=>P.is_under_scanned_path&&J(P.name)).map(P=>P.fullpath);Vt.fetchImageTags(_)}};ue(i,_e(u,150));const k=_e(()=>{g(),u()},300);return{gridItems:o,sortedFiles:t,sortMethodConv:On,moreActionsDropdownShow:E,gridSize:m,sortMethod:n,onScroll:k,loadNextDir:S,loadNextDirLoading:y,canLoadNext:s,itemSize:c,cellWidth:w,onViewedImagesChange:u}}function Ha(){const{currLocation:e,sortedFiles:t,currPage:n,multiSelectedIdxs:i,eventEmitter:a,walker:s}=te().toRefs(),f=()=>{i.value=[]};return he("click",f),he("blur",f),ue(n,f),{onFileDragStart:(E,w)=>{const m=Mt(t.value[w]);St.fileDragging=!0,console.log("onFileDragStart set drag file ",E,w,m);const v=[m];let r=m.type==="dir";if(i.value.includes(w)){const c=i.value.map(y=>t.value[y]);v.push(...c),r=c.some(y=>y.type==="dir")}const o={includeDir:r,loc:e.value||"search-result",path:ft(v,"fullpath").map(c=>c.fullpath),nodes:ft(v,"fullpath"),__id:"FileTransferData"};E.dataTransfer.setData("text/plain",JSON.stringify(o))},onDrop:async E=>{if(s.value)return;const w=Bn(E);if(!w)return;const m=e.value;if(w.loc===m)return;const v=Nt(),r=async()=>v.pushAction(async()=>{await qi(w.path,m),a.value.emit("refresh"),se.destroyAll()}),o=()=>v.pushAction(async()=>{await Dt(w.path,m),ke.emit("removeFiles",{paths:w.path,loc:w.loc}),a.value.emit("refresh"),se.destroyAll()});se.confirm({title:$("confirm")+"?",width:"60vw",content:()=>{let c,y,S;return b("div",null,[b("div",null,[`${$("moveSelectedFilesTo")} ${m}`,b("ol",{style:{maxHeight:"50vh",overflow:"auto"}},[w.path.map(g=>b("li",null,[g.split(/[/\\]/).pop()]))])]),b(Rt,null,null),b("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end"},class:"actions"},[b(le,{onClick:se.destroyAll},Qe(c=$("cancel"))?c:{default:()=>[c]}),b(le,{type:"primary",loading:!v.isIdle,onClick:r},Qe(y=$("copy"))?y:{default:()=>[y]}),b(le,{type:"primary",loading:!v.isIdle,onClick:o},Qe(S=$("move"))?S:{default:()=>[S]})])])},maskClosable:!0,wrapClassName:"hidden-antd-btns-modal"})},multiSelectedIdxs:i,onFileDragEnd:()=>{St.fileDragging=!1}}}function Ua({openNext:e}){const t=F(!1),n=F(""),{sortedFiles:i,previewIdx:a,multiSelectedIdxs:s,stack:f,currLocation:l,spinning:d,previewing:h,stackViewEl:E,eventEmitter:w,props:m,deletedFiles:v}=te().toRefs(),r=Se;je("removeFiles",({paths:g,loc:u})=>{r(u)!==r(l.value)||!oe(f.value)||(g.forEach(A=>v.value.add(A)),g.filter(J).forEach(A=>v.value.add(A.replace(/\.\w+$/,".txt"))))}),je("addFiles",({files:g,loc:u})=>{if(r(u)!==r(l.value))return;const k=oe(f.value);k&&k.files.unshift(...g)});const o=Nt(),c=async(g,u,k)=>{a.value=k,M.fullscreenPreviewInitialUrl=ne(u);const A=s.value.indexOf(k);if(g.shiftKey){if(A!==-1)s.value.splice(A,1);else{s.value.push(k),s.value.sort((T,I)=>T-I);const _=s.value[0],P=s.value[s.value.length-1];s.value=Ft(_,P+1)}g.stopPropagation()}else g.ctrlKey||g.metaKey?(A!==-1?s.value.splice(A,1):s.value.push(k),g.stopPropagation()):await e(u)},y=async(g,u,k)=>{var I,Q,B;const A=ne(u),_=l.value,P=()=>{let C=[];return s.value.includes(k)?C=s.value.map(p=>i.value[p]):C.push(u),C},T=async C=>{if(!d.value)try{d.value=!0,await Qn(u.fullpath),Ae.postMessage(JSON.stringify({event:"click_hidden_button",btnEleId:"iib_hidden_img_update_trigger"}));const p=setTimeout(()=>$n.warn({message:$("long_loading"),duration:20}),5e3);await Fn(),clearTimeout(p),Ae.postMessage(JSON.stringify({event:"click_hidden_button",btnEleId:`iib_hidden_tab_${C}`}))}catch(p){console.error(p),G.error("发送图像失败，请携带console的错误消息找开发者")}finally{d.value=!1}};if(`${g.key}`.startsWith("toggle-tag-")){const C=+`${g.key}`.split("toggle-tag-")[1],{is_remove:p}=await oi({tag_id:C,img_path:u.fullpath}),O=(Q=(I=M.conf)==null?void 0:I.all_custom_tags.find(x=>x.id===C))==null?void 0:Q.name;Vt.refreshTags([u.fullpath]),G.success($(p?"removedTagFromImage":"addedTagToImage",{tag:O}));return}switch(g.key){case"previewInNewWindow":return window.open(A);case"download":return window.open(ne(u,!0));case"copyPreviewUrl":return Le(parent.document.location.origin+A);case"send2txt2img":return T("txt2img");case"send2img2img":return T("img2img");case"send2inpaint":return T("inpaint");case"send2extras":return T("extras");case"send2savedDir":{const C=M.quickMovePaths.find(x=>x.key==="outdir_save");if(!C)return G.error($("unknownSavedDir"));const p=Nn(C.dir,(B=M.conf)==null?void 0:B.sd_cwd),O=P();await Dt(O.map(x=>x.fullpath),p,!0),ke.emit("removeFiles",{paths:O.map(x=>x.fullpath),loc:l.value}),ke.emit("addFiles",{files:O,loc:p});break}case"send2controlnet-img2img":case"send2controlnet-txt2img":{const C=g.key.split("-")[1];Ae.postMessage(JSON.stringify({event:"send_to_control_net",type:C,url:ne(u)}));break}case"send2outpaint":{n.value=await o.pushAction(()=>vt(u.fullpath)).res;const[C,p]=(n.value||"").split(`
`);Ae.postMessage(JSON.stringify({event:"send_to_outpaint",url:ne(u),prompt:C,negPrompt:p.slice(17)}));break}case"openWithWalkMode":{$e.set(_,f.value);const C=M.tabList[m.value.tabIdx],p={type:"local",key:ye(),path:u.fullpath,name:$("local"),stackKey:_,walkModePath:u.fullpath};C.panes.push(p),C.key=p.key;break}case"openInNewTab":{$e.set(_,f.value);const C=M.tabList[m.value.tabIdx],p={type:"local",key:ye(),path:u.fullpath,name:$("local"),stackKey:_};C.panes.push(p),C.key=p.key;break}case"openOnTheRight":{$e.set(_,f.value);let C=M.tabList[m.value.tabIdx+1];C||(C={panes:[],key:"",id:ye()},M.tabList[m.value.tabIdx+1]=C);const p={type:"local",key:ye(),path:u.fullpath,name:$("local"),stackKey:_};C.panes.push(p),C.key=p.key;break}case"send2BatchDownload":{ta.addFiles(P());break}case"viewGenInfo":{t.value=!0,n.value=await o.pushAction(()=>vt(u.fullpath)).res;break}case"openWithLocalFileBrowser":{await Mn(u.fullpath);break}case"deleteFiles":{const C=P();await new Promise(p=>{se.confirm({title:$("confirmDelete"),maskClosable:!0,width:"60vw",content:b("div",null,[b("ol",{style:{maxHeight:"50vh",overflow:"auto"}},[C.map(O=>b("li",null,[O.fullpath.split(/[/\\]/).pop()]))]),b(Rt,null,null)]),async onOk(){const O=C.map(x=>x.fullpath);await Ki(O),G.success($("deleteSuccess")),ke.emit("removeFiles",{paths:O,loc:l.value}),p()}})});break}}return{}},{isOutside:S}=xn(E);return he("keydown",g=>{var k,A,_;const u=ci(g);if(h.value){const P=(k=Object.entries(M.shortcut).find(T=>T[1]===u&&T[1]))==null?void 0:k[0];if(P){g.stopPropagation(),g.preventDefault();const T=a.value,I=i.value[T];switch(P){case"delete":return ne(I)===M.fullscreenPreviewInitialUrl?G.warn($("fullscreenRestriction")):y({key:"deleteFiles"},I,T);default:{const Q=(A=/^toggle_tag_(.*)$/.exec(P))==null?void 0:A[1],B=(_=M.conf)==null?void 0:_.all_custom_tags.find(C=>C.name===Q);return B?y({key:`toggle-tag-${B.id}`},I,T):void 0}}}}else!S.value&&["Ctrl + KeyA","Cmd + KeyA"].includes(u)&&(g.preventDefault(),g.stopPropagation(),w.value.emit("selectAll"))}),{onFileItemClick:c,onContextMenuClick:y,showGenInfo:t,imageGenInfo:n,q:o}}const Ja=()=>{const{stackViewEl:e}=te().toRefs(),t=F(-1);return Tn(e,n=>{var a;let i=n.target;for(;i.parentElement;)if(i=i.parentElement,i.tagName.toLowerCase()==="li"&&i.classList.contains("file-item-trigger")){const s=(a=i.dataset)==null?void 0:a.idx;s&&Number.isSafeInteger(+s)&&(t.value=+s);return}}),{showMenuIdx:t}};function na(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);var n=e.indexOf("Trident/");if(n>0){var i=e.indexOf("rv:");return parseInt(e.substring(i+3,e.indexOf(".",i)),10)}var a=e.indexOf("Edge/");return a>0?parseInt(e.substring(a+5,e.indexOf(".",a)),10):-1}let Ce;function Ve(){Ve.init||(Ve.init=!0,Ce=na()!==-1)}var Te={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){Ve(),zt(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const e=document.createElement("object");this._resizeObject=e,e.setAttribute("aria-hidden","true"),e.setAttribute("tabindex",-1),e.onload=this.addResizeHandlers,e.type="text/html",Ce&&this.$el.appendChild(e),e.data="about:blank",Ce||this.$el.appendChild(e)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!Ce&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const ia=Rn();Dn("data-v-b329ee4c");const aa={class:"resize-observer",tabindex:"-1"};Ln();const ra=ia((e,t,n,i,a,s)=>(z(),W("div",aa)));Te.render=ra;Te.__scopeId="data-v-b329ee4c";Te.__file="src/components/ResizeObserver.vue";function Ie(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ie=function(t){return typeof t}:Ie=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ie(e)}function sa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function la(e,t,n){return t&&kt(e.prototype,t),n&&kt(e,n),e}function Ct(e){return oa(e)||ca(e)||ua(e)||da()}function oa(e){if(Array.isArray(e))return He(e)}function ca(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function ua(e,t){if(e){if(typeof e=="string")return He(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return He(e,t)}}function He(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function da(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fa(e){var t;return typeof e=="function"?t={callback:e}:t=e,t}function va(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,a,s,f=function(d){for(var h=arguments.length,E=new Array(h>1?h-1:0),w=1;w<h;w++)E[w-1]=arguments[w];if(s=E,!(i&&d===a)){var m=n.leading;typeof m=="function"&&(m=m(d,a)),(!i||d!==a)&&m&&e.apply(void 0,[d].concat(Ct(s))),a=d,clearTimeout(i),i=setTimeout(function(){e.apply(void 0,[d].concat(Ct(s))),i=0},t)}};return f._clear=function(){clearTimeout(i),i=null},f}function Ht(e,t){if(e===t)return!0;if(Ie(e)==="object"){for(var n in e)if(!Ht(e[n],t[n]))return!1;return!0}return!1}var pa=function(){function e(t,n,i){sa(this,e),this.el=t,this.observer=null,this.frozen=!1,this.createObserver(n,i)}return la(e,[{key:"createObserver",value:function(n,i){var a=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=fa(n),this.callback=function(l,d){a.options.callback(l,d),l&&a.options.once&&(a.frozen=!0,a.destroyObserver())},this.callback&&this.options.throttle){var s=this.options.throttleOptions||{},f=s.leading;this.callback=va(this.callback,this.options.throttle,{leading:function(d){return f==="both"||f==="visible"&&d||f==="hidden"&&!d}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(l){var d=l[0];if(l.length>1){var h=l.find(function(w){return w.isIntersecting});h&&(d=h)}if(a.callback){var E=d.isIntersecting&&d.intersectionRatio>=a.threshold;if(E===a.oldResult)return;a.oldResult=E,a.callback(E,d)}},this.options.intersection),zt(function(){a.observer&&a.observer.observe(a.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),e}();function Ut(e,t,n){var i=t.value;if(i)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var a=new pa(e,i,n);e._vue_visibilityState=a}}function ha(e,t,n){var i=t.value,a=t.oldValue;if(!Ht(i,a)){var s=e._vue_visibilityState;if(!i){Jt(e);return}s?s.createObserver(i,n):Ut(e,{value:i},n)}}function Jt(e){var t=e._vue_visibilityState;t&&(t.destroyObserver(),delete e._vue_visibilityState)}var ma={beforeMount:Ut,updated:ha,unmounted:Jt},ga={itemsLimit:1e3},ya=/(auto|scroll)/;function Wt(e,t){return e.parentNode===null?t:Wt(e.parentNode,t.concat([e]))}var Fe=function(t,n){return getComputedStyle(t,null).getPropertyValue(n)},ba=function(t){return Fe(t,"overflow")+Fe(t,"overflow-y")+Fe(t,"overflow-x")},wa=function(t){return ya.test(ba(t))};function It(e){if(e instanceof HTMLElement||e instanceof SVGElement){for(var t=Wt(e.parentNode,[]),n=0;n<t.length;n+=1)if(wa(t[n]))return t[n];return document.scrollingElement||document.documentElement}}function Ue(e){"@babel/helpers - typeof";return Ue=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ue(e)}var Aa={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(t){return["vertical","horizontal"].includes(t)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function Sa(){return this.items.length&&Ue(this.items[0])!=="object"}var Je=!1;if(typeof window<"u"){Je=!1;try{var ka=Object.defineProperty({},"passive",{get:function(){Je=!0}});window.addEventListener("test",null,ka)}catch{}}let Ca=0;var Kt={name:"RecycleScroller",components:{ResizeObserver:Te},directives:{ObserveVisibility:ma},props:{...Aa,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const e={"-1":{accumulator:0}},t=this.items,n=this.sizeField,i=this.minItemSize;let a=1e4,s=0,f;for(let l=0,d=t.length;l<d;l++)f=t[l][n]||i,f<a&&(a=f),s+=f,e[l]={accumulator:s,size:f};return this.$_computedMinItemSize=a,e}return[]},simpleArray:Sa,itemIndexByKey(){const{keyField:e,items:t}=this,n={};for(let i=0,a=t.length;i<a;i++)n[t[i][e]]=i;return n}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const e=this.$_lastUpdateScrollPosition;typeof e=="number"&&this.$nextTick(()=>{this.scrollToPosition(e)})},beforeUnmount(){this.removeListeners()},methods:{addView(e,t,n,i,a){const s=jn({id:Ca++,index:t,used:!0,key:i,type:a}),f=Vn({item:n,position:0,nr:s});return e.push(f),f},unuseView(e,t=!1){const n=this.$_unusedViews,i=e.nr.type;let a=n.get(i);a||(a=[],n.set(i,a)),a.push(e),t||(e.nr.used=!1,e.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(e){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const t=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:n}=this.updateVisibleItems(!1,!0);n||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});t(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&t()},this.updateInterval))}},handleVisibilityChange(e,t){this.ready&&(e||t.boundingClientRect.width!==0||t.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(e,t=!1){const n=this.itemSize,i=this.gridItems||1,a=this.itemSecondarySize||n,s=this.$_computedMinItemSize,f=this.typeField,l=this.simpleArray?null:this.keyField,d=this.items,h=d.length,E=this.sizes,w=this.$_views,m=this.$_unusedViews,v=this.pool,r=this.itemIndexByKey;let o,c,y,S,g;if(!h)o=c=S=g=y=0;else if(this.$_prerender)o=S=0,c=g=Math.min(this.prerender,d.length),y=null;else{const I=this.getScroll();if(t){let C=I.start-this.$_lastUpdateScrollPosition;if(C<0&&(C=-C),n===null&&C<s||C<n)return{continuous:!0}}this.$_lastUpdateScrollPosition=I.start;const Q=this.buffer;I.start-=Q,I.end+=Q;let B=0;if(this.$refs.before&&(B=this.$refs.before.scrollHeight,I.start-=B),this.$refs.after){const C=this.$refs.after.scrollHeight;I.end+=C}if(n===null){let C,p=0,O=h-1,x=~~(h/2),H;do H=x,C=E[x].accumulator,C<I.start?p=x:x<h-1&&E[x+1].accumulator>I.start&&(O=x),x=~~((p+O)/2);while(x!==H);for(x<0&&(x=0),o=x,y=E[h-1].accumulator,c=x;c<h&&E[c].accumulator<I.end;c++);for(c===-1?c=d.length-1:(c++,c>h&&(c=h)),S=o;S<h&&B+E[S].accumulator<I.start;S++);for(g=S;g<h&&B+E[g].accumulator<I.end;g++);}else{o=~~(I.start/n*i);const C=o%i;o-=C,c=Math.ceil(I.end/n*i),S=Math.max(0,Math.floor((I.start-B)/n*i)),g=Math.floor((I.end-B)/n*i),o<0&&(o=0),c>h&&(c=h),S<0&&(S=0),g>h&&(g=h),y=Math.ceil(h/i)*n}}c-o>ga.itemsLimit&&this.itemsLimitError(),this.totalSize=y;let u;const k=o<=this.$_endIndex&&c>=this.$_startIndex;if(k)for(let I=0,Q=v.length;I<Q;I++)u=v[I],u.nr.used&&(e&&(u.nr.index=r[u.item[l]]),(u.nr.index==null||u.nr.index<o||u.nr.index>=c)&&this.unuseView(u));const A=k?null:new Map;let _,P,T;for(let I=o;I<c;I++){_=d[I];const Q=l?_[l]:_;if(Q==null)throw new Error(`Key is ${Q} on item (keyField is '${l}')`);if(u=w.get(Q),!n&&!E[I].size){u&&this.unuseView(u);continue}P=_[f];let B=m.get(P),C=!1;if(!u)k?B&&B.length?u=B.pop():u=this.addView(v,I,_,Q,P):(T=A.get(P)||0,(!B||T>=B.length)&&(u=this.addView(v,I,_,Q,P),this.unuseView(u,!0),B=m.get(P)),u=B[T],A.set(P,T+1)),w.delete(u.nr.key),u.nr.used=!0,u.nr.index=I,u.nr.key=Q,u.nr.type=P,w.set(Q,u),C=!0;else if(!u.nr.used&&(u.nr.used=!0,u.nr.index=I,C=!0,B)){const p=B.indexOf(u);p!==-1&&B.splice(p,1)}u.item=_,C&&(I===d.length-1&&this.$emit("scroll-end"),I===0&&this.$emit("scroll-start")),n===null?(u.position=E[I-1].accumulator,u.offset=0):(u.position=Math.floor(I/i)*n,u.offset=I%i*a)}return this.$_startIndex=o,this.$_endIndex=c,this.emitUpdate&&this.$emit("update",o,c,S,g),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:k}},getListenerTarget(){let e=It(this.$el);return window.document&&(e===window.document.documentElement||e===window.document.body)&&(e=window),e},getScroll(){const{$el:e,direction:t}=this,n=t==="vertical";let i;if(this.pageMode){const a=e.getBoundingClientRect(),s=n?a.height:a.width;let f=-(n?a.top:a.left),l=n?window.innerHeight:window.innerWidth;f<0&&(l+=f,f=0),f+l>s&&(l=s-f),i={start:f,end:f+l}}else n?i={start:e.scrollTop,end:e.scrollTop+e.clientHeight}:i={start:e.scrollLeft,end:e.scrollLeft+e.clientWidth};return i},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,Je?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(e){let t;const n=this.gridItems||1;this.itemSize===null?t=e>0?this.sizes[e-1].accumulator:0:t=Math.floor(e/n)*this.itemSize,this.scrollToPosition(t)},scrollToPosition(e){const t=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let n,i,a;if(this.pageMode){const s=It(this.$el),f=s.tagName==="HTML"?0:s[t.scroll],l=s.getBoundingClientRect(),h=this.$el.getBoundingClientRect()[t.start]-l[t.start];n=s,i=t.scroll,a=e+f+h}else n=this.$el,i=t.scroll,a=e;n[i]=a},itemsLimitError(){throw setTimeout(()=>{console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",this.$el),console.log("Make sure the scroller has a fixed height (or width) and 'overflow-y' (or 'overflow-x') set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((e,t)=>e.nr.index-t.nr.index)}}};const Ia={key:0,ref:"before",class:"vue-recycle-scroller__slot"},Ea={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function _a(e,t,n,i,a,s){const f=Hn("ResizeObserver"),l=Un("observe-visibility");return Jn((z(),V("div",{class:Pe(["vue-recycle-scroller",{ready:a.ready,"page-mode":n.pageMode,[`direction-${e.direction}`]:!0}]),onScrollPassive:t[0]||(t[0]=(...d)=>s.handleScroll&&s.handleScroll(...d))},[e.$slots.before?(z(),V("div",Ia,[be(e.$slots,"before")],512)):Y("v-if",!0),(z(),W(pt(n.listTag),{ref:"wrapper",style:qn({[e.direction==="vertical"?"minHeight":"minWidth"]:a.totalSize+"px"}),class:Pe(["vue-recycle-scroller__item-wrapper",n.listClass])},{default:N(()=>[(z(!0),V(X,null,Ye(a.pool,d=>(z(),W(pt(n.itemTag),Wn({key:d.nr.id,style:a.ready?{transform:`translate${e.direction==="vertical"?"Y":"X"}(${d.position}px) translate${e.direction==="vertical"?"X":"Y"}(${d.offset}px)`,width:n.gridItems?`${e.direction==="vertical"&&n.itemSecondarySize||n.itemSize}px`:void 0,height:n.gridItems?`${e.direction==="horizontal"&&n.itemSecondarySize||n.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[n.itemClass,{hover:!n.skipHover&&a.hoverKey===d.nr.key}]]},Kn(n.skipHover?{}:{mouseenter:()=>{a.hoverKey=d.nr.key},mouseleave:()=>{a.hoverKey=null}})),{default:N(()=>[be(e.$slots,"default",{item:d.item,index:d.nr.index,active:d.nr.used})]),_:2},1040,["style","class"]))),128)),be(e.$slots,"empty")]),_:3},8,["style","class"])),e.$slots.after?(z(),V("div",Ea,[be(e.$slots,"after")],512)):Y("v-if",!0),b(f,{onNotify:s.handleResize},null,8,["onNotify"])],34)),[[l,s.handleVisibilityChange]])}Kt.render=_a;Kt.__file="src/components/RecycleScroller.vue";const Et=de({__name:"ContextMenu",props:{file:{},idx:{},selectedTag:{},disableDelete:{type:Boolean}},emits:["contextMenuClick"],setup(e,{emit:t}){const n=e,i=qe(),a=j(()=>{var s;return(((s=i.conf)==null?void 0:s.all_custom_tags)??[]).reduce((f,l)=>[...f,{...l,selected:!!n.selectedTag.find(d=>d.id===l.id)}],[])});return(s,f)=>{const l=Gn,d=Yn,h=Zn,E=Xn;return z(),W(E,{onClick:f[0]||(f[0]=w=>t("contextMenuClick",w,s.file,s.idx))},{default:N(()=>{var w;return[b(l,{key:"deleteFiles",disabled:s.disableDelete},{default:N(()=>[L(D(s.$t("deleteSelected")),1)]),_:1},8,["disabled"]),s.file.type==="dir"?(z(),V(X,{key:0},[b(l,{key:"openInNewTab"},{default:N(()=>[L(D(s.$t("openInNewTab")),1)]),_:1}),b(l,{key:"openOnTheRight"},{default:N(()=>[L(D(s.$t("openOnTheRight")),1)]),_:1}),b(l,{key:"openWithWalkMode"},{default:N(()=>[L(D(s.$t("openWithWalkMode")),1)]),_:1})],64)):Y("",!0),s.file.type==="file"?(z(),V(X,{key:1},[q(J)(s.file.name)?(z(),V(X,{key:0},[b(l,{key:"viewGenInfo"},{default:N(()=>[L(D(s.$t("viewGenerationInfo")),1)]),_:1}),b(d),((w=q(i).conf)==null?void 0:w.launch_mode)!=="server"?(z(),V(X,{key:0},[b(l,{key:"send2txt2img"},{default:N(()=>[L(D(s.$t("sendToTxt2img")),1)]),_:1}),b(l,{key:"send2img2img"},{default:N(()=>[L(D(s.$t("sendToImg2img")),1)]),_:1}),b(l,{key:"send2inpaint"},{default:N(()=>[L(D(s.$t("sendToInpaint")),1)]),_:1}),b(l,{key:"send2extras"},{default:N(()=>[L(D(s.$t("sendToExtraFeatures")),1)]),_:1}),b(h,{key:"sendToThirdPartyExtension",title:s.$t("sendToThirdPartyExtension")},{default:N(()=>[b(l,{key:"send2controlnet-txt2img"},{default:N(()=>[L("ControlNet - "+D(s.$t("t2i")),1)]),_:1}),b(l,{key:"send2controlnet-img2img"},{default:N(()=>[L("ControlNet - "+D(s.$t("i2i")),1)]),_:1}),b(l,{key:"send2outpaint"},{default:N(()=>[L("openOutpaint")]),_:1})]),_:1},8,["title"])],64)):Y("",!0),b(l,{key:"send2BatchDownload"},{default:N(()=>[L(D(s.$t("sendToBatchDownload")),1)]),_:1}),b(l,{key:"send2savedDir"},{default:N(()=>[L(D(s.$t("send2savedDir")),1)]),_:1}),b(d),b(h,{key:"toggle-tag",title:s.$t("toggleTag")},{default:N(()=>[(z(!0),V(X,null,Ye(a.value,m=>(z(),W(l,{key:`toggle-tag-${m.id}`},{default:N(()=>[L(D(m.name)+" ",1),m.selected?(z(),W(q(Si),{key:0})):(z(),W(q(Wi),{key:1}))]),_:2},1024))),128))]),_:1},8,["title"]),b(l,{key:"openWithLocalFileBrowser"},{default:N(()=>[L(D(s.$t("openWithLocalFileBrowser")),1)]),_:1})],64)):Y("",!0),b(l,{key:"previewInNewWindow"},{default:N(()=>[L(D(s.$t("previewInNewWindow")),1)]),_:1}),b(l,{key:"download"},{default:N(()=>[L(D(s.$t("download")),1)]),_:1}),b(l,{key:"copyPreviewUrl"},{default:N(()=>[L(D(s.$t("copySourceFilePreviewLink")),1)]),_:1})],64)):Y("",!0)]}),_:1})}}}),Pa=["data-idx"],Oa={class:"more"},xa={key:0,class:"tags-container"},Ta={key:3,class:"preview-icon-wrap"},Ba={key:4,class:"profile"},Ma={class:"name line-clamp-1"},Na={class:"basic-info"},za=de({__name:"FileItem",props:{file:{},idx:{},selected:{type:Boolean,default:!1},showMenuIdx:{},cellWidth:{},fullScreenPreviewImageUrl:{},enableRightClickMenu:{type:Boolean,default:!0},enableCloseIcon:{type:Boolean,default:!1}},emits:["update:showMenuIdx","fileItemClick","dragstart","dragend","previewVisibleChange","contextMenuClick","close-icon-click"],setup(e,{emit:t}){const n=e;ei(l=>({aaf8adf2:l.$props.cellWidth+"px"}));const i=qe(),a=jt(),s=j(()=>a.tagMap.get(n.file.fullpath)??[]),f=j(()=>{const l=i.gridThumbnailResolution;return i.enableThumbnail?ti(n.file,[l,l].join("x")):ne(n.file)});return(l,d)=>{const h=ce,E=ii,w=yi;return z(),W(h,{trigger:["contextmenu"],visible:q(i).longPressOpenContextMenu?typeof l.idx=="number"&&l.showMenuIdx===l.idx:void 0,"onUpdate:visible":d[6]||(d[6]=m=>typeof l.idx=="number"&&t("update:showMenuIdx",m?l.idx:-1))},{overlay:N(()=>[l.enableRightClickMenu?(z(),W(Et,{key:0,file:l.file,idx:l.idx,"selected-tag":s.value,onContextMenuClick:d[5]||(d[5]=(m,v,r)=>t("contextMenuClick",m,v,r))},null,8,["file","idx","selected-tag"])):Y("",!0)]),default:N(()=>[(z(),V("li",{class:Pe(["file file-item-trigger grid",{clickable:l.file.type==="dir",selected:l.selected}]),"data-idx":l.idx,key:l.file.name,draggable:"true",onDragstart:d[2]||(d[2]=m=>t("dragstart",m,l.idx)),onDragend:d[3]||(d[3]=m=>t("dragend",m,l.idx)),onClickCapture:d[4]||(d[4]=m=>t("fileItemClick",m,l.file,l.idx))},[re("div",null,[l.enableCloseIcon?(z(),V("div",{key:0,class:"close-icon",onClick:d[0]||(d[0]=m=>t("close-icon-click"))},[b(q(ni))])):Y("",!0),l.enableRightClickMenu?(z(),W(h,{key:1},{overlay:N(()=>[b(Et,{file:l.file,idx:l.idx,"selected-tag":s.value,onContextMenuClick:d[1]||(d[1]=(m,v,r)=>t("contextMenuClick",m,v,r))},null,8,["file","idx","selected-tag"])]),default:N(()=>[re("div",Oa,[b(q(Pt))])]),_:1})):Y("",!0),q(J)(l.file.name)?(z(),V("div",{style:{position:"relative"},key:l.file.fullpath,class:Pe(`idx-${l.idx}`)},[b(E,{src:f.value,fallback:q(Fi),preview:{src:l.fullScreenPreviewImageUrl,onVisibleChange:(m,v)=>t("previewVisibleChange",m,v)}},null,8,["src","fallback","preview"]),s.value&&l.cellWidth>128?(z(),V("div",xa,[(z(!0),V(X,null,Ye(s.value,m=>(z(),W(w,{key:m.id,color:q(a).getColor(m.name)},{default:N(()=>[L(D(m.name),1)]),_:2},1032,["color"]))),128))])):Y("",!0)],2)):(z(),V("div",Ta,[l.file.type==="file"?(z(),W(q(Ei),{key:0,class:"icon center"})):(z(),W(q(xi),{key:1,class:"icon center"}))])),l.cellWidth>128?(z(),V("div",Ba,[re("div",Ma,D(l.file.name),1),re("div",Na,[re("div",null,D(l.file.size),1),re("div",null,D(l.file.date),1)])])):Y("",!0)])],42,Pa))]),_:1},8,["visible"])}}});const Wa=ai(za,[["__scopeId","data-v-eb7b4ec8"]]);export{ce as D,Wa as F,Si as S,Et as _,ja as a,Va as b,Ha as c,Ua as d,Ra as e,Ja as f,Kt as g,jt as h,je as i,he as j,Wi as k,yi as l,ea as m,$e as s,te as u};
