import{d as ae,u as we,g as ee,_ as Oe,c as a,a as _e,P as pe,D as be,f as Ue,w as st,b as lt,e as it,h as ze,M as Ce,i as ut,j as dt,F as ye,o as c,k as $,l as u,m as U,t as d,n as ce,p as O,q as We,r as ct,s as je,v as Te,x as pt,y as ft,z as D,A as s,B as p,C as e,E as K,G as mt,H as ke,I as vt,J as gt,K as kt,L as _t,S as bt,N as Ct,O as yt,Q as ht,R as Ve,T as wt,U as It,V as $t,W as St,X as Pt,Y as Ft,Z as At}from"./index-594b377e.js";import{S as te,s as Mt,L as Bt,R as Rt,f as Nt}from"./fullScreenContextMenu-d4973581.js";import{F as W,N as xt,_ as Dt,a as Et}from"./numInput-a85b6bf0.js";import"./index-4b259bab.js";import{D as Ge}from"./index-04d9d05b.js";/* empty css              *//* empty css              */import{u as zt,a as jt,b as Tt,c as Vt,d as Lt,e as Ot,f as Ut,s as Wt,g as Gt,F as qt}from"./FileItem-da781493.js";import"./functionalCallableComp-38aac1fd.js";import"./db-7db14331.js";var Kt=["class","style"],Qt=function(){return{prefixCls:String,href:String,separator:pe.any,overlay:pe.any,onClick:Function}};const ne=ae({compatConfig:{MODE:3},name:"ABreadcrumbItem",inheritAttrs:!1,__ANT_BREADCRUMB_ITEM:!0,props:Qt(),slots:["separator","overlay"],setup:function(r,h){var g=h.slots,_=h.attrs,P=we("breadcrumb",r),y=P.prefixCls,M=function(F,m){var i=ee(g,r,"overlay");return i?a(Ge,{overlay:i,placement:"bottom"},{default:function(){return[a("span",{class:"".concat(m,"-overlay-link")},[F,a(be,null,null)])]}}):F};return function(){var B,F=(B=ee(g,r,"separator"))!==null&&B!==void 0?B:"/",m=ee(g,r),i=_.class,b=_.style,k=Oe(_,Kt),v;return r.href!==void 0?v=a("a",_e({class:"".concat(y.value,"-link"),onClick:r.onClick},k),[m]):v=a("span",_e({class:"".concat(y.value,"-link"),onClick:r.onClick},k),[m]),v=M(v,y.value),m?a("span",{class:i,style:b},[v,F&&a("span",{class:"".concat(y.value,"-separator")},[F])]):null}}});var Ht=function(){return{prefixCls:String,routes:{type:Array},params:pe.any,separator:pe.any,itemRender:{type:Function}}};function Jt(l,r){if(!l.breadcrumbName)return null;var h=Object.keys(r).join("|"),g=l.breadcrumbName.replace(new RegExp(":(".concat(h,")"),"g"),function(_,P){return r[P]||_});return g}function Le(l){var r=l.route,h=l.params,g=l.routes,_=l.paths,P=g.indexOf(r)===g.length-1,y=Jt(r,h);return P?a("span",null,[y]):a("a",{href:"#/".concat(_.join("/"))},[y])}const Q=ae({compatConfig:{MODE:3},name:"ABreadcrumb",props:Ht(),slots:["separator","itemRender"],setup:function(r,h){var g=h.slots,_=we("breadcrumb",r),P=_.prefixCls,y=_.direction,M=function(i,b){return i=(i||"").replace(/^\//,""),Object.keys(b).forEach(function(k){i=i.replace(":".concat(k),b[k])}),i},B=function(i,b,k){var v=ut(i),A=M(b||"",k);return A&&v.push(A),v},F=function(i){var b=i.routes,k=b===void 0?[]:b,v=i.params,A=v===void 0?{}:v,N=i.separator,E=i.itemRender,z=E===void 0?Le:E,j=[];return k.map(function(w){var T=M(w.path,A);T&&j.push(T);var H=[].concat(j),J=null;return w.children&&w.children.length&&(J=a(Ce,null,{default:function(){return[w.children.map(function(G){return a(Ce.Item,{key:G.path||G.breadcrumbName},{default:function(){return[z({route:G,params:A,routes:k,paths:B(H,G.path,A)})]}})})]}})),a(ne,{overlay:J,separator:N,key:T||w.breadcrumbName},{default:function(){return[z({route:w,params:A,routes:k,paths:H})]}})})};return function(){var m,i,b,k=r.routes,v=r.params,A=v===void 0?{}:v,N=Ue(ee(g,r)),E=(m=ee(g,r,"separator"))!==null&&m!==void 0?m:"/",z=r.itemRender||g.itemRender||Le;k&&k.length>0?b=F({routes:k,params:A,separator:E,itemRender:z}):N.length&&(b=N.map(function(w,T){return st(lt(w.type)==="object"&&(w.type.__ANT_BREADCRUMB_ITEM||w.type.__ANT_BREADCRUMB_SEPARATOR),"Breadcrumb","Only accepts Breadcrumb.Item and Breadcrumb.Separator as it's children"),it(w,{separator:E,key:T})}));var j=(i={},ze(i,P.value,!0),ze(i,"".concat(P.value,"-rtl"),y.value==="rtl"),i);return a("div",{class:j},[b])}}});var Xt=["separator","class"],Yt=function(){return{prefixCls:String}};const he=ae({compatConfig:{MODE:3},name:"ABreadcrumbSeparator",__ANT_BREADCRUMB_SEPARATOR:!0,inheritAttrs:!1,props:Yt(),setup:function(r,h){var g=h.slots,_=h.attrs,P=we("breadcrumb",r),y=P.prefixCls;return function(){var M;_.separator;var B=_.class,F=Oe(_,Xt),m=Ue((M=g.default)===null||M===void 0?void 0:M.call(g));return a("span",_e({class:["".concat(y.value,"-separator"),B]},F),[m.length>0?m:"/"])}}});Q.Item=ne;Q.Separator=he;Q.install=function(l){return l.component(Q.name,Q),l.component(ne.name,ne),l.component(he.name,he),l};W.useInjectFormItemContext=dt;W.ItemRest=ye;W.install=function(l){return l.component(W.name,W),l.component(W.Item.name,W.Item),l.component(ye.name,ye),l};te.setDefaultIndicator=Mt;te.install=function(l){return l.component(te.name,te),l};const Zt={class:"base-info"},en=ae({__name:"BaseFileListInfo",props:{fileNum:{},selectedFileNum:{}},setup(l){return(r,h)=>(c(),$("div",Zt,[u("span",null,[U(d(r.$t("items",[r.fileNum]))+" ",1),r.selectedFileNum?(c(),$(ce,{key:0},[U(", "+d(r.$t("selectedItems",[r.selectedFileNum])),1)],64)):O("",!0)])]))}});const tn=We(en,[["__scopeId","data-v-afd25667"]]),nn={class:"hint"},an={class:"location-bar"},on={key:0,class:"breadcrumb"},rn=["onClick"],sn={key:3,class:"location-act"},ln={class:"actions"},un=["onClick"],dn={style:{width:"512px",background:"var(--zp-primary-background)",padding:"16px","border-radius":"4px","box-shadow":"0 0 4px var(--zp-secondary-background)",border:"1px solid var(--zp-secondary-background)"}},cn={style:{padding:"4px"}},pn={style:{padding:"4px"}},fn={style:{padding:"4px"}},mn={key:0,class:"view"},vn={style:{padding:"16px 0 64px"}},gn={key:0,class:"preview-switch"},kn=ae({__name:"stackView",props:{tabIdx:{},paneIdx:{},path:{},walkModePath:{},stackKey:{}},setup(l){const r=l,h=ct(),{scroller:g,stackViewEl:_,props:P,multiSelectedIdxs:y,spinning:M}=zt().toRefs(),{currLocation:B,currPage:F,refresh:m,copyLocation:i,back:b,openNext:k,stack:v,quickMoveTo:A,addToSearchScanPathAndQuickMove:N,searchPathInfo:E,locInputValue:z,isLocationEditing:j,onLocEditEnter:w,onEditBtnClick:T,share:H,selectAll:J,onCreateFloderBtnClick:oe,onWalkBtnClick:G,showWalkButton:Ie,searchInCurrentDir:$e}=jt(),{gridItems:qe,sortMethodConv:Ke,moreActionsDropdownShow:fe,sortedFiles:f,sortMethod:me,itemSize:Se,loadNextDir:Qe,loadNextDirLoading:He,canLoadNext:Je,onScroll:Xe,cellWidth:re}=Tt(),{onDrop:Ye,onFileDragStart:Ze,onFileDragEnd:et}=Vt(),{onFileItemClick:tt,onContextMenuClick:Pe,showGenInfo:se,imageGenInfo:Fe,q:Ae}=Lt({openNext:k}),{previewIdx:le,onPreviewVisibleChange:nt,previewing:Me,previewImgMove:Be,canPreview:Re}=Ot(),{showMenuIdx:ve}=Ut();je(()=>r,()=>{P.value=r;const o=Wt.get(r.stackKey??"");o&&(v.value=o.slice())},{immediate:!0}),je(f,async(o,t)=>{o.length>0&&o.length!==t.length&&Ne()});const ie=Te(!0),ge=Te(!1);function Ne(){let o=[];const t=[".png",".jpg",".jpeg"];for(let I in f.value)f.value[I].type=="file"&&t.includes(f.value[I].fullpath.slice(-4).toLowerCase())&&o.push(f.value[I].fullpath);Ae.pushAction(()=>pt(o)).res.then(I=>{for(let V in f.value)f.value[V].gen_info_raw=I[f.value[V].fullpath],f.value[V].gen_info_obj=ft(I[f.value[V].fullpath])})}function xe(o,t,I,V){let S={diff:{},empty:!0,ownFile:"",otherFile:""};if(t+I<0||t+I>=f.value.length||f.value[t]==null||!("gen_info_obj"in f.value[t])||!("gen_info_obj"in f.value[t+I]))return S;let L=o,x=f.value[t+I].gen_info_obj;if(x==null)return S;let ue=["hashes","resources"];S.diff={},S.ownFile=V.name,S.otherFile=f.value[t+I].name,S.empty=!1,ge.value||ue.push("seed");for(let C in L)if(!ue.includes(C)){if(!(C in x)){S.diff[C]="+";continue}if(L[C]!=x[C])if(C.includes("rompt")&&L[C]!=""&&x[C]!=""){let X=L[C].split(","),Y=x[C].split(","),Z=0;for(let q in X)X[q]!=Y[q]&&Z++;S.diff[C]=Z}else S.diff[C]=[L[C],x[C]]}return S}return(o,t)=>{const I=wt,V=It,S=$t,L=ne,x=Q,ue=St,C=Pt,X=Ft,Y=At,Z=Ce,q=Ge,at=xt,de=Dt,De=Et,ot=W,rt=te;return c(),D(rt,{spinning:e(M),size:"large"},{default:s(()=>[a(I,{style:{display:"none"}}),u("div",{ref_key:"stackViewEl",ref:_,onDragover:t[30]||(t[30]=p(()=>{},["prevent"])),onDrop:t[31]||(t[31]=p(n=>e(Ye)(n),["prevent"])),class:"container"},[a(S,{visible:e(se),"onUpdate:visible":t[1]||(t[1]=n=>K(se)?se.value=n:null),width:"70vw","mask-closable":"",onOk:t[2]||(t[2]=n=>se.value=!1)},{cancelText:s(()=>[]),default:s(()=>[a(V,{active:"",loading:!e(Ae).isIdle},{default:s(()=>[u("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto","z-index":"9999"},onDblclick:t[0]||(t[0]=n=>e(mt)(e(Fe)))},[u("div",nn,d(o.$t("doubleClickToCopy")),1),U(" "+d(e(Fe)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),u("div",an,[r.walkModePath?(c(),$("div",on,[a(ue,null,{title:s(()=>[U(d(o.$t("walk-mode-move-message")),1)]),default:s(()=>[a(x,{style:{flex:"1"}},{default:s(()=>[(c(!0),$(ce,null,ke(e(v),(n,R)=>(c(),D(L,{key:R},{default:s(()=>[u("span",null,d(n.curr==="/"?o.$t("root"):n.curr.replace(/:\/$/,o.$t("drive"))),1)]),_:2},1024))),128))]),_:1})]),_:1})])):(c(),$("div",{key:1,class:"breadcrumb",style:vt({flex:e(j)?1:""})},[e(j)?(c(),D(C,{key:0,style:{flex:"1"},value:e(z),"onUpdate:value":t[3]||(t[3]=n=>K(z)?z.value=n:null),onClick:t[4]||(t[4]=p(()=>{},["stop"])),onKeydown:t[5]||(t[5]=p(()=>{},["stop"])),onPressEnter:e(w),"allow-clear":""},null,8,["value","onPressEnter"])):(c(),D(x,{key:1,style:{flex:"1"}},{default:s(()=>[(c(!0),$(ce,null,ke(e(v),(n,R)=>(c(),D(L,{key:R},{default:s(()=>[u("a",{onClick:p(Ee=>e(b)(R),["prevent"])},d(n.curr==="/"?o.$t("root"):n.curr.replace(/:\/$/,o.$t("drive"))),9,rn)]),_:2},1024))),128))]),_:1})),e(j)?(c(),D(X,{key:2,size:"small",onClick:e(w),type:"primary"},{default:s(()=>[U(d(o.$t("go")),1)]),_:1},8,["onClick"])):(c(),$("div",sn,[u("a",{onClick:t[6]||(t[6]=p((...n)=>e(i)&&e(i)(...n),["prevent"])),class:"copy"},d(o.$t("copy")),1),u("a",{onClick:t[7]||(t[7]=p((...n)=>e(T)&&e(T)(...n),["prevent","stop"]))},d(o.$t("edit")),1)]))],4)),u("div",ln,[u("a",{class:"opt",onClick:t[8]||(t[8]=p((...n)=>e(m)&&e(m)(...n),["prevent"]))},d(o.$t("refresh")),1),a(q,null,{overlay:s(()=>[a(Z,null,{default:s(()=>[a(Y,{key:"tag-search"},{default:s(()=>[u("a",{onClick:t[10]||(t[10]=p(n=>e($e)("tag-search"),["prevent"]))},d(o.$t("imgSearch")),1)]),_:1}),a(Y,{key:"tag-search"},{default:s(()=>[u("a",{onClick:t[11]||(t[11]=p(n=>e($e)("fuzzy-search"),["prevent"]))},d(o.$t("fuzzy-search")),1)]),_:1})]),_:1})]),default:s(()=>[u("a",{class:"opt",onClick:t[9]||(t[9]=p(()=>{},["prevent"]))},[U(d(o.$t("search"))+" ",1),a(e(be))])]),_:1}),e(Ie)?(c(),$("a",{key:0,class:"opt",onClick:t[12]||(t[12]=p((...n)=>e(G)&&e(G)(...n),["prevent"]))}," Walk ")):O("",!0),u("a",{class:"opt",onClick:t[13]||(t[13]=p((...n)=>e(J)&&e(J)(...n),["prevent","stop"]))},d(o.$t("selectAll")),1),e(gt)?O("",!0):(c(),$("a",{key:1,class:"opt",onClick:t[14]||(t[14]=p((...n)=>e(H)&&e(H)(...n),["prevent"]))},d(o.$t("share")),1)),a(q,null,{overlay:s(()=>[a(Z,null,{default:s(()=>[(c(!0),$(ce,null,ke(e(h).quickMovePaths,n=>(c(),D(Y,{key:n.dir},{default:s(()=>[u("a",{onClick:p(R=>e(A)(n.dir),["prevent"])},d(n.zh),9,un)]),_:2},1024))),128))]),_:1})]),default:s(()=>[u("a",{class:"opt",onClick:t[15]||(t[15]=p(()=>{},["prevent"]))},[U(d(o.$t("quickMove"))+" ",1),a(e(be))])]),_:1}),a(q,{trigger:["click"],visible:e(fe),"onUpdate:visible":t[26]||(t[26]=n=>K(fe)?fe.value=n:null),placement:"bottomLeft",getPopupContainer:n=>n.parentNode},{overlay:s(()=>[u("div",dn,[a(ot,kt(_t({labelCol:{span:10},wrapperCol:{span:14}})),{default:s(()=>[a(de,{label:o.$t("gridCellWidth")},{default:s(()=>[a(at,{modelValue:e(re),"onUpdate:modelValue":t[17]||(t[17]=n=>K(re)?re.value=n:null),max:1024,min:64,step:64},null,8,["modelValue"])]),_:1},8,["label"]),a(de,{label:o.$t("sortingMethod")},{default:s(()=>[a(e(bt),{value:e(me),"onUpdate:value":t[18]||(t[18]=n=>K(me)?me.value=n:null),onClick:t[19]||(t[19]=p(()=>{},["stop"])),conv:e(Ke),options:e(Ct)},null,8,["value","conv","options"])]),_:1},8,["label"]),a(de,{label:o.$t("showChangeIndicators")},{default:s(()=>[a(De,{checked:ie.value,"onUpdate:checked":t[20]||(t[20]=n=>ie.value=n),onClick:Ne},null,8,["checked"])]),_:1},8,["label"]),a(de,{label:o.$t("seedAsChange")},{default:s(()=>[a(De,{checked:ge.value,"onUpdate:checked":t[21]||(t[21]=n=>ge.value=n),disabled:!ie.value},null,8,["checked","disabled"])]),_:1},8,["label"]),u("div",cn,[e(E)?e(E).can_delete?(c(),$("a",{key:1,onClick:t[23]||(t[23]=p((...n)=>e(N)&&e(N)(...n),["prevent"]))},d(o.$t("removeFromSearchScanPathAndQuickMove")),1)):O("",!0):(c(),$("a",{key:0,onClick:t[22]||(t[22]=p((...n)=>e(N)&&e(N)(...n),["prevent"]))},d(o.$t("addToSearchScanPathAndQuickMove")),1))]),u("div",pn,[u("a",{onClick:t[24]||(t[24]=p(n=>e(yt)(e(B)+"/"),["prevent"]))},d(o.$t("openWithLocalFileBrowser")),1)]),u("div",fn,[u("a",{onClick:t[25]||(t[25]=p((...n)=>e(oe)&&e(oe)(...n),["prevent"]))},d(o.$t("createFolder")),1)])]),_:1},16)])]),default:s(()=>[u("a",{class:"opt",onClick:t[16]||(t[16]=p(()=>{},["prevent"]))},d(o.$t("more")),1)]),_:1},8,["visible","getPopupContainer"])])]),e(F)?(c(),$("div",mn,[a(e(Gt),{class:"file-list",items:e(f),ref_key:"scroller",ref:g,onScroll:e(Xe),"item-size":e(Se).first,"key-field":"fullpath","item-secondary-size":e(Se).second,gridItems:e(qe)},{default:s(({item:n,index:R})=>[a(qt,{idx:parseInt(R),file:n,"full-screen-preview-image-url":e(f)[e(le)]?e(ht)(e(f)[e(le)]):"","show-menu-idx":e(ve),"onUpdate:showMenuIdx":t[27]||(t[27]=Ee=>K(ve)?ve.value=Ee:null),selected:e(y).includes(R),"cell-width":e(re),onFileItemClick:e(tt),onDragstart:e(Ze),onDragend:e(et),onPreviewVisibleChange:e(nt),onContextMenuClick:e(Pe),"is-selected-mutil-files":e(y).length>1,"gen-diff-to-next":xe(n.gen_info_obj,R,1,n),"gen-diff-to-previous":xe(n.gen_info_obj,R,-1,n),"enable-change-indicator":ie.value},null,8,["idx","file","full-screen-preview-image-url","show-menu-idx","selected","cell-width","onFileItemClick","onDragstart","onDragend","onPreviewVisibleChange","onContextMenuClick","is-selected-mutil-files","gen-diff-to-next","gen-diff-to-previous","enable-change-indicator"])]),after:s(()=>[u("div",vn,[r.walkModePath?(c(),D(X,{key:0,onClick:e(Qe),loading:e(He),block:"",type:"primary",disabled:!e(Je),ghost:""},{default:s(()=>[U(d(o.$t("loadNextPage")),1)]),_:1},8,["onClick","loading","disabled"])):O("",!0)])]),_:1},8,["items","onScroll","item-size","item-secondary-size","gridItems"]),e(Me)?(c(),$("div",gn,[a(e(Bt),{onClick:t[28]||(t[28]=n=>e(Be)("prev")),class:Ve({disable:!e(Re)("prev")})},null,8,["class"]),a(e(Rt),{onClick:t[29]||(t[29]=n=>e(Be)("next")),class:Ve({disable:!e(Re)("next")})},null,8,["class"])])):O("",!0)])):O("",!0)],544),e(Me)?(c(),D(Nt,{key:0,file:e(f)[e(le)],idx:e(le),onContextMenuClick:e(Pe)},null,8,["file","idx","onContextMenuClick"])):O("",!0),a(tn,{"file-num":e(f).length,"selected-file-num":e(y).length},null,8,["file-num","selected-file-num"])]),_:1},8,["spinning"])}}});const Fn=We(kn,[["__scopeId","data-v-f2221f9e"]]);export{Fn as default};
