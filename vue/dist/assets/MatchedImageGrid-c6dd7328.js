import{d as P,y as U,o as r,l as _,c as l,m as a,n as e,p as y,q as b,B as q,t as h,C as E,z as M,K as u,O as S,R as D,v as L,W as K}from"./index-d77bcb54.js";import{a as Q,f as W,L as j,R as H,b as J,S as X}from"./fullScreenContextMenu-c0cd1bbd.js";import{t as Y}from"./hook-b7fce3b0.js";import{g as Z}from"./db-f752a0b1.js";import{u as ee}from"./hook-7125bc0b.js";const se={class:"hint"},ie={key:1,class:"preview-switch"},te=P({__name:"MatchedImageGrid",props:{tabIdx:{},paneIdx:{},selectedTagIds:{},id:{}},setup(V){const m=V,{queue:p,images:i,onContextMenuClickU:f,stackViewEl:z,previewIdx:n,previewing:v,onPreviewVisibleChange:T,previewImgMove:g,canPreview:I,itemSize:k,gridItems:B,showGenInfo:o,imageGenInfo:C,q:$,multiSelectedIdxs:G,onFileItemClick:R,scroller:w,showMenuIdx:d}=ee();return U(()=>m.selectedTagIds,async()=>{var s;const{res:c}=p.pushAction(()=>Z(m.selectedTagIds));i.value=await c,(s=w.value)==null||s.scrollToItem(0)},{immediate:!0}),(c,s)=>{const A=D,F=L,N=X;return r(),_("div",{class:"container",ref_key:"stackViewEl",ref:z},[l(N,{size:"large",spinning:!e(p).isIdle},{default:a(()=>[l(F,{visible:e(o),"onUpdate:visible":s[1]||(s[1]=t=>y(o)?o.value=t:null),width:"70vw","mask-closable":"",onOk:s[2]||(s[2]=t=>o.value=!1)},{cancelText:a(()=>[]),default:a(()=>[l(A,{active:"",loading:!e($).isIdle},{default:a(()=>[b("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto"},onDblclick:s[0]||(s[0]=t=>e(q)(e(C)))},[b("div",se,h(c.$t("doubleClickToCopy")),1),E(" "+h(e(C)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),e(i)?(r(),M(e(Q),{key:0,ref_key:"scroller",ref:w,class:"file-list",items:e(i),"item-size":e(k).first,"key-field":"fullpath","item-secondary-size":e(k).second,gridItems:e(B)},{default:a(({item:t,index:x})=>[l(W,{idx:x,file:t,"show-menu-idx":e(d),"onUpdate:showMenuIdx":s[3]||(s[3]=O=>y(d)?d.value=O:null),onFileItemClick:e(R),"full-screen-preview-image-url":e(i)[e(n)]?e(Y)(e(i)[e(n)]):"",selected:e(G).includes(x),onContextMenuClick:e(f),onPreviewVisibleChange:e(T)},null,8,["idx","file","show-menu-idx","onFileItemClick","full-screen-preview-image-url","selected","onContextMenuClick","onPreviewVisibleChange"])]),_:1},8,["items","item-size","item-secondary-size","gridItems"])):u("",!0),e(v)?(r(),_("div",ie,[l(e(j),{onClick:s[4]||(s[4]=t=>e(g)("prev")),class:S({disable:!e(I)("prev")})},null,8,["class"]),l(e(H),{onClick:s[5]||(s[5]=t=>e(g)("next")),class:S({disable:!e(I)("next")})},null,8,["class"])])):u("",!0)]),_:1},8,["spinning"]),e(v)&&e(i)&&e(i)[e(n)]?(r(),M(J,{key:0,file:e(i)[e(n)],idx:e(n),onContextMenuClick:e(f)},null,8,["file","idx","onContextMenuClick"])):u("",!0)],512)}}});const de=K(te,[["__scopeId","data-v-2a47e96e"]]);export{de as default};
